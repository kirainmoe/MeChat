{"version":3,"sources":["images/defaultAvatar.jpg","components/TopButton.js","components/LoginPage.js","components/RegisterPage.js","components/Navbar.js","components/MessageList.js","components/subcomponents/Bubble.js","components/ChatPage.js","components/FriendsList.js","components/ProfilePage.js","components/ProfileEdit.js","components/AboutPage.js","components/GroupList.js","components/CreateNewGroupPage.js","components/GroupPage.js","components/GroupChatPage.js","components/FriendCircle.js","components/CreatePostPage.js","components/PostPage.js","components/MainPage.js","config.js","models/index.js","index.js","images/mechat.png","images/group.png"],"names":["module","exports","TopButton","maximized","window","close","browserWindow","getCurrentWindow","minimize","this","unmaximize","maximize","className","onClick","closeWindow","minimizeWindow","maximizeWindow","Component","defaultAvatar","require","LoginPage","inject","observer","props","state","nickname","avatar","logining","username","usernameInput","value","password","crypto","createHash","update","passwordInput","digest","setState","loginUri","store","API","honoka","post","data","then","res","JSON","parse","status","alert","message","localStorage","setItem","stringify","sessionStorage","history","push","recordedInfo","getItem","setSize","setRouter","setTimeout","focus","style","background","display","type","name","ref","onChange","onUsernameInput","placeholder","login","to","withRouter","RegisterPage","mail","mailInput","nicknameInput","regUri","dialog","showMessageBoxSync","title","button","register","Navbar","alt","src","forceLogout","groupAvatar","MessageList","item","setRead","with","setChattingWith","rawList","cnt","key","messageList","sort","a","b","last","date","Date","dateStr","getHours","getMinutes","target","chatWith","getAvatar","read","records","length","content","fetching","renderMessageList","Bubble","chat","myAvatar","from","dangerouslySetInnerHTML","__html","trim","replace","ChatPage","document","onkeydown","e","keycode","which","keyCode","ctrlKey","sendMessage","chatContent","scrollTop","scrollHeight","chats","uid","match","params","id","rawChats","getRawChats","lastTime","forEach","timestamp","chattingWith","reloadMessageList","text","textarea","changeScrollTop","token","imageInput","click","raw","file","files","size","reader","FileReader","readAsDataURL","onload","base64Content","result","clipboardData","items","blob","getAsFile","indexOf","sendImage","interval","setInterval","clearInterval","onPaste","onClipboardPaste","renderChatContent","accept","selectImage","FriendsList","friends","friend","alias","signature","reloadFriendsList","input","addFriendUrl","addFriend","payload","renderFriendsList","ProfilePage","modifyAlias","addDialog","aliasInput","updateAlias","deleteFriend","user","uidKeyMap","changeAlias","defaultValue","confirmChange","ProfileEdit","avatarUpload","form","FormData","append","fetch","method","headers","body","json","fileObj","uri","URL","createObjectURL","setNewAvatar","setUserInfo","removeItem","setAttribute","selectAvatar","uploadForm","action","encType","onFileLoadChange","editProfile","mechatLogo","AboutPage","GroupList","groups","group","description","reloadGroupList","groupId","addGroupUrl","addGroup","renderGroupsList","CreateNewGroupPage","memberComponents","groupName","groupDesc","members","wrapper","querySelectorAll","checked","getAttribute","console","log","renderMemberLists","createGroup","GroupPage","exitUrl","exitGroup","groupKeyMap","GroupChatPage","inviting","inviteInput","rawMembers","member","renderMembers","doInvite","FriendCircle","reloadPostList","offset","likes","likePost","deletePost","posts","div","createElement","innerText","innerHTML","liked","_id","createdBy","curPath","path","renderPosts","CreatePostPage","pushNewPost","createPost","PostPage","returnId","getPost","i","commentContent","replyTo","sendButton","comments","comment","preventDefault","stopPropagation","renderComments","postId","reply","MainPage","retry","createSocketConnection","ws","WebSocket","configUrl","wsUrl","addEventListener","send","connectSocketLink","msg","pushNewMessage","apiUrl","Model","resource","httpUrl","socketLink","currentDialog","r","router","noAlert","initModelState","url","flag","socket","isGroup","images","unshift","createTime","undefined","MessageListUri","config","replaceDialog","updateFriends","groupUri","updateGroups","postUri","splice","observable","get","eval","navigator","userAgent","ReactDOM","render","exact","getElementById"],"mappings":"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","file":"static/js/main.8d2093f6.chunk.js","sourcesContent":["module.exports = \"data:image/jpeg;base64,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\"","import React, { Component } from 'react';\r\n\r\nimport '../styles/TopButton.styl';\r\n\r\nexport default class TopButton extends Component {\r\n    maximized = false;\r\n\r\n    closeWindow() {\r\n        window.close();\r\n    }\r\n\r\n    minimizeWindow() {\r\n        window.browserWindow.getCurrentWindow().minimize();\r\n    }\r\n\r\n    maximizeWindow() {\r\n        if (this.maximized)\r\n            window.browserWindow.getCurrentWindow().unmaximize();\r\n        else\r\n            window.browserWindow.getCurrentWindow().maximize();\r\n        this.maximized = !this.maximized;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='mechat-top-button-container'>\r\n                <button className='mechat-top-button-exit' onClick={() => this.closeWindow()} />\r\n                <button className='mechat-top-button-minimize' onClick={() => this.minimizeWindow()} />\r\n                <button className='mechat-top-button-maxmize' onClick={() => this.maximizeWindow()} />\r\n            </div>\r\n        );\r\n    }\r\n}","import React, { Component } from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { inject, observer } from \"mobx-react\";\nimport crypto from \"crypto\";\nimport honoka from \"honoka\";\n\nimport \"../styles/LoginPage.styl\";\n\n\nconst defaultAvatar = require(\"../images/defaultAvatar.jpg\");\n\n@inject('store')\n@observer\nclass LoginPage extends Component {\n    constructor(props) {\n        super(props);\n\n        // default state\n        this.state = {\n            nickname: \"MeChat\",\n            avatar: defaultAvatar,\n            logining: false\n        };\n    }\n\n    login() {\n        const username = this.usernameInput.value,\n            password = crypto\n                .createHash(\"md5\")\n                .update(this.passwordInput.value)\n                .digest(\"hex\");\n        this.setState({\n            logining: true\n        });\n\n        const loginUri = this.props.store.API('login');\n        honoka\n            .post(loginUri, {\n                data: {\n                    username,\n                    password\n                }\n            })\n            .then(res => {\n                if (typeof res === \"string\") res = JSON.parse(res);\n\n                this.setState({\n                    logining: false\n                });\n\n                if (res.status !== 200)\n                    alert(\"登录失败，错误信息：\" + res.message);\n                else {\n                    res.avatar = this.props.store.API('avatar', res.avatar);\n\n                    localStorage.setItem(username, JSON.stringify({\n                        avatar: res.avatar,\n                        nickname: res.nickname\n                    }));\n                    sessionStorage.setItem(\"userInfo\", JSON.stringify(res));\n\n                    this.props.history.push('/app/message');\n                }\n            });\n    }\n\n    onUsernameInput() {\n        const username = this.usernameInput.value,\n            recordedInfo = localStorage.getItem(username);\n        if (recordedInfo) {\n            const res = JSON.parse(recordedInfo);\n            this.setState({\n                ...res\n            });\n        } else {\n            if (this.state.nickname !== 'MeChat') {\n                this.setState({\n                    nickname: 'MeChat',\n                    avatar: defaultAvatar\n                });\n            }\n        }\n    }\n\n    componentDidMount() {\n        window.browserWindow.getCurrentWindow().setSize(300, 500);\n        this.props.store.setRouter(this.props.history);\n        setTimeout(() => this.usernameInput.focus(), 100);\n    }\n\n    render() {\n        return (\n            <div className=\"mechat-loginpage\">\n                <div className=\"mechat-login-personinfo\">\n                    <div className=\"mechat-login-avatar-container\">\n                        <div\n                            className=\"mechat-login-avatar\"\n                            style={{\n                                background: `url('${this.state.avatar}') no-repeat center / cover`\n                            }}\n                        />\n                    </div>\n                    <p className=\"mechat-login-nickname\">{this.state.nickname}</p>\n                </div>\n                <div className=\"mechat-login-hint\" style={{\n                    display: this.state.logining ? 'block' : 'none'\n                }}>\n                    正在登录...\n        </div>\n                <div className=\"mechat-login-input\" style={{\n                    display: this.state.logining ? 'none' : 'block'\n                }}>\n                    <input\n                        type=\"text\"\n                        name=\"username\"\n                        className=\"mechat-login-input-username\"\n                        ref={ref => (this.usernameInput = ref)}\n                        onChange={() => this.onUsernameInput()}\n                        placeholder=\"用户名\"\n                    />\n                    <input\n                        type=\"password\"\n                        name=\"password\"\n                        className=\"mechat-login-input-password\"\n                        ref={ref => (this.passwordInput = ref)}\n                        placeholder=\"密码\"\n                    />\n                    <div className=\"mechat-login-actions\">\n                        <button\n                            type=\"button\"\n                            onClick={() => this.login()}\n                            className=\"mechat-login-button\"\n                        >\n                            登录\n            </button>\n                        <Link to=\"/register\" className=\"mechat-login-register\">\n                            没有账号？注册一个\n            </Link>\n                    </div>\n                </div>\n                <div className=\"mechat-login-copyright\">\n                    &copy;2019 XMU CS - Data-Structure Curriculum Design <br /> by Yume Maruyama\n        </div>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(LoginPage);","import React, { Component } from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { inject, observer } from \"mobx-react\";\n\nimport crypto from \"crypto\";\nimport honoka from \"honoka\";\n\nimport \"../styles/RegisterPage.styl\";\n\n@inject('store')\n@observer\nclass RegisterPage extends Component {\n    register() {\n        const username = this.usernameInput.value,\n            password = crypto\n                .createHash(\"md5\")\n                .update(this.passwordInput.value)\n                .digest(\"hex\"),\n            mail = this.mailInput.value,\n            nickname = this.nicknameInput.value;\n\n        const regUri = this.props.store.API(\"register\");\n        honoka\n            .post(regUri, {\n                data: {\n                    username,\n                    password,\n                    mail,\n                    nickname\n                }\n            })\n            .then(res => {\n                if (typeof res == \"string\") res = JSON.parse(res);\n                if (res.status !== 200) {\n                    alert(\"注册失败，错误信息：\" + res.message);\n                } else {\n                    window.browserWindow.dialog.showMessageBoxSync({\n                        type: 'info',\n                        title: '注册成功',\n                        message: \"注册成功~将回到登录页面。\",\n                        button: ['ok']\n                    });\n                    this.props.history.push(\"/\");\n                }\n            });\n    }\n\n    render() {\n        return (\n            <div className=\"mechat-register-page\">\n                <h1 className=\"mechat-register-title\">注册 MeChat</h1>\n                <input\n                    type=\"text\"\n                    name=\"username\"\n                    className=\"mechat-register-input-username\"\n                    ref={ref => (this.usernameInput = ref)}\n                    placeholder=\"登录用户名\"\n                />\n                <input\n                    type=\"password\"\n                    name=\"password\"\n                    className=\"mechat-register-input-password\"\n                    ref={ref => (this.passwordInput = ref)}\n                    placeholder=\"密码\"\n                />\n                <input\n                    type=\"mail\"\n                    name=\"mail\"\n                    className=\"mechat-register-input-mail\"\n                    ref={ref => (this.mailInput = ref)}\n                    placeholder=\"邮箱\"\n                />\n                <input\n                    type=\"text\"\n                    name=\"nickname\"\n                    className=\"mechat-register-input-nickname\"\n                    ref={ref => (this.nicknameInput = ref)}\n                    placeholder=\"昵称\"\n                />\n\n                <div className=\"mechat-register-actions\">\n                    <button\n                        type=\"button\"\n                        onClick={() => this.register()}\n                        className=\"mechat-register-button\"\n                    >\n                        注册\n                    </button>\n                    <Link to=\"/\" className=\"mechat-register-login\">\n                        已有账号？登录\n                    </Link>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(RegisterPage);\n","import React, { Component } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { NavLink, Link } from \"react-router-dom\";\r\nimport { inject, observer } from \"mobx-react\";\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass Navbar extends Component {\r\n    render() {\r\n        return (\r\n            <div className=\"mechat-mainpage-nav\">\r\n                <div className=\"mechat-nav-avatar-container\">\r\n                    <Link to={\"/app/editProfile\"}>\r\n                        <img\r\n                            className=\"mechat-nav-avatar\"\r\n                            alt=\"avatar\"\r\n                            src={this.props.store.avatar}\r\n                            title={this.props.store.nickname}\r\n                        />\r\n                    </Link>\r\n                </div>\r\n                <NavLink to=\"/app/message\" title=\"消息\">\r\n                    <i className=\"fa fa-comments-o\"></i>\r\n                </NavLink>\r\n                <NavLink to=\"/app/friends\" title=\"通讯录\">\r\n                    <i className=\"fa fa-address-book-o\"></i>\r\n                </NavLink>\r\n                <NavLink to=\"/app/groups\" title=\"群组\">\r\n                    <i className=\"fa fa-group\"></i>\r\n                </NavLink>\r\n                <NavLink to=\"/app/circle\" title=\"好友动态\">\r\n                    <i className=\"fa fa-compass\"></i>\r\n                </NavLink>\r\n                <div className=\"mechat-nav-system-action\">\r\n                    <Link to=\"/app/about\" title=\"关于\">\r\n                        <i className=\"fa fa-info-circle\"></i>\r\n                    </Link>\r\n                    <Link to=\"/\" title=\"注销\" onClick={() => this.props.store.forceLogout(true)}>\r\n                        <i className=\"fa fa-mail-reply\"></i>\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(Navbar);\r\n","import React, { Component } from \"react\";\nimport { inject, observer } from \"mobx-react\";\nimport { NavLink } from \"react-router-dom\";\n\nconst groupAvatar = require(\"../images/group.png\");\n\n@inject(\"store\")\n@observer\nclass MessageList extends Component {\n    getAvatar(avatar) {\n        return this.props.store.API(\"avatar\", avatar);\n    }\n\n    chatWith(item) {\n        this.props.store.setRead(item.with);\n        this.props.store.setChattingWith(item.with, item.nickname, item.avatar);\n    }\n\n    renderMessageList() {\n        const res = [];\n        let rawList = [];\n        let cnt = 0;\n\n        for (const key in this.props.store.messageList)\n            rawList.push(this.props.store.messageList[key]);\n        rawList = rawList.sort((a, b) => {\n            return a.last < b.last ? 1 : -1;\n        });\n        for (const key in rawList) {\n            const item = rawList[key],\n                date = new Date(item.last);\n\n            // 处理日期\n            let dateStr = \"\";\n            dateStr += date.getHours() < 10 ? \"0\" + date.getHours() : date.getHours();\n            dateStr += \":\";\n            dateStr += date.getMinutes() < 10 ? \"0\" + date.getMinutes() : date.getMinutes();\n\n            res.push(\n                <NavLink\n                    className=\"mechat-dialog\"\n                    to={\n                        item.target !== \"group\"\n                            ? `/app/message/${item.with}`\n                            : `/app/groupMessage/${item.with}`\n                    }\n                    key={cnt++}\n                    onClick={() => this.chatWith(item)}\n                >\n                    <div className=\"mechat-dialog-avatar\">\n                        <img\n                            src={\n                                item.target === \"group\" ? groupAvatar : this.getAvatar(item.avatar)\n                            }\n                            alt=\"avatar\"\n                        />\n                        {item.read ? null : <span className={\"mechat-dialog-new\"}></span>}\n                    </div>\n                    <div className=\"mechat-dialog-meta\">\n                        <p className=\"mechat-dialog-title\">{item.nickname}</p>\n                        <p className=\"mechat-dialog-mess\">\n                            {(() => {\n                                if (item.records.length) {\n                                    if (item.records[item.records.length - 1].type === \"image\")\n                                        return \"[图片]\";\n                                    else return item.records[item.records.length - 1].content;\n                                } else return \"\";\n                            })()}\n                        </p>\n                        <span className=\"mechat-dialog-time\">{dateStr}</span>\n                    </div>\n                </NavLink>\n            );\n        }\n\n        return res;\n    }\n    render() {\n        return (\n            <div className=\"mechat-messages\">\n                <h1 className=\"mechat-messages-title\">消息列表</h1>\n                <div\n                    className=\"mechat-messages-fetching\"\n                    style={{\n                        display: this.props.store.fetching ? \"block\" : \"none\"\n                    }}\n                >\n                    正在更新消息列表...\n                </div>\n                <div className=\"mechat-messages-list\">{(() => this.renderMessageList())()}</div>\n            </div>\n        );\n    }\n}\n\nexport default MessageList;\n","import React, { Component } from \"react\";\n\nexport default class Bubble extends Component {\n  render() {\n    const { chat, chatWith, myAvatar } = this.props;\n\n    return (\n      <div className={\"mechat-chat-item \" + (chat.from === 1 ? \"from-me\" : \"\")}>\n        <div className=\"mechat-chat-item-avatar\">\n          <img\n            src={\n              chat.from === 1\n                ? myAvatar\n                : chat.target === \"group\"\n                ? this.props.avatar\n                : chatWith.avatar\n            }\n            alt=\"avatar\"\n          />\n        </div>\n        {(() => {\n          if (chat.target === \"group\") {\n            return <p className=\"mechat-chat-group-id\">{chat.nickname}</p>;\n          }\n          return null;\n        })()}\n        <div className=\"mechat-chat-item-bubble\">\n          {chat.type === \"string\" ? (\n            <p\n              dangerouslySetInnerHTML={{\n                __html: chat.content.trim().replace(/\\n/g, \"<br>\")\n              }}\n            ></p>\n          ) : (\n            <img src={chat.content} alt=\"chatimg\" />\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\r\nimport { inject, observer } from \"mobx-react\";\r\n\r\nimport Bubble from \"./subcomponents/Bubble\";\r\n\r\nimport \"../styles/ChatPage.styl\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\nimport honoka from \"honoka\";\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass ChatPage extends Component {\r\n    componentDidMount() {\r\n        document.onkeydown = e => {\r\n            const keycode = e.which ? e.which : e.keyCode;\r\n            if (e.ctrlKey && keycode === 13) {\r\n                this.sendMessage();\r\n            }\r\n        };\r\n\r\n        this.chatContent.scrollTop = this.chatContent.scrollHeight;\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.onkeydown = null;\r\n    }\r\n\r\n    renderChatContent() {\r\n        const chats = [],\r\n            uid = this.props.match.params.id,\r\n            rawChats = this.props.store.getRawChats(uid),\r\n            myAvatar = this.props.store.avatar;\r\n\r\n        let cnt = 0,\r\n            lastTime = 0;\r\n        if (!rawChats.forEach) {\r\n            this.props.store.reloadMessageList();\r\n            return;\r\n        }\r\n\r\n        rawChats.forEach(chat => {\r\n            // 处理信息接收时间间隔\r\n            if (chat.timestamp - lastTime >= 1000000) {\r\n                const date = new Date(chat.timestamp);\r\n                let dateStr = \"\";\r\n                dateStr += date.getHours() < 10 ? \"0\" + date.getHours() : date.getHours();\r\n                dateStr += \":\";\r\n                dateStr += date.getMinutes() < 10 ? \"0\" + date.getMinutes() : date.getMinutes();\r\n                chats.push(\r\n                    <div key={cnt++} className={\"mechat-chat-item-time\"}>\r\n                        {dateStr}\r\n                    </div>\r\n                );\r\n                lastTime = chat.timestamp;\r\n            }\r\n            chats.push(\r\n                <Bubble\r\n                    chat={chat}\r\n                    chatWith={this.props.store.chattingWith}\r\n                    myAvatar={myAvatar}\r\n                    key={cnt++}\r\n                />\r\n            );\r\n        });\r\n        return chats;\r\n    }\r\n\r\n    changeScrollTop() {\r\n        this.chatContent.scrollTop = this.chatContent.scrollHeight;\r\n    }\r\n\r\n    sendMessage() {\r\n        const text = this.textarea.value,\r\n            uid = this.props.match.params.id;\r\n        this.props.store.sendMessage(uid, text, \"string\");\r\n        this.props.store.setRead(uid);\r\n        this.textarea.value = \"\";\r\n        this.changeScrollTop();\r\n\r\n        honoka\r\n            .post(this.props.store.API(\"sendMessage\"), {\r\n                data: {\r\n                    uid: this.props.store.uid,\r\n                    to: uid,\r\n                    type: \"string\",\r\n                    content: text,\r\n                    token: this.props.store.token,\r\n                    target: \"friends\"\r\n                }\r\n            })\r\n            .then(res => {\r\n                if (res.status !== 200) {\r\n                    alert(\"发送信息失败，原因可能是：\" + res.message);\r\n                    return;\r\n                }\r\n            });\r\n    }\r\n\r\n    selectImage() {\r\n        this.imageInput.click();\r\n    }\r\n\r\n    sendImage(raw) {\r\n        const file = raw ? raw : this.imageInput.files[0];\r\n        if (file.size / 1024 / 1024 > 2) {\r\n            alert(\"发送的图片尺寸不能超过 2MB\");\r\n            return;\r\n        }\r\n\r\n        const reader = new FileReader(),\r\n            uid = this.props.match.params.id;\r\n        reader.readAsDataURL(file);\r\n        reader.onload = e => {\r\n            const base64Content = reader.result;\r\n            this.props.store.sendMessage(uid, base64Content, \"image\");\r\n            honoka\r\n                .post(this.props.store.API(\"sendMessage\"), {\r\n                    data: {\r\n                        uid: this.props.store.uid,\r\n                        to: uid,\r\n                        type: \"image\",\r\n                        content: base64Content,\r\n                        token: this.props.store.token,\r\n                        target: \"friends\"\r\n                    }\r\n                })\r\n                .then(res => {\r\n                    if (res.status !== 200) {\r\n                        alert(\"发送信息失败，原因可能是：\" + res.message);\r\n                        return;\r\n                    }\r\n                });\r\n        };\r\n    }\r\n\r\n    onClipboardPaste(e) {\r\n        const item = e.clipboardData.items;\r\n        if (!item.length) return;\r\n        const blob = item[0].getAsFile();\r\n        if (!blob || !blob.type || !blob.type.indexOf(\"image\") === -1) return;\r\n        this.sendImage(blob);\r\n    }\r\n\r\n    render() {\r\n        const interval = setInterval(() => {\r\n            if (!this.chatContent) return;\r\n            this.changeScrollTop();\r\n            clearInterval(interval);\r\n        }, 50);\r\n\r\n        return (\r\n            <div className=\"mechat-chat-page\" onPaste={e => this.onClipboardPaste(e)}>\r\n                <div className=\"mechat-chat-title\">\r\n                    <Link to={\"/app/friends/\" + this.props.match.params.id}>\r\n                        {this.props.store.chattingWith.nickname}\r\n                    </Link>\r\n                </div>\r\n\r\n                <div className=\"mechat-chat-content\" ref={ref => (this.chatContent = ref)}>\r\n                    {(() => this.renderChatContent())()}\r\n                </div>\r\n\r\n                <div className=\"mechat-chat-textarea\">\r\n                    <textarea name=\"chat-text\" ref={ref => (this.textarea = ref)}></textarea>\r\n                    <input\r\n                        accept=\"image/*\"\r\n                        ref={ref => (this.imageInput = ref)}\r\n                        type=\"file\"\r\n                        onChange={() => this.sendImage()}\r\n                    />\r\n                    <button\r\n                        className=\"mechat-chat-image\"\r\n                        title=\"发送图片\"\r\n                        onClick={() => this.selectImage()}\r\n                    >\r\n                        <i className=\"fa fa-image\"></i>\r\n                    </button>\r\n                    <button className=\"mechat-chat-send\" onClick={() => this.sendMessage()}>\r\n                        发送\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(ChatPage);\r\n","import React, { Component } from \"react\";\r\nimport { inject, observer } from \"mobx-react\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport honoka from \"honoka\";\r\n\r\nimport \"../styles/FriendsList.styl\";\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass FriendsList extends Component {\r\n    renderFriendsList() {\r\n        const res = [];\r\n        let cnt = 0;\r\n        this.props.store.friends.forEach(friend => {\r\n            res.push(\r\n                <NavLink className=\"mechat-dialog\" to={\"/app/friends/\" + friend.uid} key={cnt++}>\r\n                    <div className=\"mechat-dialog-avatar\">\r\n                        <img src={this.props.store.API('avatar', friend.avatar)} alt=\"avatar\" />\r\n                    </div>\r\n                    <div className=\"mechat-dialog-meta\">\r\n                        <p className=\"mechat-dialog-title\">\r\n                            {friend.alias\r\n                                ? `${friend.alias} (${friend.nickname})`\r\n                                : friend.nickname}\r\n                        </p>\r\n                        <p className=\"mechat-dialog-mess\">{friend.signature}</p>\r\n                    </div>\r\n                </NavLink>\r\n            );\r\n        });\r\n        return res;\r\n    }\r\n\r\n    componentWillMount() {\r\n        this.props.store.reloadFriendsList();\r\n    }\r\n\r\n    addFriend() {\r\n        const friend = this.input.value,\r\n            addFriendUrl = this.props.store.API(\"addFriend\");\r\n        honoka\r\n            .post(addFriendUrl, {\r\n                data: {\r\n                    uid: this.props.store.uid,\r\n                    token: this.props.store.token,\r\n                    friend\r\n                }\r\n            })\r\n            .then(res => {\r\n                if (res.status === 403) {\r\n                  this.props.store.forceLogout();\r\n                } else {\r\n                    if (res.status === 200) {\r\n                        alert(\"添加好友成功.\");\r\n                        this.props.store.addFriend(res.payload);\r\n                    } else {\r\n                        alert(\"添加好友失败，原因是：\" + res.message);\r\n                    }\r\n                }\r\n            });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"mechat-messages\">\r\n                <h1 className=\"mechat-messages-title\">朋友</h1>\r\n                <div className=\"mechat-friends-add\">\r\n                    <input\r\n                        type=\"text\"\r\n                        name=\"friends\"\r\n                        placeholder=\"搜索 MeChat 账号添加好友\"\r\n                        ref={ref => (this.input = ref)}\r\n                    />\r\n                    <button onClick={() => this.addFriend()}>+</button>\r\n                </div>\r\n                <div className=\"mechat-messages-list\">{(() => this.renderFriendsList())()}</div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default FriendsList;\r\n","import React, { Component } from \"react\";\r\nimport { inject, observer } from \"mobx-react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\nimport honoka from \"honoka\";\r\n\r\nimport \"../styles/ProfilePage.styl\";\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass ProfilePage extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            modifyAlias: false\r\n        };\r\n    }\r\n\r\n    chatWith(uid, nickname, avatar) {\r\n        if (!this.props.store.messageList[uid])\r\n            this.props.store.addDialog(uid);\r\n        this.props.store.setChattingWith(uid, nickname, avatar);\r\n    }\r\n\r\n    getAvatar(avatar) {\r\n        return this.props.store.API('avatar', avatar);\r\n    }\r\n\r\n    changeAlias() {\r\n        this.setState({\r\n            modifyAlias: true\r\n        });\r\n    }\r\n\r\n    confirmChange() {\r\n        const target = this.props.match.params.id,\r\n            alias = this.aliasInput.value;\r\n        honoka\r\n            .post(this.props.store.API(\"changeAlias\"), {\r\n                data: {\r\n                    uid: this.props.store.uid,\r\n                    token: this.props.store.token,\r\n                    target,\r\n                    alias\r\n                }\r\n            })\r\n            .then(res => {\r\n                if (res.status === 403) this.props.store.forceLogout();\r\n                else {\r\n                    if (res.status === 200) {\r\n                        this.props.store.updateAlias(target, alias);\r\n                        this.setState({\r\n                            modifyAlias: false\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n    }\r\n\r\n    deleteFriend() {\r\n        const uid = this.props.store.uid,\r\n            token = this.props.store.token,\r\n            target = this.props.match.params.id;\r\n        honoka\r\n            .post(this.props.store.API(\"deleteFriend\"), {\r\n                data: {\r\n                    uid,\r\n                    token,\r\n                    target\r\n                }\r\n            })\r\n            .then(res => {\r\n                if (res.status === 403) this.props.store.forceLogout();\r\n                else {\r\n                    if (res.status === 200) {\r\n                        alert(\"删除好友成功。\");\r\n                        this.props.store.deleteFriend(target);\r\n                    }\r\n                }\r\n            });\r\n    }\r\n\r\n    render() {\r\n        const uid = this.props.match.params.id;\r\n        let user = this.props.store.uidKeyMap[uid];\r\n        if (!user) return null;\r\n\r\n        return (\r\n            <div className=\"mechat-profile-page\">\r\n                <p className=\"mechat-profile-title\">个人资料</p>\r\n                <div className=\"mechat-profile-container\">\r\n                    <div className=\"mechat-profile-avatar\">\r\n                        <img src={this.getAvatar(user.avatar)} alt=\"avatar\" />\r\n                    </div>\r\n                    <div className=\"mechat-profile-meta\">\r\n                        <h1 className=\"mechat-profile-nickname\">{user.nickname}</h1>\r\n                        <p className=\"mechat-profile-alias\">\r\n                            备注：{user.alias ? user.alias : \"无\"}\r\n                            <span\r\n                                className=\"mechat-profile-alias-change\"\r\n                                onClick={() => this.changeAlias()}\r\n                            >\r\n                                修改备注\r\n                            </span>\r\n                        </p>\r\n                        <p\r\n                            className=\"mechat-profile-alias-input\"\r\n                            style={{\r\n                                display: this.state.modifyAlias ? \"block\" : \"none\"\r\n                            }}\r\n                        >\r\n                            <input\r\n                                type=\"text\"\r\n                                defaultValue={user.alias}\r\n                                ref={ref => (this.aliasInput = ref)}\r\n                            />\r\n                            <button\r\n                                className=\"mechat-profile-alias-confirm\"\r\n                                onClick={() => this.confirmChange()}\r\n                            >\r\n                                确定\r\n                            </button>\r\n                        </p>\r\n                        <p className=\"mechat-profile-account\">MeChat 账号：{user.username}</p>\r\n\r\n                        <p className=\"mechat-profile-signature\">\r\n                            签名：{user.signature ? user.signature : \"无\"}\r\n                        </p>\r\n\r\n                        <Link\r\n                            className=\"mechat-profile-chat\"\r\n                            to={\"/app/message/\" + user.uid}\r\n                            onClick={() => this.chatWith(user.uid, user.nickname, user.avatar)}\r\n                        >\r\n                            聊天\r\n                        </Link>\r\n                        <button className=\"mechat-profile-exit\" onClick={() => this.deleteFriend()}>\r\n                            删除好友\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(ProfilePage);\r\n","import React, { Component } from \"react\";\r\nimport { inject, observer } from \"mobx-react\";\r\nimport { withRouter } from \"react-router\";\r\n\r\nimport \"../styles/ProfileEdit.styl\";\r\nimport honoka from \"honoka\";\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass ProfileEdit extends Component {\r\n    // 更新个人资料\r\n    editProfile() {\r\n        const nickname = this.nickname.value,\r\n            mail = this.mail.value,\r\n            signature = this.signature.value;\r\n\r\n        const { avatar, token, uid } = this.props.store;\r\n\r\n        if (nickname === \"\" || mail === \"\") {\r\n            alert(\"昵称和邮箱不许留空！\");\r\n            return;\r\n        }\r\n\r\n        if (this.avatarUpload.files.length) {\r\n            if (this.avatarUpload.files[0].size / 1024 / 1024 > 1) {\r\n                alert(\"上传的头像大小不能超过 1MB，请重新选择图片。\");\r\n                return;\r\n            }\r\n\r\n            const form = new FormData();\r\n            form.append(\"avatar\", this.avatarUpload.files[0]);\r\n            form.append(\"uid\", this.props.store.uid);\r\n            form.append(\"token\", this.props.store.token);\r\n            fetch(this.props.store.API(\"uploadAvatar\"), {\r\n                method: \"POST\",\r\n                headers: {},\r\n                body: form\r\n            })\r\n                .then(res => res.json())\r\n                .then(res => {\r\n                    if (res.status === 403)\r\n                        this.props.store.forceLogout();\r\n                    else {\r\n                        if (res.status === 200) {\r\n                            const fileObj = this.avatarUpload.files[0];\r\n                            const uri = window.URL.createObjectURL(fileObj);\r\n                            this.props.store.setNewAvatar(uri, true);\r\n                        }\r\n                    }\r\n                });\r\n        }\r\n\r\n        this.props.store.setUserInfo({\r\n            nickname,\r\n            mail,\r\n            signature,\r\n            avatar,\r\n            token,\r\n            id: uid,\r\n            username: this.props.store.username\r\n        });\r\n\r\n        honoka\r\n            .post(this.props.store.API(\"updateProfile\"), {\r\n                data: {\r\n                    nickname,\r\n                    mail,\r\n                    signature,\r\n                    uid,\r\n                    token\r\n                }\r\n            })\r\n            .then(res => {\r\n                if (res.status === 403) {\r\n                    alert(\"身份验证失败，请重新登录。\");\r\n\r\n                    sessionStorage.removeItem(\"userInfo\");\r\n                    this.props.history.push(\"/\");\r\n                } else {\r\n                    if (res.status === 200) alert(\"修改成功。\");\r\n                }\r\n            });\r\n    }\r\n\r\n    // 新头像预览\r\n    onFileLoadChange() {\r\n        const fileObj = this.avatarUpload.files[0];\r\n        const uri = window.URL.createObjectURL(fileObj);\r\n        this.avatar.setAttribute(\"src\", uri);\r\n    }\r\n\r\n    // 选择即将上传的头像\r\n    selectAvatar() {\r\n        this.avatarUpload.click();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"mechat-profile-edit\">\r\n                <p className=\"mechat-profile-edit-title\">修改个人资料</p>\r\n                <div className=\"mechat-profile-edit-container\">\r\n                    <div className=\"mechat-profile-edit-avatar\">\r\n                        <img\r\n                            src={this.props.store.avatar}\r\n                            alt=\"my-avatar\"\r\n                            onClick={() => {\r\n                                this.selectAvatar();\r\n                            }}\r\n                            ref={ref => (this.avatar = ref)}\r\n                            title=\"点击修改头像\"\r\n                        ></img>\r\n                    </div>\r\n                    <div className=\"mechat-profile-account\">\r\n                        <p name=\"username\">MeChat 账号：{this.props.store.username}</p>\r\n                        <p name=\"uid\">UID: {this.props.store.uid}</p>\r\n                    </div>\r\n                    <form\r\n                        ref={ref => (this.uploadForm = ref)}\r\n                        action={this.props.store.API(\"uploadAvatar\")}\r\n                        method=\"post\"\r\n                        encType=\"multipart/form-data\"\r\n                    >\r\n                        <input\r\n                            type=\"file\"\r\n                            name=\"avatar-upload\"\r\n                            ref={ref => (this.avatarUpload = ref)}\r\n                            style={{\r\n                                display: \"none\"\r\n                            }}\r\n                            accept=\"image/*\"\r\n                            onChange={e => this.onFileLoadChange(e)}\r\n                        />\r\n                    </form>\r\n\r\n                    <div className=\"mechat-profile-edit-form\">\r\n                        <span>昵称</span>\r\n                        <input\r\n                            type=\"text\"\r\n                            defaultValue={this.props.store.nickname}\r\n                            ref={ref => (this.nickname = ref)}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"mechat-profile-edit-form\">\r\n                        <span>邮箱</span>\r\n                        <input\r\n                            type=\"text\"\r\n                            defaultValue={this.props.store.mail}\r\n                            ref={ref => (this.mail = ref)}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"mechat-profile-edit-form\">\r\n                        <span>签名</span>\r\n                        <input\r\n                            type=\"text\"\r\n                            defaultValue={this.props.store.signature}\r\n                            ref={ref => (this.signature = ref)}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"mechat-profile-edit-action\">\r\n                        <button\r\n                            className=\"mechat-profile-edit-submit\"\r\n                            onClick={() => this.editProfile()}\r\n                        >\r\n                            修改\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(ProfileEdit);\r\n","import React, { Component } from \"react\";\n\nimport { inject, observer } from \"mobx-react\";\nimport { withRouter } from \"react-router\";\n\nimport \"../styles/AboutPage.styl\";\n\nconst mechatLogo = require(\"../images/mechat.png\");\n\n@inject(\"store\")\n@observer\nclass AboutPage extends Component {\n    render() {\n        return (\n            <div className=\"mechat-about\">\n                <p className=\"mechat-about-title\">关于 MeChat</p>\n                <div className=\"mechat-about-logo\">\n                    <img src={mechatLogo} alt=\"MeChat Logo\" />\n                </div>\n                <div className=\"mechat-about-title\">\n                    <h1>MeChat</h1>\n                    <span>ver. 1.0</span>\n                </div>\n                <div className=\"mechat-about-description\">\n                    <p>一个简单的、跨平台的电脑版“山寨微信”</p>\n                    <p>\n                        这是厦门大学信息学院 2018\n                        级计算机系数据结构课程设计：题目七《实现电脑版的微信》\n                    </p>\n                    <p>基于 Node.js + Electron 构建</p>\n                    <p>源代码可参见该项目的 GitHub 仓库: https://github.com/kirainmoe/mechat</p>\n                </div>\n                <div className=\"mechat-about-copyright\">\n                    <p>&copy;2019 - present, written by Yuhang Qiu (Yume Maruyama)</p>\n                    <p>XMU 2018 Data-Structure Curriculum Design</p>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(AboutPage);\n","import React, { Component } from \"react\";\r\nimport { inject, observer } from \"mobx-react\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport honoka from \"honoka\";\r\n\r\nimport \"../styles/GroupList.styl\";\r\n\r\nconst groupAvatar = require(\"../images/group.png\");\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass GroupList extends Component {\r\n    renderGroupsList() {\r\n        const res = [];\r\n        let cnt = 0;\r\n        this.props.store.groups.forEach(group => {\r\n            if (!group) return;\r\n            res.push(\r\n                <NavLink className=\"mechat-dialog\" to={\"/app/groups/\" + group.id} key={cnt++}>\r\n                    <div className=\"mechat-dialog-avatar\">\r\n                        <img src={groupAvatar} alt=\"avatar\" />\r\n                    </div>\r\n                    <div className=\"mechat-dialog-meta\">\r\n                        <p className=\"mechat-dialog-title\">{group.name}</p>\r\n                        <p className=\"mechat-dialog-mess\">{group.description}</p>\r\n                    </div>\r\n                </NavLink>\r\n            );\r\n        });\r\n        return res;\r\n    }\r\n\r\n    componentWillMount() {\r\n        this.props.store.reloadGroupList();\r\n    }\r\n\r\n    addGroup() {\r\n        const groupId = this.input.value,\r\n            addGroupUrl = this.props.store.API(\"addGroup\");\r\n        honoka\r\n            .post(addGroupUrl, {\r\n                data: {\r\n                    uid: this.props.store.uid,\r\n                    token: this.props.store.token,\r\n                    groupId\r\n                }\r\n            })\r\n            .then(res => {\r\n                if (res.status === 403) {\r\n                    this.props.store.forceLogout();\r\n                } else {\r\n                    if (res.status === 200) {\r\n                        alert(\"添加群成功。\");\r\n                        this.props.store.addGroup(res.payload);\r\n                    } else {\r\n                        alert(\"添加群失败，原因是：\" + res.message);\r\n                    }\r\n                }\r\n            });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"mechat-messages mechat-grouplist\">\r\n                <h1 className=\"mechat-messages-title\">群组</h1>\r\n                <div className=\"mechat-friends-add\">\r\n                    <input\r\n                        type=\"text\"\r\n                        name=\"friends\"\r\n                        placeholder=\"搜索群 ID 加入群\"\r\n                        ref={ref => (this.input = ref)}\r\n                    />\r\n                    <button onClick={() => this.addGroup()}>+</button>\r\n                </div>\r\n                <div className=\"mechat-messages-list\">\r\n                    {(() => this.renderGroupsList())()}\r\n                    <NavLink\r\n                        to={\"/app/createNewGroup\"}\r\n                        className=\"mechat-group-create\"\r\n                        title=\"发起新的群聊\"\r\n                    >\r\n                        <i className=\"fa fa-plus\"></i>\r\n                    </NavLink>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default GroupList;\r\n","import React, { Component } from \"react\";\r\nimport { inject, observer } from \"mobx-react\";\r\nimport { withRouter } from \"react-router\";\r\n\r\nimport honoka from \"honoka\";\r\n\r\nimport \"../styles/CreateNewGroupPage.styl\";\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass CreateNewGroupPage extends Component {\r\n    renderMemberLists() {\r\n        const memberComponents = [],\r\n            friends = this.props.store.friends;\r\n        let cnt = 0;\r\n        friends.forEach(friend => {\r\n            memberComponents.push(\r\n                <div className=\"mechat-cng-member-item\" key={cnt}>\r\n                    <input\r\n                        className=\"mechat-cng-member-checkbox\"\r\n                        type=\"checkbox\"\r\n                        uid={friend.uid}\r\n                    />\r\n                    <span>\r\n                        {friend.alias ? `${friend.alias} (${friend.nickname})` : friend.nickname}\r\n                    </span>\r\n                </div>\r\n            );\r\n            cnt++;\r\n        });\r\n        return memberComponents;\r\n    }\r\n\r\n    createGroup() {\r\n        const { uid, token } = this.props.store;\r\n        const name = this.groupName.value,\r\n            description = this.groupDesc.value;\r\n        const members = [];\r\n        const checkBoxes = this.wrapper.querySelectorAll('input[type=\"checkbox\"]');\r\n        checkBoxes.forEach(item => {\r\n            if (item.checked) {\r\n                members.push(item.getAttribute(\"uid\"));\r\n            }\r\n        });\r\n        honoka\r\n            .post(this.props.store.API(\"createGroup\"), {\r\n                data: {\r\n                    uid,\r\n                    token,\r\n                    name,\r\n                    description,\r\n                    members: JSON.stringify(members)\r\n                }\r\n            })\r\n            .then(res => {\r\n                if (res.status === 403) {\r\n                  this.props.store.forceLogout();\r\n                } else if (res.status !== 200) {\r\n                    alert(`创建群失败，原因可能是：${res.message}`);\r\n                    console.log(res);\r\n                } else {\r\n                    alert(\"创建群聊成功！\");\r\n                    this.props.history.push(\"/app/groups\");\r\n                }\r\n            });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"mechat-create-new-group\">\r\n                <p className=\"mechat-cng-title\">创建新群组</p>\r\n                <div className=\"mechat-cng-container\">\r\n                    <p className=\"mechat-cng-input\">\r\n                        群组名称：\r\n                        <input type=\"text\" ref={ref => (this.groupName = ref)} />\r\n                    </p>\r\n                    <p className=\"mechat-cng-input\">\r\n                        群组简介：\r\n                        <input type=\"text\" ref={ref => (this.groupDesc = ref)} />\r\n                    </p>\r\n                    <div className=\"mechat-cng-members\">\r\n                        <p>邀请好友：</p>\r\n                        <div\r\n                            className=\"mechat-cng-members-wrapper\"\r\n                            ref={ref => (this.wrapper = ref)}\r\n                        >\r\n                            {this.renderMemberLists()}\r\n                        </div>\r\n                    </div>\r\n                    <button\r\n                        type=\"button\"\r\n                        className=\"mechat-cng-button\"\r\n                        onClick={() => this.createGroup()}\r\n                    >\r\n                        创建群聊\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(CreateNewGroupPage);\r\n","import React, { Component } from \"react\";\r\nimport { inject, observer } from \"mobx-react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport honoka from \"honoka\";\r\n\r\nconst groupAvatar = require(\"../images/group.png\");\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass GroupPage extends Component {\r\n    chatWith(uid, nickname) {\r\n        if (!this.props.store.messageList[uid]) this.props.store.addDialog(uid, true);\r\n        this.props.store.setChattingWith(uid, nickname, groupAvatar);\r\n    }\r\n\r\n    exitGroup() {\r\n        const exitUrl = this.props.store.API(\"exitGroup\");\r\n        honoka\r\n            .post(exitUrl, {\r\n                data: {\r\n                    uid: this.props.store.uid,\r\n                    token: this.props.store.token,\r\n                    groupId: this.props.match.params.id\r\n                }\r\n            })\r\n            .then(res => {\r\n                if (res.status === 403) {\r\n                    this.props.store.forceLogout();\r\n                } else {\r\n                    if (res.status === 200) {\r\n                        alert(\"退群成功.\");\r\n                        this.props.store.exitGroup(this.props.match.params.id);\r\n                    } else alert(\"退群失败，原因是：\" + res.message);\r\n                }\r\n            });\r\n    }\r\n\r\n    render() {\r\n        const id = this.props.match.params.id;\r\n        let group = this.props.store.groupKeyMap[id];\r\n        if (!group) return null;\r\n        return (\r\n            <div className=\"mechat-profile-page\">\r\n                <p className=\"mechat-profile-title\">群资料</p>\r\n                <div className=\"mechat-profile-container\">\r\n                    <div className=\"mechat-profile-avatar\">\r\n                        <img src={groupAvatar} alt=\"avatar\" />\r\n                    </div>\r\n                    <div className=\"mechat-profile-meta\">\r\n                        <h1 className=\"mechat-profile-nickname\">{group.name}</h1>\r\n                        <p className=\"mechat-profile-account\">群 ID：{group.id}</p>\r\n\r\n                        <p className=\"mechat-profile-signature\">简介：{group.description}</p>\r\n\r\n                        <Link\r\n                            className=\"mechat-profile-chat\"\r\n                            to={\"/app/groupMessage/\" + group.id}\r\n                            onClick={() => this.chatWith(group.id, group.name)}\r\n                        >\r\n                            聊天\r\n                        </Link>\r\n                        <button className=\"mechat-profile-exit\" onClick={() => this.exitGroup()}>\r\n                            退群\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(GroupPage);\r\n","import React, { Component } from \"react\";\r\nimport { inject, observer } from \"mobx-react\";\r\n\r\nimport Bubble from \"./subcomponents/Bubble\";\r\n\r\nimport \"../styles/GroupChatPage.styl\";\r\nimport { withRouter } from \"react-router\";\r\nimport honoka from \"honoka\";\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass GroupChatPage extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            inviting: false\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.onkeydown = e => {\r\n            const keycode = e.which ? e.which : e.keyCode;\r\n            if (e.ctrlKey && keycode === 13) {\r\n                this.sendMessage();\r\n            }\r\n        };\r\n        window.browserWindow.getCurrentWindow().setSize(1000, 600);\r\n\r\n        this.chatContent.scrollTop = this.chatContent.scrollHeight;\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.onkeydown = null;\r\n        window.browserWindow.getCurrentWindow().setSize(800, 600);\r\n    }\r\n\r\n    onClipboardPaste(e) {\r\n        const item = e.clipboardData.items;\r\n        if (!item.length) return;\r\n        const blob = item[0].getAsFile();\r\n        if (!blob || !blob.type || !blob.type.indexOf(\"image\") === -1) return;\r\n        this.sendImage(blob);\r\n    }\r\n\r\n    renderChatContent() {\r\n        const chats = [],\r\n            uid = this.props.match.params.id,\r\n            rawChats = this.props.store.getRawChats(uid),\r\n            myAvatar = this.props.store.avatar;\r\n\r\n        let cnt = 0,\r\n            lastTime = 0;\r\n        if (!rawChats.forEach) {\r\n            this.props.store.reloadMessageList();\r\n            return;\r\n        }\r\n\r\n        rawChats.forEach(chat => {\r\n            // 处理信息接收时间间隔\r\n            if (chat.timestamp - lastTime >= 1000000) {\r\n                const date = new Date(chat.timestamp);\r\n                let dateStr = \"\";\r\n                dateStr += date.getHours() < 10 ? \"0\" + date.getHours() : date.getHours();\r\n                dateStr += \":\";\r\n                dateStr += date.getMinutes() < 10 ? \"0\" + date.getMinutes() : date.getMinutes();\r\n                chats.push(\r\n                    <div key={cnt++} className={\"mechat-chat-item-time\"}>\r\n                        {dateStr}\r\n                    </div>\r\n                );\r\n                lastTime = chat.timestamp;\r\n            }\r\n            chats.push(\r\n                <Bubble\r\n                    chat={chat}\r\n                    chatWith={this.props.store.chattingWith}\r\n                    myAvatar={myAvatar}\r\n                    avatar={this.props.store.API(\"avatar/\") + chat.avatar}\r\n                    key={cnt++}\r\n                />\r\n            );\r\n        });\r\n        return chats;\r\n    }\r\n\r\n    changeScrollTop() {\r\n        this.chatContent.scrollTop = this.chatContent.scrollHeight;\r\n    }\r\n\r\n    sendMessage() {\r\n        const text = this.textarea.value,\r\n            uid = this.props.match.params.id;\r\n        this.props.store.sendMessage(uid, text, \"string\", true);\r\n        this.props.store.setRead(uid);\r\n        this.textarea.value = \"\";\r\n        this.changeScrollTop();\r\n\r\n        honoka\r\n            .post(this.props.store.API(\"sendMessage\"), {\r\n                data: {\r\n                    uid: this.props.store.uid,\r\n                    to: uid,\r\n                    type: \"string\",\r\n                    content: text,\r\n                    token: this.props.store.token,\r\n                    target: \"group\"\r\n                }\r\n            })\r\n            .then(res => {\r\n                if (res.status !== 200) {\r\n                    alert(\"发送信息失败，原因可能是：\" + res.message);\r\n                    return;\r\n                }\r\n            });\r\n    }\r\n\r\n    selectImage() {\r\n        this.imageInput.click();\r\n    }\r\n\r\n    sendImage(raw) {\r\n        const file = raw ? raw : this.imageInput.files[0];\r\n        if (file.size / 1024 / 1024 > 2) {\r\n            alert(\"发送的图片尺寸不能超过 2MB\");\r\n            return;\r\n        }\r\n\r\n        const reader = new FileReader(),\r\n            uid = this.props.match.params.id;\r\n        reader.readAsDataURL(file);\r\n        reader.onload = e => {\r\n            const base64Content = reader.result;\r\n            this.props.store.sendMessage(uid, base64Content, \"image\", true);\r\n            honoka\r\n                .post(this.props.store.API(\"sendMessage\"), {\r\n                    data: {\r\n                        uid: this.props.store.uid,\r\n                        to: uid,\r\n                        type: \"image\",\r\n                        content: base64Content,\r\n                        token: this.props.store.token,\r\n                        target: \"group\"\r\n                    }\r\n                })\r\n                .then(res => {\r\n                    if (res.status !== 200) {\r\n                        alert(\"发送信息失败，原因可能是：\" + res.message);\r\n                        return;\r\n                    }\r\n                });\r\n        };\r\n    }\r\n\r\n    doInvite() {\r\n        const uid = this.props.store.uid,\r\n            token = this.props.store.token,\r\n            target = this.inviteInput.value;\r\n        honoka\r\n            .post(this.props.store.API(\"inviteToGroup\"), {\r\n                data: {\r\n                    uid,\r\n                    token,\r\n                    groupId: this.props.match.params.id,\r\n                    target\r\n                }\r\n            })\r\n            .then(res => {\r\n                if (res.status === 200) {\r\n                    alert(\"邀请成功！\");\r\n                    this.props.store.reloadGroupList();\r\n                    this.setState({ inviting: false });\r\n                }\r\n            });\r\n    }\r\n\r\n    renderMembers() {\r\n        if (!this.props.store.groupKeyMap[this.props.match.params.id]) return null;\r\n        const rawMembers = this.props.store.groupKeyMap[this.props.match.params.id].members,\r\n            members = [];\r\n\r\n        let cnt = 0;\r\n        rawMembers.forEach(member => {\r\n            members.push(\r\n                <div className=\"mechat-group-members-item\" key={cnt++}>\r\n                    <img src={this.props.store.API(\"avatar/\") + member.avatar} alt=\"avatar\" />\r\n                    <span>{member.nickname}</span>\r\n                </div>\r\n            );\r\n        });\r\n        return members;\r\n    }\r\n\r\n    render() {\r\n        const interval = setInterval(() => {\r\n            if (!this.chatContent) return;\r\n            this.changeScrollTop();\r\n            clearInterval(interval);\r\n        }, 50);\r\n\r\n        return (\r\n            <div\r\n                className=\"mechat-chat-page mechat-group-chat\"\r\n                onPaste={e => this.onClipboardPaste(e)}\r\n            >\r\n                <div className=\"mechat-group-container\">\r\n                    <div className=\"mechat-chat-title\">\r\n                        {this.props.store.chattingWith.nickname}\r\n                    </div>\r\n\r\n                    <div className=\"mechat-chat-content\" ref={ref => (this.chatContent = ref)}>\r\n                        {(() => this.renderChatContent())()}\r\n                    </div>\r\n\r\n                    <div className=\"mechat-chat-textarea\">\r\n                        <textarea name=\"chat-text\" ref={ref => (this.textarea = ref)}></textarea>\r\n                        <input\r\n                            accept=\"image/*\"\r\n                            ref={ref => (this.imageInput = ref)}\r\n                            type=\"file\"\r\n                            onChange={() => this.sendImage()}\r\n                        />\r\n                        <button\r\n                            className=\"mechat-chat-image\"\r\n                            title=\"发送图片\"\r\n                            onClick={() => this.selectImage()}\r\n                        >\r\n                            <i className=\"fa fa-image\"></i>\r\n                        </button>\r\n                        <button className=\"mechat-chat-send\" onClick={() => this.sendMessage()}>\r\n                            发送\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n                <div className=\"mechat-group-members\">\r\n                    <div className=\"mechat-chat-title\">\r\n                        群成员\r\n                        <span\r\n                            className=\"fa fa-plus invite-button\"\r\n                            title=\"邀请新成员\"\r\n                            onClick={() => this.setState({ inviting: true })}\r\n                        ></span>\r\n                    </div>\r\n\r\n                    <div className=\"mechat-group-members-list\">\r\n                        {this.renderMembers()}\r\n                        <div\r\n                            className=\"mechat-group-members-invite\"\r\n                            style={{\r\n                                display: this.state.inviting ? \"block\" : \"none\"\r\n                            }}\r\n                        >\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"输入用户名来邀请用户入群！\"\r\n                                ref={ref => (this.inviteInput = ref)}\r\n                            />\r\n                            <button type=\"button\" onClick={() => this.doInvite()}>\r\n                                邀请\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(GroupChatPage);\r\n","import React, { Component } from \"react\";\nimport { inject, observer } from \"mobx-react\";\nimport { withRouter } from \"react-router\";\nimport { Link } from \"react-router-dom\";\n\nimport \"../styles/FriendCircle.styl\";\nimport honoka from \"honoka\";\n\n@inject(\"store\")\n@observer\nclass FriendCircle extends Component {\n    componentDidMount() {\n        this.props.store.reloadPostList();\n    }\n\n    likePost(id) {\n        console.log(id);\n        honoka.post(this.props.store.API('likePost'), {\n            data: {\n                uid: this.props.store.uid,\n                token: this.props.store.token,\n                target: id,\n                offset: this.props.store.likes[id] ? -1 : 1\n            }\n        }).then(res => {\n            if (res.status === 403) {\n                this.props.store.forceLogout();\n            } else if (res.status !== 200) {\n                console.log('FriendCircle.likePost', res.message);\n            } else {\n                this.props.store.likePost(id);\n            }\n        });\n    }\n\n    deletePost(id) {\n        honoka.post(this.props.store.API('deletePost'), {\n            data: {\n                uid: this.props.store.uid,\n                token: this.props.store.token,\n                target: id\n            }\n        }).then(res => {\n            if (res.status === 403) {\n                this.props.store.forceLogout();\n            } else if (res.status !== 200) {\n                console.log('FriendCircle.deletePost', res.message);\n            } else {\n                this.props.store.deletePost(id);\n            }\n        });\n    }\n\n    renderPosts() {\n        const posts = [],\n            div = document.createElement(\"div\");\n        let cnt = 0;\n        this.props.store.posts.forEach(post => {\n            div.innerText = post.content;\n            const content = div.innerHTML.replace(/\\n/g, \"<br/>\");\n            const liked = this.props.store.likes[post._id];\n\n            posts.push(\n                <div className=\"mechat-fc-item\" key={cnt++}>\n                    <div className=\"mechat-fc-item-meta\">\n                        <img\n                            className=\"mechat-fc-item-meta-avatar\"\n                            src={this.props.store.API(\"avatar\", post.avatar)}\n                            alt=\"avatar\"\n                        />\n                        <span className=\"mechat-fc-item-meta-nickname\">{post.nickname}</span>\n                    </div>\n                    <div\n                        className=\"mechat-fc-item-content\"\n                        dangerouslySetInnerHTML={{\n                            __html: content\n                        }}\n                    ></div>\n                    <div className=\"mechat-fc-item-actions\">\n                        <button className={\"mechat-fc-like\" + (liked ? \" liked\" : \"\")} onClick={() => this.likePost(post._id)}>\n                            <i className=\"fa fa-heart\" />\n                            <span className=\"mechat-fc-like-cnt\">{post.likes}</span>\n                        </button>\n                        <Link to={`/app/posts/${post._id}`}>\n                            <i className=\"fa fa-commenting-o\" />\n                        </Link>\n                        {post.createdBy === this.props.store.uid ? (\n                            <button\n                                className=\"mechat-fc-delete\"\n                                onClick={() => this.deletePost(post._id)}\n                            >\n                                <i className=\"fa fa-trash\"></i>\n                            </button>\n                        ) : null}\n                    </div>\n                </div>\n            );\n        });\n        return posts;\n    }\n\n    render() {\n        const curPath = this.props.match.path.indexOf(\"circle\") >= 0 ? 1 : 0;\n        return (\n            <div className={\"mechat-friend-circle \" + (curPath ? \"mechat-fc-full-width\" : \"\")}>\n                <h1 className=\"mechat-messages-title\">好友动态</h1>\n                <div className=\"mechat-fc-lists\">\n                    {this.renderPosts()}\n                    <div className=\"mechat-fc-boundary\">I have boundaries.</div>\n                </div>\n                <Link to=\"/app/createPost\" className=\"mechat-fc-create\">\n                    <i className=\"fa fa-plus\"></i>\n                </Link>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(FriendCircle);\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router';\nimport { inject, observer } from 'mobx-react';\nimport honoka from 'honoka';\n\nimport '../styles/CreatePostPage.styl';\n\n@inject('store')\n@observer\nclass CreatePostPage extends Component {\n    createPost() {\n        const content = this.textarea.value;\n        honoka.post(this.props.store.API('createPost'), {\n            data: {\n                uid: this.props.store.uid,\n                token: this.props.store.token,\n                content\n            }\n        }).then(res => {\n            if (res.status === 403) {\n                this.props.store.forceLogout();\n            } else if (res.status !== 200) {\n                alert('发送失败，原因是：' + res.message);\n            } else {\n                const id = res.payload.id;      // todo\n                this.props.store.pushNewPost(id, content, []);\n            }\n        });\n    }\n\n    render() {\n        return (\n            <div className=\"mechat-create-post\">\n                <h1 className=\"mechat-cp-title\">\n                    新的动态\n                </h1>\n\n                <div className=\"mechat-cp-container\">\n                    <textarea\n                        ref={ref => this.textarea = ref}\n                        className=\"mechat-cp-textarea\"\n                        placeholder=\"分享新鲜事...\">\n                    </textarea>\n\n                    <div className=\"mechat-cp-images\"></div>\n\n                    <button className=\"mechat-cp-send\" onClick={() => this.createPost()}>\n                        发送\n                    </button>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(CreatePostPage);","import React, { Component } from \"react\";\nimport { withRouter } from \"react-router\";\nimport { Link } from \"react-router-dom\";\nimport { inject, observer } from \"mobx-react\";\nimport honoka from \"honoka\";\n\n@inject(\"store\")\n@observer\nclass PostPage extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            returnId: null,\n            nickname: null\n        };\n    }\n\n    componentDidMount() {\n        const post = this.getPost(this.props.match.params.id);\n        this.setState({\n            returnId: this.props.match.params.id,\n            nickname: post ? post.nickname : null\n        });\n    }\n\n    getPost(id) {\n        for (const i in this.props.store.posts) {\n            if (this.props.store.posts[i]._id === id)\n                return this.props.store.posts[i];\n        }\n        return null;\n    }\n\n    reply() {\n        honoka\n            .post(this.props.store.API(\"createPost\"), {\n                data: {\n                    uid: this.props.store.uid,\n                    token: this.props.store.token,\n                    content: this.commentContent.value,\n                    type: 2,\n                    replyTo: this.state.returnId\n                }\n            })\n            .then(res => {\n                console.log(res);\n                if (res.status === 403) {\n                    this.props.store.forceLogout();\n                } else if (res.status !== 200) {\n                    console.log(\"FriendCircle.likePost\", res.message);\n                } else {\n                    this.props.store.reloadPostList();\n                    this.sendButton.innerHTML = \"已发送~\";\n                    setTimeout(() => this.sendButton.innerHTML = \"回复\", 4000);\n                }\n            });\n    }\n\n    likePost(id) {\n        honoka\n            .post(this.props.store.API(\"likePost\"), {\n                data: {\n                    uid: this.props.store.uid,\n                    token: this.props.store.token,\n                    target: id,\n                    offset: this.props.store.likes[id] ? -1 : 1\n                }\n            })\n            .then(res => {\n                if (res.status === 403) {\n                    this.props.store.forceLogout();\n                } else if (res.status !== 200) {\n                    console.log(\"FriendCircle.likePost\", res.message);\n                } else {\n                    this.props.store.likePost(id);\n                }\n            });\n    }\n\n    deletePost(id) {\n        honoka\n            .post(this.props.store.API(\"deletePost\"), {\n                data: {\n                    uid: this.props.store.uid,\n                    token: this.props.store.token,\n                    target: id\n                }\n            })\n            .then(res => {\n                if (res.status === 403) {\n                    this.props.store.forceLogout();\n                } else if (res.status !== 200) {\n                    console.log(\"FriendCircle.deletePost\", res.message);\n                } else {\n                    this.props.store.deletePost(id);\n                }\n            });\n    }\n\n    renderComments(post) {\n        const res = [];\n        if (!post) return;\n\n        post.comments.forEach(comment => {\n            res.push(\n                <div\n                    key={comment._id}\n                    className=\"mechat-fc-comment-item\"\n                    onClick={(e) => {\n                        e.preventDefault();\n                        e.stopPropagation();\n\n                        this.setState({\n                            returnId: comment._id,\n                            nickname: comment.nickname\n                        });\n                        this.commentContent.focus();\n                    }}\n                >\n                    <span className=\"mechat-fc-comment-author\">\n                        {comment.nickname}\n                    </span>\n                    <span>回复</span>\n                    <span className=\"mechat-fc-comment-reply-target\">\n                        {post.nickname}：\n                    </span>\n                    <span>{comment.content}</span>\n\n                    <div className=\"mechat-fc-subcomment-list\">\n                        {this.renderComments(comment)}\n                    </div>\n                </div>\n            );\n        });\n\n        return res;\n    }\n\n    render() {\n        const postId = this.props.match.params.id;\n        const post = this.getPost(postId),\n            div = document.createElement(\"div\");\n        if (!post) return null;\n        div.innerText = post.content;\n        const content = div.innerHTML.replace(/\\n/g, \"<br/>\");\n        const liked = this.props.store.likes[post._id];\n\n        return (\n            <div className=\"mechat-post\">\n                <h1 className=\"mechat-messages-title\">动态详情</h1>\n                <div className=\"mechat-post-container\">\n                    <div className=\"mechat-fc-item\">\n                        <div className=\"mechat-fc-item-meta\">\n                            <img\n                                className=\"mechat-fc-item-meta-avatar\"\n                                src={this.props.store.API(\n                                    \"avatar\",\n                                    post.avatar\n                                )}\n                                alt=\"avatar\"\n                            />\n                            <span className=\"mechat-fc-item-meta-nickname\">\n                                {post.nickname}\n                            </span>\n                        </div>\n                        <div\n                            className=\"mechat-fc-item-content\"\n                            dangerouslySetInnerHTML={{\n                                __html: content\n                            }}\n                        ></div>\n                        <div className=\"mechat-fc-item-actions\">\n                            <button\n                                className={\n                                    \"mechat-fc-like\" + (liked ? \" liked\" : \"\")\n                                }\n                                onClick={() => this.likePost(post._id)}\n                            >\n                                <i className=\"fa fa-heart\" />\n                                <span className=\"mechat-fc-like-cnt\">\n                                    {post.likes}\n                                </span>\n                            </button>\n                            <Link to={`/app/posts/${post._id}`}>\n                                <i className=\"fa fa-commenting-o\" />\n                            </Link>\n                            {post.createdBy === this.props.store.uid ? (\n                                <button\n                                    className=\"mechat-fc-delete\"\n                                    onClick={() => this.deletePost(post._id)}\n                                >\n                                    <i className=\"fa fa-trash\"></i>\n                                </button>\n                            ) : null}\n                        </div>\n                        <div className=\"mechat-fc-item-comments\" style={{\n                            display: post.comments.length ? 'block' : 'none'\n                        }}>\n                            {this.renderComments(post)}\n                        </div>\n                        <div className=\"mechat-fc-item-input\">\n                            <textarea\n                                ref={ref => (this.commentContent = ref)}\n                                className=\"mechat-fc-textarea\"\n                                placeholder={`回复 ${this.state.nickname}：`}\n                            />\n                            <button\n                                ref={ref => (this.sendButton = ref)}\n                                className=\"mechat-chat-send\"\n                                onClick={() => this.reply()}\n                            >\n                                回复\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(PostPage);\n","import React, { Component } from \"react\";\nimport { Route } from \"react-router\";\nimport { HashRouter, withRouter } from \"react-router-dom\";\nimport { inject, observer } from \"mobx-react\";\n\n/* Stylesheet */\nimport \"../styles/MainPage.styl\";\n\n/* Components */\nimport Navbar from \"./Navbar\";\nimport MessageList from \"./MessageList\";\nimport ChatPage from \"./ChatPage\";\nimport FriendsList from \"./FriendsList\";\nimport ProfilePage from \"./ProfilePage\";\nimport ProfileEdit from \"./ProfileEdit\";\nimport AboutPage from \"./AboutPage\";\nimport GroupList from \"./GroupList\";\nimport CreateNewGroupPage from \"./CreateNewGroupPage\";\nimport GroupPage from \"./GroupPage\";\nimport GroupChatPage from \"./GroupChatPage\";\nimport FriendCircle from \"./FriendCircle\";\nimport CreatePostPage from \"./CreatePostPage\";\nimport PostPage from \"./PostPage\";\n\n@inject(\"store\")\n@observer\nclass MainPage extends Component {\n    retry = 0;\n\n    componentWillMount() {\n        if (sessionStorage.getItem(\"userInfo\") == null) this.props.history.push(\"/\");\n        else this.props.store.setUserInfo(JSON.parse(sessionStorage.getItem(\"userInfo\")));\n\n        // establish socket connection\n        this.createSocketConnection();\n\n        // get friends list\n        this.props.store.reloadFriendsList();\n\n        // get groups list\n        this.props.store.reloadGroupList();\n\n        // get messages list\n        this.props.store.reloadMessageList();\n    }\n\n    componentWillUnmount() {\n        this.ws.close();\n    }\n\n    componentDidMount() {\n        window.browserWindow.getCurrentWindow().setSize(800, 600);\n        this.props.store.setRouter(this.props.history);\n    }\n\n    // 创建与服务器的 websocket 链接\n    createSocketConnection() {\n        this.ws = new WebSocket(this.props.store.configUrl.wsUrl);\n        const ws = this.ws;\n\n        ws.addEventListener(\"open\", () => {\n            ws.send(\n                JSON.stringify({\n                    uid: this.props.store.uid,\n                    token: this.props.store.token\n                })\n            );\n            this.retry = 0;\n            this.props.store.connectSocketLink(this.ws);\n        });\n\n        ws.addEventListener(\"message\", msg => {\n            msg = JSON.parse(msg.data);\n            switch (msg.type) {\n                // receive new message\n                case \"message\":\n                    this.props.store.pushNewMessage(msg.from, msg.payload);\n                    break;\n                case \"friends\":\n                    this.props.store.reloadFriendsList();\n                    break;\n                case \"groups\":\n                    this.props.store.reloadGroupList();\n                    break;\n                default:\n                    break;\n            }\n        });\n\n        ws.addEventListener(\"close\", () => {\n            if (this.retry && this.retry >= 3) {\n                alert(\"连接错误。返回登录页面...\");\n                this.props.history.push(\"/\");\n                return;\n            } else if (this.props.store.token) {\n                this.retry = this.retry ? this.retry + 1 : 1; // retry times\n                setTimeout(() => this.createSocketConnection(), 5000); // recreate socket connection\n            }\n        });\n\n        ws.addEventListener(\"error\", () => {\n            alert(\"连接错误。返回登录页面...\");\n            this.props.history.push(\"/\");\n        });\n    }\n\n    render() {\n        return (\n            <div className=\"mechat-mainpage\">\n                <HashRouter history={this.props.history}>\n                    <Route path=\"/app\">\n                        <Navbar />\n                    </Route>\n\n                    <Route path=\"/app/message\">\n                        <MessageList />\n                    </Route>\n\n                    <Route path=\"/app/message/:id\">\n                        <ChatPage />\n                    </Route>\n\n                    <Route path=\"/app/groupMessage/:id\">\n                        <MessageList />\n                        <GroupChatPage />\n                    </Route>\n\n                    <Route path=\"/app/friends\">\n                        <FriendsList />\n                    </Route>\n\n                    <Route path=\"/app/friends/:id\">\n                        <ProfilePage />\n                    </Route>\n\n                    <Route path=\"/app/groups\">\n                        <GroupList />\n                    </Route>\n\n                    <Route path=\"/app/groups/:id\">\n                        <GroupPage />\n                    </Route>\n\n                    <Route path=\"/app/createNewGroup\">\n                        <GroupList />\n                        <CreateNewGroupPage />\n                    </Route>\n\n                    <Route path=\"/app/editProfile\">\n                        <FriendsList />\n                        <ProfileEdit />\n                    </Route>\n\n                    <Route path=\"/app/circle\">\n                        <FriendCircle />\n                    </Route>\n\n                    <Route path=\"/app/posts/:id\">\n                        <FriendCircle/>\n                        <PostPage/>\n                    </Route>\n\n                    <Route path=\"/app/createPost\">\n                        <FriendCircle />\n                        <CreatePostPage />\n                    </Route>\n\n                    <Route path=\"/app/about\">\n                        <AboutPage />\n                    </Route>\n                </HashRouter>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(MainPage);\n","const production = process.env.NODE_ENV === 'production';\r\n\r\nexport default {\r\n    apiUrl: production ? 'https://mechat.kirainmoe.com/' : 'http://localhost:61616/',\r\n    wsUrl: production ? 'ws://mechat.kirainmoe.com/entry' : 'ws://localhost:61616/entry',\r\n};","import { observable, action, get } from 'mobx';\n\nimport config from '../config';\nimport honoka from 'honoka';\n\nconst defaultAvatar = require('../images/defaultAvatar.jpg');\nconst groupAvatar = require('../images/group.png');\n\nexport default class Model {\n    // 当前登录用户信息\n    @observable nickname = null;\n    @observable username = null;\n    @observable uid = null;\n    @observable mail = null;\n    @observable signature = null;\n    @observable avatar = defaultAvatar;\n    @observable token = null;\n\n    // 当前登录用户好友和群聊\n    @observable friends = [];\n    @observable groups = [];\n    @observable posts = [];\n    @observable uidKeyMap = {};\n    @observable groupKeyMap = {};\n\n    @observable socketLink = null;          // 全局 WebSocket 对象\n    @observable messageList = {};           // 消息列表\n    @observable currentDialog = null;       // 当前会话信息\n    @observable chattingWith = {\n        uid: null,\n        nickname: null,\n        avatar: null\n    };\n    @observable fetching = false;           // 消息列表更新状态\n    @observable router = null;              // react-router 全局路由对象\n    @observable likes = {};\n\n    // 后端 Restful API 链接\n    @observable configUrl = {\n        httpUrl: config.apiUrl,\n        wsUrl: config.wsUrl\n    };\n\n    // 构建 API 地址\n    @get\n    API(uri, resource) {\n        if (resource)\n            return this.configUrl.httpUrl + uri + '/' + resource;\n        return this.configUrl.httpUrl + uri;\n    }\n    @get\n    wsAPI(uri) {\n        return this.configUrl.wsUrl + uri;\n    }\n\n    // 获取和某一用户/群聊的聊天记录\n    @get\n    getRawChats(uid) {\n        return this.messageList[uid] ? this.messageList[uid].records : {};\n    }\n\n    // 清空所有状态\n    @action\n    initModelState() {\n        this.nickname = null;\n        this.username = null;\n        this.uid = null;\n        this.mail = null;\n        this.signature = null;\n        this.avatar = defaultAvatar;\n        this.token = null;\n        this.friends = [];\n        this.groups = [];\n        this.posts = [];\n        this.uidKeyMap = {};\n        this.groupKeyMap = {};\n        if (this.socketLink)\n            this.socketLink.close();\n        this.socketLink = null;\n        this.messageList = {};\n        this.currentDialog = null;\n        this.chattingWith = {\n            uid: null,\n            nickname: null,\n            avatar: null\n        };\n        this.fetching = false;\n    }\n\n    // 获取 react-router 路由对象\n    @action\n    setRouter(r) {\n        this.router = r;\n    }\n\n    // 强制登出用户\n    @action\n    forceLogout(noAlert) {\n        if (!noAlert)\n            alert('身份验证发生问题，请重新登录');\n\n        sessionStorage.removeItem('userInfo');\n        this.initModelState();\n        this.router.push('/');\n    }\n\n    // 设置当前登录用户信息\n    @action\n    setUserInfo(user) {\n        this.nickname = user.nickname;\n        this.username = user.username;\n        this.signature = user.signature;\n        this.uid = user.id;\n        this.avatar = user.avatar;\n        this.token = user.token;\n        this.mail = user.mail;\n    }\n\n    // 设置新头像\n    @action\n    setNewAvatar(url, flag) {\n        this.avatar = flag ? url : this.API('avatar', url);\n    }\n\n    // 添加好友操作\n    @action\n    addFriend(friend) {\n        this.friends.push(friend);\n        this.uidKeyMap[friend.uid] = friend;\n    }\n\n    // 添加群操作\n    @action\n    addGroup(group) {\n        this.groups.push(group);\n        this.groupKeyMap[group.id] = group;\n    }\n\n    // 更新、替换好友列表\n    @action\n    updateFriends(friends) {\n        this.friends = friends;\n        friends.forEach(friend => {\n            this.uidKeyMap[friend.uid] = friend;\n            if (this.messageList[friend.uid]) {\n                this.messageList[friend.uid].nickname = friend.nickname;\n                this.messageList[friend.uid].avatar = friend.avatar;\n            }\n        });\n    }\n\n    // 更新、替换群列表\n    @action\n    updateGroups(groups) {\n        this.groups = groups;\n        groups.forEach(group => {\n            this.groupKeyMap[group.id] = group;\n            if (this.messageList[group.id])\n                this.messageList[group.id].nickname = group.name;\n        });\n    }\n\n    // 创建并保存 websocket 链接\n    @action\n    connectSocketLink(socket) {\n        this.socketLink = socket;\n    }\n\n    // 发起新的会话\n    @action\n    addDialog(uid, isGroup) {\n        this.messageList[uid] = {\n            with: uid,\n            nickname: isGroup\n                ? this.groupKeyMap[uid].name\n                : this.uidKeyMap[uid].alias\n                    ? this.uidKeyMap[uid].alias\n                    : this.uidKeyMap[uid].nickname,\n            avatar: isGroup ? groupAvatar : this.uidKeyMap[uid].avatar,\n            last: Date.parse(new Date()),\n            read: true,\n            records: [],\n            target: isGroup ? 'group' : 'friends'\n        };\n    }\n\n    // 更新、替换会话列表\n    @action\n    replaceDialog(dialog) {\n        for (const i in dialog)\n            if (this.uidKeyMap[dialog[i].with] && this.uidKeyMap[dialog[i].with].alias)\n                dialog[i].nickname = this.uidKeyMap[dialog[i].with].alias;\n        this.messageList = dialog;\n    }\n\n    // 设置当前会话对象\n    @action\n    setChattingWith(uid, nickname, avatar) {\n        this.chattingWith = {\n            uid,\n            nickname,\n            avatar: this.API('avatar', avatar)\n        };\n    }\n\n    // 发送消息，更新 UI\n    @action\n    sendMessage(uid, content, type, isGroup) {\n        if (!this.messageList[uid]) {\n            this.addDialog(uid);\n        }\n        const timestamp = Date.parse(new Date());\n        let msg = {\n            from: 1,\n            timestamp: timestamp,\n            type,\n            content,\n            target: isGroup ? 'group' : 'friends'\n        };\n        if (isGroup) {\n            msg.avatar = this.avatar;\n            msg.nickname = this.nickname;\n        }\n        this.messageList[uid].records.push(msg);\n        this.messageList[uid].last = timestamp;\n    }\n\n    // 设置已读状态\n    @action\n    setRead(uid) {\n        this.messageList[uid].read = true;\n    }\n\n    // 新消息推送\n    @action\n    pushNewMessage(from, msg) {\n        if (!this.messageList[from]) {\n            this.addDialog(from, msg.target === 'group');\n            console.log(from, msg, 233);\n        }\n        this.messageList[from].read = false;\n        this.messageList[from].records.push(msg);\n        this.messageList[from].last = msg.timestamp;\n    }\n\n    // 新动态\n    @action\n    pushNewPost(id, content, images) {\n        this.posts.unshift({\n            _id: id,\n            createdBy: this.uid,\n            createTime: new Date(),\n            content,\n            nickname: this.nickname,\n            avatar: this.avatar.replace(this.API('avatar'), ''),\n            type: 1,\n            images,\n            comments: [],\n        });\n    }\n\n    // 更新好友备注\n    @action\n    updateAlias(target, alias) {\n        this.uidKeyMap[target].alias = alias;\n        for (const i in this.friends) {\n            if (this.friends[i].uid === target) {\n                this.friends[i].alias = alias;\n            }\n        }\n    }\n\n    // 退出群聊\n    @action\n    exitGroup(groupId) {\n        delete this.groupKeyMap[groupId];\n        for (const i in this.groups)\n            if (this.groups[i].id === groupId) {\n                this.groups[i] = undefined;\n                delete this.groups[i];\n            }\n        delete this.messageList[groupId];\n    }\n\n    // 删除好友\n    @action\n    deleteFriend(target) {\n        delete this.uidKeyMap[target];\n        for (const i in this.friends) {\n            if (this.friends[i].uid === target) {\n                this.friends[i] = undefined;\n                delete this.friends[i];\n            }\n        }\n        delete this.messageList[target];\n    }\n\n    // 更新消息列表\n    @action\n    reloadMessageList() {\n        this.fetching = true;\n        const MessageListUri = config.apiUrl + 'getMessageList';\n        honoka.post(MessageListUri, {\n            data: {\n                uid: this.uid,\n                token: this.token\n            }\n        }).then(res => {\n            if (res.status === 403)\n                this.forceLogout();\n            if (res.status !== 200) {\n                alert(\"拉取消息列表失败 :(\");\n                return;\n            }\n            this.replaceDialog(res.payload);\n            this.fetching = false;\n        });\n    }\n\n    // 更新好友列表\n    @action\n    reloadFriendsList() {\n        // get friends list\n        honoka.post(this.API('friends'), {\n            data: {\n                uid: this.uid,\n                token: this.token\n            }\n        }).then(res => {\n            if (res.status === 403)\n                this.forceLogout();\n            else if (res.status === 200)\n                this.updateFriends(res.payload);\n            else\n                console.log('model.reloadFriendsList', res);\n        });\n    }\n\n    // 更新群聊列表\n    @action\n    reloadGroupList() {\n        // get groups list\n        const groupUri = this.API('getUserGroups');\n        honoka.post(groupUri, {\n            data: {\n                uid: this.uid,\n                token: this.token\n            }\n        }).then(res => {\n            if (res.status === 403)\n                this.forceLogout();\n            else if (res.status === 200)\n                this.updateGroups(res.payload);\n            else\n                console.log('model.reloadGroupList', res);\n        });\n    }\n\n    // 更新好友动态\n    @action\n    reloadPostList() {\n        const postUri = this.API('getFriendsPost');\n        honoka.post(postUri, {\n            data: {\n                uid: this.uid,\n                token: this.token\n            }\n        }).then(res => {\n            if (res.status === 403)\n                this.forceLogout();\n            else if (res.status === 200)\n                this.posts = res.payload;\n            else\n                console.log('model.reloadPostList', res);\n        })\n    }\n\n    // 点赞\n    @action\n    likePost(id) {\n        this.likes[id] = this.likes[id] ? false : true;\n        for (const i in this.posts) {\n            if (this.posts[i]._id === id) {\n                this.posts[i].likes += (this.likes[id] ? 1 : -1);\n                break;\n            }\n        }\n    }\n\n    // 删除\n    @action\n    deletePost(id) {\n        for (const i in this.posts) {\n            if (this.posts[i]._id === id) {\n                this.posts.splice(i, 1);\n                break;\n            }\n        }\n    }\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'mobx-react';\nimport { Route } from \"react-router\";\nimport { HashRouter } from 'react-router-dom';\n\nimport './styles/index.styl';\n\nimport TopButton from './components/TopButton';\nimport LoginPage from './components/LoginPage';\nimport RegisterPage from './components/RegisterPage';\nimport MainPage from './components/MainPage';\n\nimport Model from './models';\n\n// eslint-disable-next-line\neval('window.browserWindow = require(\"electron\").remote');      // 注入 electron API\n\n// macOS headless frame dragging compalibity\nif (navigator.userAgent.indexOf('Macintosh') !== -1)\n    document.body.setAttribute('style', '-webkit-app-region: drag');\n\nconst store = new Model();\n\nReactDOM.render((\n    <div className=\"mechat\" id=\"mechat\">\n        <Provider store={store}>\n            <TopButton />\n            <HashRouter>\n                <Route path=\"/\" exact>\n                    <LoginPage />\n                </Route>\n                <Route path=\"/register\" exact>\n                    <RegisterPage />\n                </Route>\n                <Route path=\"/app\">\n                    <MainPage />\n                </Route>\n            </HashRouter>\n        </Provider>\n    </div>\n), document.getElementById('root'));\n","module.exports = __webpack_public_path__ + \"static/media/mechat.a8687cd1.png\";","module.exports = \"data:image/png;base64,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\""],"sourceRoot":""}