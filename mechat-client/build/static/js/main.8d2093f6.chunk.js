(this["webpackJsonpmechat-core"]=this["webpackJsonpmechat-core"]||[]).push([[0],{104:function(e,t){e.exports="data:image/jpeg;base64,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"},106:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a(5),n=a(6),s=a(9),i=a(8),o=a(10),c=a(0),l=a.n(c),p=(a(121),function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(o)))).maximized=!1,a}return Object(o.a)(t,e),Object(n.a)(t,[{key:"closeWindow",value:function(){window.close()}},{key:"minimizeWindow",value:function(){window.browserWindow.getCurrentWindow().minimize()}},{key:"maximizeWindow",value:function(){this.maximized?window.browserWindow.getCurrentWindow().unmaximize():window.browserWindow.getCurrentWindow().maximize(),this.maximized=!this.maximized}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"mechat-top-button-container"},l.a.createElement("button",{className:"mechat-top-button-exit",onClick:function(){return e.closeWindow()}}),l.a.createElement("button",{className:"mechat-top-button-minimize",onClick:function(){return e.minimizeWindow()}}),l.a.createElement("button",{className:"mechat-top-button-maxmize",onClick:function(){return e.maximizeWindow()}}))}}]),t}(c.Component))},107:function(e,t,a){"use strict";var r,n=a(113),s=a(5),i=a(6),o=a(9),c=a(8),l=a(10),p=a(0),u=a.n(p),m=a(13),h=a(3),d=a(2),f=a(45),g=a.n(f),v=a(11),b=a.n(v),y=(a(202),a(104)),E=Object(d.b)("store")(r=Object(d.c)(r=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).state={nickname:"MeChat",avatar:y,logining:!1},a}return Object(l.a)(t,e),Object(i.a)(t,[{key:"login",value:function(){var e=this,t=this.usernameInput.value,a=g.a.createHash("md5").update(this.passwordInput.value).digest("hex");this.setState({logining:!0});var r=this.props.store.API("login");b.a.post(r,{data:{username:t,password:a}}).then((function(a){"string"===typeof a&&(a=JSON.parse(a)),e.setState({logining:!1}),200!==a.status?alert("\u767b\u5f55\u5931\u8d25\uff0c\u9519\u8bef\u4fe1\u606f\uff1a"+a.message):(a.avatar=e.props.store.API("avatar",a.avatar),localStorage.setItem(t,JSON.stringify({avatar:a.avatar,nickname:a.nickname})),sessionStorage.setItem("userInfo",JSON.stringify(a)),e.props.history.push("/app/message"))}))}},{key:"onUsernameInput",value:function(){var e=this.usernameInput.value,t=localStorage.getItem(e);if(t){var a=JSON.parse(t);this.setState(Object(n.a)({},a))}else"MeChat"!==this.state.nickname&&this.setState({nickname:"MeChat",avatar:y})}},{key:"componentDidMount",value:function(){var e=this;window.browserWindow.getCurrentWindow().setSize(300,500),this.props.store.setRouter(this.props.history),setTimeout((function(){return e.usernameInput.focus()}),100)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"mechat-loginpage"},u.a.createElement("div",{className:"mechat-login-personinfo"},u.a.createElement("div",{className:"mechat-login-avatar-container"},u.a.createElement("div",{className:"mechat-login-avatar",style:{background:"url('".concat(this.state.avatar,"') no-repeat center / cover")}})),u.a.createElement("p",{className:"mechat-login-nickname"},this.state.nickname)),u.a.createElement("div",{className:"mechat-login-hint",style:{display:this.state.logining?"block":"none"}},"\u6b63\u5728\u767b\u5f55..."),u.a.createElement("div",{className:"mechat-login-input",style:{display:this.state.logining?"none":"block"}},u.a.createElement("input",{type:"text",name:"username",className:"mechat-login-input-username",ref:function(t){return e.usernameInput=t},onChange:function(){return e.onUsernameInput()},placeholder:"\u7528\u6237\u540d"}),u.a.createElement("input",{type:"password",name:"password",className:"mechat-login-input-password",ref:function(t){return e.passwordInput=t},placeholder:"\u5bc6\u7801"}),u.a.createElement("div",{className:"mechat-login-actions"},u.a.createElement("button",{type:"button",onClick:function(){return e.login()},className:"mechat-login-button"},"\u767b\u5f55"),u.a.createElement(m.b,{to:"/register",className:"mechat-login-register"},"\u6ca1\u6709\u8d26\u53f7\uff1f\u6ce8\u518c\u4e00\u4e2a"))),u.a.createElement("div",{className:"mechat-login-copyright"},"\xa92019 XMU CS - Data-Structure Curriculum Design ",u.a.createElement("br",null)," by Yume Maruyama"))}}]),t}(p.Component))||r)||r;t.a=Object(h.e)(E)},110:function(e,t,a){"use strict";var r,n=a(5),s=a(6),i=a(9),o=a(8),c=a(10),l=a(0),p=a.n(l),u=a(13),m=a(3),h=a(2),d=a(45),f=a.n(d),g=a(11),v=a.n(g),b=(a(207),Object(h.b)("store")(r=Object(h.c)(r=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(s.a)(t,[{key:"register",value:function(){var e=this,t=this.usernameInput.value,a=f.a.createHash("md5").update(this.passwordInput.value).digest("hex"),r=this.mailInput.value,n=this.nicknameInput.value,s=this.props.store.API("register");v.a.post(s,{data:{username:t,password:a,mail:r,nickname:n}}).then((function(t){"string"==typeof t&&(t=JSON.parse(t)),200!==t.status?alert("\u6ce8\u518c\u5931\u8d25\uff0c\u9519\u8bef\u4fe1\u606f\uff1a"+t.message):(window.browserWindow.dialog.showMessageBoxSync({type:"info",title:"\u6ce8\u518c\u6210\u529f",message:"\u6ce8\u518c\u6210\u529f~\u5c06\u56de\u5230\u767b\u5f55\u9875\u9762\u3002",button:["ok"]}),e.props.history.push("/"))}))}},{key:"render",value:function(){var e=this;return p.a.createElement("div",{className:"mechat-register-page"},p.a.createElement("h1",{className:"mechat-register-title"},"\u6ce8\u518c MeChat"),p.a.createElement("input",{type:"text",name:"username",className:"mechat-register-input-username",ref:function(t){return e.usernameInput=t},placeholder:"\u767b\u5f55\u7528\u6237\u540d"}),p.a.createElement("input",{type:"password",name:"password",className:"mechat-register-input-password",ref:function(t){return e.passwordInput=t},placeholder:"\u5bc6\u7801"}),p.a.createElement("input",{type:"mail",name:"mail",className:"mechat-register-input-mail",ref:function(t){return e.mailInput=t},placeholder:"\u90ae\u7bb1"}),p.a.createElement("input",{type:"text",name:"nickname",className:"mechat-register-input-nickname",ref:function(t){return e.nicknameInput=t},placeholder:"\u6635\u79f0"}),p.a.createElement("div",{className:"mechat-register-actions"},p.a.createElement("button",{type:"button",onClick:function(){return e.register()},className:"mechat-register-button"},"\u6ce8\u518c"),p.a.createElement(u.b,{to:"/",className:"mechat-register-login"},"\u5df2\u6709\u8d26\u53f7\uff1f\u767b\u5f55")))}}]),t}(l.Component))||r)||r);t.a=Object(m.e)(b)},111:function(e,t,a){"use strict";var r,n,s,i,o,c,l,p,u,m,h,d,f,g,v,b=a(5),y=a(6),E=a(9),k=a(8),O=a(10),_=a(0),j=a.n(_),N=a(3),A=a(13),M=a(2),P=(a(208),Object(M.b)("store")(r=Object(M.c)(r=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this;return j.a.createElement("div",{className:"mechat-mainpage-nav"},j.a.createElement("div",{className:"mechat-nav-avatar-container"},j.a.createElement(A.b,{to:"/app/editProfile"},j.a.createElement("img",{className:"mechat-nav-avatar",alt:"avatar",src:this.props.store.avatar,title:this.props.store.nickname}))),j.a.createElement(A.c,{to:"/app/message",title:"\u6d88\u606f"},j.a.createElement("i",{className:"fa fa-comments-o"})),j.a.createElement(A.c,{to:"/app/friends",title:"\u901a\u8baf\u5f55"},j.a.createElement("i",{className:"fa fa-address-book-o"})),j.a.createElement(A.c,{to:"/app/groups",title:"\u7fa4\u7ec4"},j.a.createElement("i",{className:"fa fa-group"})),j.a.createElement(A.c,{to:"/app/circle",title:"\u597d\u53cb\u52a8\u6001"},j.a.createElement("i",{className:"fa fa-compass"})),j.a.createElement("div",{className:"mechat-nav-system-action"},j.a.createElement(A.b,{to:"/app/about",title:"\u5173\u4e8e"},j.a.createElement("i",{className:"fa fa-info-circle"})),j.a.createElement(A.b,{to:"/",title:"\u6ce8\u9500",onClick:function(){return e.props.store.forceLogout(!0)}},j.a.createElement("i",{className:"fa fa-mail-reply"}))))}}]),t}(_.Component))||r)||r),w=Object(N.e)(P),C=a(44),I=Object(M.b)("store")(n=Object(M.c)(n=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"getAvatar",value:function(e){return this.props.store.API("avatar",e)}},{key:"chatWith",value:function(e){this.props.store.setRead(e.with),this.props.store.setChattingWith(e.with,e.nickname,e.avatar)}},{key:"renderMessageList",value:function(){var e=this,t=[],a=[],r=0;for(var n in this.props.store.messageList)a.push(this.props.store.messageList[n]);a=a.sort((function(e,t){return e.last<t.last?1:-1}));var s=function(n){var s=a[n],i=new Date(s.last),o="";o+=i.getHours()<10?"0"+i.getHours():i.getHours(),o+=":",o+=i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes(),t.push(j.a.createElement(A.c,{className:"mechat-dialog",to:"group"!==s.target?"/app/message/".concat(s.with):"/app/groupMessage/".concat(s.with),key:r++,onClick:function(){return e.chatWith(s)}},j.a.createElement("div",{className:"mechat-dialog-avatar"},j.a.createElement("img",{src:"group"===s.target?C:e.getAvatar(s.avatar),alt:"avatar"}),s.read?null:j.a.createElement("span",{className:"mechat-dialog-new"})),j.a.createElement("div",{className:"mechat-dialog-meta"},j.a.createElement("p",{className:"mechat-dialog-title"},s.nickname),j.a.createElement("p",{className:"mechat-dialog-mess"},s.records.length?"image"===s.records[s.records.length-1].type?"[\u56fe\u7247]":s.records[s.records.length-1].content:""),j.a.createElement("span",{className:"mechat-dialog-time"},o))))};for(var i in a)s(i);return t}},{key:"render",value:function(){var e=this;return j.a.createElement("div",{className:"mechat-messages"},j.a.createElement("h1",{className:"mechat-messages-title"},"\u6d88\u606f\u5217\u8868"),j.a.createElement("div",{className:"mechat-messages-fetching",style:{display:this.props.store.fetching?"block":"none"}},"\u6b63\u5728\u66f4\u65b0\u6d88\u606f\u5217\u8868..."),j.a.createElement("div",{className:"mechat-messages-list"},e.renderMessageList()))}}]),t}(_.Component))||n)||n,L=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.props,t=e.chat,a=e.chatWith,r=e.myAvatar;return j.a.createElement("div",{className:"mechat-chat-item "+(1===t.from?"from-me":"")},j.a.createElement("div",{className:"mechat-chat-item-avatar"},j.a.createElement("img",{src:1===t.from?r:"group"===t.target?this.props.avatar:a.avatar,alt:"avatar"})),"group"===t.target?j.a.createElement("p",{className:"mechat-chat-group-id"},t.nickname):null,j.a.createElement("div",{className:"mechat-chat-item-bubble"},"string"===t.type?j.a.createElement("p",{dangerouslySetInnerHTML:{__html:t.content.trim().replace(/\n/g,"<br>")}}):j.a.createElement("img",{src:t.content,alt:"chatimg"})))}}]),t}(_.Component),D=(a(209),a(11)),W=a.n(D),U=Object(M.b)("store")(s=Object(M.c)(s=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.onkeydown=function(t){var a=t.which?t.which:t.keyCode;t.ctrlKey&&13===a&&e.sendMessage()},this.chatContent.scrollTop=this.chatContent.scrollHeight}},{key:"componentWillUnmount",value:function(){document.onkeydown=null}},{key:"renderChatContent",value:function(){var e=this,t=[],a=this.props.match.params.id,r=this.props.store.getRawChats(a),n=this.props.store.avatar,s=0,i=0;if(r.forEach)return r.forEach((function(a){if(a.timestamp-i>=1e6){var r=new Date(a.timestamp),o="";o+=r.getHours()<10?"0"+r.getHours():r.getHours(),o+=":",o+=r.getMinutes()<10?"0"+r.getMinutes():r.getMinutes(),t.push(j.a.createElement("div",{key:s++,className:"mechat-chat-item-time"},o)),i=a.timestamp}t.push(j.a.createElement(L,{chat:a,chatWith:e.props.store.chattingWith,myAvatar:n,key:s++}))})),t;this.props.store.reloadMessageList()}},{key:"changeScrollTop",value:function(){this.chatContent.scrollTop=this.chatContent.scrollHeight}},{key:"sendMessage",value:function(){var e=this.textarea.value,t=this.props.match.params.id;this.props.store.sendMessage(t,e,"string"),this.props.store.setRead(t),this.textarea.value="",this.changeScrollTop(),W.a.post(this.props.store.API("sendMessage"),{data:{uid:this.props.store.uid,to:t,type:"string",content:e,token:this.props.store.token,target:"friends"}}).then((function(e){200===e.status||alert("\u53d1\u9001\u4fe1\u606f\u5931\u8d25\uff0c\u539f\u56e0\u53ef\u80fd\u662f\uff1a"+e.message)}))}},{key:"selectImage",value:function(){this.imageInput.click()}},{key:"sendImage",value:function(e){var t=this,a=e||this.imageInput.files[0];if(a.size/1024/1024>2)alert("\u53d1\u9001\u7684\u56fe\u7247\u5c3a\u5bf8\u4e0d\u80fd\u8d85\u8fc7 2MB");else{var r=new FileReader,n=this.props.match.params.id;r.readAsDataURL(a),r.onload=function(e){var a=r.result;t.props.store.sendMessage(n,a,"image"),W.a.post(t.props.store.API("sendMessage"),{data:{uid:t.props.store.uid,to:n,type:"image",content:a,token:t.props.store.token,target:"friends"}}).then((function(e){200===e.status||alert("\u53d1\u9001\u4fe1\u606f\u5931\u8d25\uff0c\u539f\u56e0\u53ef\u80fd\u662f\uff1a"+e.message)}))}}}},{key:"onClipboardPaste",value:function(e){var t=e.clipboardData.items;if(t.length){var a=t[0].getAsFile();a&&a.type&&-1!==!a.type.indexOf("image")&&this.sendImage(a)}}},{key:"render",value:function(){var e=this,t=setInterval((function(){e.chatContent&&(e.changeScrollTop(),clearInterval(t))}),50);return j.a.createElement("div",{className:"mechat-chat-page",onPaste:function(t){return e.onClipboardPaste(t)}},j.a.createElement("div",{className:"mechat-chat-title"},j.a.createElement(A.b,{to:"/app/friends/"+this.props.match.params.id},this.props.store.chattingWith.nickname)),j.a.createElement("div",{className:"mechat-chat-content",ref:function(t){return e.chatContent=t}},e.renderChatContent()),j.a.createElement("div",{className:"mechat-chat-textarea"},j.a.createElement("textarea",{name:"chat-text",ref:function(t){return e.textarea=t}}),j.a.createElement("input",{accept:"image/*",ref:function(t){return e.imageInput=t},type:"file",onChange:function(){return e.sendImage()}}),j.a.createElement("button",{className:"mechat-chat-image",title:"\u53d1\u9001\u56fe\u7247",onClick:function(){return e.selectImage()}},j.a.createElement("i",{className:"fa fa-image"})),j.a.createElement("button",{className:"mechat-chat-send",onClick:function(){return e.sendMessage()}},"\u53d1\u9001")))}}]),t}(_.Component))||s)||s,x=Object(N.e)(U),K=(a(210),Object(M.b)("store")(i=Object(M.c)(i=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"renderFriendsList",value:function(){var e=this,t=[],a=0;return this.props.store.friends.forEach((function(r){t.push(j.a.createElement(A.c,{className:"mechat-dialog",to:"/app/friends/"+r.uid,key:a++},j.a.createElement("div",{className:"mechat-dialog-avatar"},j.a.createElement("img",{src:e.props.store.API("avatar",r.avatar),alt:"avatar"})),j.a.createElement("div",{className:"mechat-dialog-meta"},j.a.createElement("p",{className:"mechat-dialog-title"},r.alias?"".concat(r.alias," (").concat(r.nickname,")"):r.nickname),j.a.createElement("p",{className:"mechat-dialog-mess"},r.signature))))})),t}},{key:"componentWillMount",value:function(){this.props.store.reloadFriendsList()}},{key:"addFriend",value:function(){var e=this,t=this.input.value,a=this.props.store.API("addFriend");W.a.post(a,{data:{uid:this.props.store.uid,token:this.props.store.token,friend:t}}).then((function(t){403===t.status?e.props.store.forceLogout():200===t.status?(alert("\u6dfb\u52a0\u597d\u53cb\u6210\u529f."),e.props.store.addFriend(t.payload)):alert("\u6dfb\u52a0\u597d\u53cb\u5931\u8d25\uff0c\u539f\u56e0\u662f\uff1a"+t.message)}))}},{key:"render",value:function(){var e=this;return j.a.createElement("div",{className:"mechat-messages"},j.a.createElement("h1",{className:"mechat-messages-title"},"\u670b\u53cb"),j.a.createElement("div",{className:"mechat-friends-add"},j.a.createElement("input",{type:"text",name:"friends",placeholder:"\u641c\u7d22 MeChat \u8d26\u53f7\u6dfb\u52a0\u597d\u53cb",ref:function(t){return e.input=t}}),j.a.createElement("button",{onClick:function(){return e.addFriend()}},"+")),j.a.createElement("div",{className:"mechat-messages-list"},e.renderFriendsList()))}}]),t}(_.Component))||i)||i),R=(a(211),Object(M.b)("store")(o=Object(M.c)(o=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(k.a)(t).call(this,e))).state={modifyAlias:!1},a}return Object(O.a)(t,e),Object(y.a)(t,[{key:"chatWith",value:function(e,t,a){this.props.store.messageList[e]||this.props.store.addDialog(e),this.props.store.setChattingWith(e,t,a)}},{key:"getAvatar",value:function(e){return this.props.store.API("avatar",e)}},{key:"changeAlias",value:function(){this.setState({modifyAlias:!0})}},{key:"confirmChange",value:function(){var e=this,t=this.props.match.params.id,a=this.aliasInput.value;W.a.post(this.props.store.API("changeAlias"),{data:{uid:this.props.store.uid,token:this.props.store.token,target:t,alias:a}}).then((function(r){403===r.status?e.props.store.forceLogout():200===r.status&&(e.props.store.updateAlias(t,a),e.setState({modifyAlias:!1}))}))}},{key:"deleteFriend",value:function(){var e=this,t=this.props.store.uid,a=this.props.store.token,r=this.props.match.params.id;W.a.post(this.props.store.API("deleteFriend"),{data:{uid:t,token:a,target:r}}).then((function(t){403===t.status?e.props.store.forceLogout():200===t.status&&(alert("\u5220\u9664\u597d\u53cb\u6210\u529f\u3002"),e.props.store.deleteFriend(r))}))}},{key:"render",value:function(){var e=this,t=this.props.match.params.id,a=this.props.store.uidKeyMap[t];return a?j.a.createElement("div",{className:"mechat-profile-page"},j.a.createElement("p",{className:"mechat-profile-title"},"\u4e2a\u4eba\u8d44\u6599"),j.a.createElement("div",{className:"mechat-profile-container"},j.a.createElement("div",{className:"mechat-profile-avatar"},j.a.createElement("img",{src:this.getAvatar(a.avatar),alt:"avatar"})),j.a.createElement("div",{className:"mechat-profile-meta"},j.a.createElement("h1",{className:"mechat-profile-nickname"},a.nickname),j.a.createElement("p",{className:"mechat-profile-alias"},"\u5907\u6ce8\uff1a",a.alias?a.alias:"\u65e0",j.a.createElement("span",{className:"mechat-profile-alias-change",onClick:function(){return e.changeAlias()}},"\u4fee\u6539\u5907\u6ce8")),j.a.createElement("p",{className:"mechat-profile-alias-input",style:{display:this.state.modifyAlias?"block":"none"}},j.a.createElement("input",{type:"text",defaultValue:a.alias,ref:function(t){return e.aliasInput=t}}),j.a.createElement("button",{className:"mechat-profile-alias-confirm",onClick:function(){return e.confirmChange()}},"\u786e\u5b9a")),j.a.createElement("p",{className:"mechat-profile-account"},"MeChat \u8d26\u53f7\uff1a",a.username),j.a.createElement("p",{className:"mechat-profile-signature"},"\u7b7e\u540d\uff1a",a.signature?a.signature:"\u65e0"),j.a.createElement(A.b,{className:"mechat-profile-chat",to:"/app/message/"+a.uid,onClick:function(){return e.chatWith(a.uid,a.nickname,a.avatar)}},"\u804a\u5929"),j.a.createElement("button",{className:"mechat-profile-exit",onClick:function(){return e.deleteFriend()}},"\u5220\u9664\u597d\u53cb")))):null}}]),t}(_.Component))||o)||o),S=Object(N.e)(R),T=(a(212),Object(M.b)("store")(c=Object(M.c)(c=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"editProfile",value:function(){var e=this,t=this.nickname.value,a=this.mail.value,r=this.signature.value,n=this.props.store,s=n.avatar,i=n.token,o=n.uid;if(""!==t&&""!==a){if(this.avatarUpload.files.length){if(this.avatarUpload.files[0].size/1024/1024>1)return void alert("\u4e0a\u4f20\u7684\u5934\u50cf\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc7 1MB\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u56fe\u7247\u3002");var c=new FormData;c.append("avatar",this.avatarUpload.files[0]),c.append("uid",this.props.store.uid),c.append("token",this.props.store.token),fetch(this.props.store.API("uploadAvatar"),{method:"POST",headers:{},body:c}).then((function(e){return e.json()})).then((function(t){if(403===t.status)e.props.store.forceLogout();else if(200===t.status){var a=e.avatarUpload.files[0],r=window.URL.createObjectURL(a);e.props.store.setNewAvatar(r,!0)}}))}this.props.store.setUserInfo({nickname:t,mail:a,signature:r,avatar:s,token:i,id:o,username:this.props.store.username}),W.a.post(this.props.store.API("updateProfile"),{data:{nickname:t,mail:a,signature:r,uid:o,token:i}}).then((function(t){403===t.status?(alert("\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u3002"),sessionStorage.removeItem("userInfo"),e.props.history.push("/")):200===t.status&&alert("\u4fee\u6539\u6210\u529f\u3002")}))}else alert("\u6635\u79f0\u548c\u90ae\u7bb1\u4e0d\u8bb8\u7559\u7a7a\uff01")}},{key:"onFileLoadChange",value:function(){var e=this.avatarUpload.files[0],t=window.URL.createObjectURL(e);this.avatar.setAttribute("src",t)}},{key:"selectAvatar",value:function(){this.avatarUpload.click()}},{key:"render",value:function(){var e=this;return j.a.createElement("div",{className:"mechat-profile-edit"},j.a.createElement("p",{className:"mechat-profile-edit-title"},"\u4fee\u6539\u4e2a\u4eba\u8d44\u6599"),j.a.createElement("div",{className:"mechat-profile-edit-container"},j.a.createElement("div",{className:"mechat-profile-edit-avatar"},j.a.createElement("img",{src:this.props.store.avatar,alt:"my-avatar",onClick:function(){e.selectAvatar()},ref:function(t){return e.avatar=t},title:"\u70b9\u51fb\u4fee\u6539\u5934\u50cf"})),j.a.createElement("div",{className:"mechat-profile-account"},j.a.createElement("p",{name:"username"},"MeChat \u8d26\u53f7\uff1a",this.props.store.username),j.a.createElement("p",{name:"uid"},"UID: ",this.props.store.uid)),j.a.createElement("form",{ref:function(t){return e.uploadForm=t},action:this.props.store.API("uploadAvatar"),method:"post",encType:"multipart/form-data"},j.a.createElement("input",{type:"file",name:"avatar-upload",ref:function(t){return e.avatarUpload=t},style:{display:"none"},accept:"image/*",onChange:function(t){return e.onFileLoadChange(t)}})),j.a.createElement("div",{className:"mechat-profile-edit-form"},j.a.createElement("span",null,"\u6635\u79f0"),j.a.createElement("input",{type:"text",defaultValue:this.props.store.nickname,ref:function(t){return e.nickname=t}})),j.a.createElement("div",{className:"mechat-profile-edit-form"},j.a.createElement("span",null,"\u90ae\u7bb1"),j.a.createElement("input",{type:"text",defaultValue:this.props.store.mail,ref:function(t){return e.mail=t}})),j.a.createElement("div",{className:"mechat-profile-edit-form"},j.a.createElement("span",null,"\u7b7e\u540d"),j.a.createElement("input",{type:"text",defaultValue:this.props.store.signature,ref:function(t){return e.signature=t}})),j.a.createElement("div",{className:"mechat-profile-edit-action"},j.a.createElement("button",{className:"mechat-profile-edit-submit",onClick:function(){return e.editProfile()}},"\u4fee\u6539"))))}}]),t}(_.Component))||c)||c),F=Object(N.e)(T),B=(a(213),a(214)),G=Object(M.b)("store")(l=Object(M.c)(l=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){return j.a.createElement("div",{className:"mechat-about"},j.a.createElement("p",{className:"mechat-about-title"},"\u5173\u4e8e MeChat"),j.a.createElement("div",{className:"mechat-about-logo"},j.a.createElement("img",{src:B,alt:"MeChat Logo"})),j.a.createElement("div",{className:"mechat-about-title"},j.a.createElement("h1",null,"MeChat"),j.a.createElement("span",null,"ver. 1.0")),j.a.createElement("div",{className:"mechat-about-description"},j.a.createElement("p",null,"\u4e00\u4e2a\u7b80\u5355\u7684\u3001\u8de8\u5e73\u53f0\u7684\u7535\u8111\u7248\u201c\u5c71\u5be8\u5fae\u4fe1\u201d"),j.a.createElement("p",null,"\u8fd9\u662f\u53a6\u95e8\u5927\u5b66\u4fe1\u606f\u5b66\u9662 2018 \u7ea7\u8ba1\u7b97\u673a\u7cfb\u6570\u636e\u7ed3\u6784\u8bfe\u7a0b\u8bbe\u8ba1\uff1a\u9898\u76ee\u4e03\u300a\u5b9e\u73b0\u7535\u8111\u7248\u7684\u5fae\u4fe1\u300b"),j.a.createElement("p",null,"\u57fa\u4e8e Node.js + Electron \u6784\u5efa"),j.a.createElement("p",null,"\u6e90\u4ee3\u7801\u53ef\u53c2\u89c1\u8be5\u9879\u76ee\u7684 GitHub \u4ed3\u5e93: https://github.com/kirainmoe/mechat")),j.a.createElement("div",{className:"mechat-about-copyright"},j.a.createElement("p",null,"\xa92019 - present, written by Yuhang Qiu (Yume Maruyama)"),j.a.createElement("p",null,"XMU 2018 Data-Structure Curriculum Design")))}}]),t}(_.Component))||l)||l,z=Object(N.e)(G),Q=(a(215),a(44)),q=Object(M.b)("store")(p=Object(M.c)(p=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"renderGroupsList",value:function(){var e=[],t=0;return this.props.store.groups.forEach((function(a){a&&e.push(j.a.createElement(A.c,{className:"mechat-dialog",to:"/app/groups/"+a.id,key:t++},j.a.createElement("div",{className:"mechat-dialog-avatar"},j.a.createElement("img",{src:Q,alt:"avatar"})),j.a.createElement("div",{className:"mechat-dialog-meta"},j.a.createElement("p",{className:"mechat-dialog-title"},a.name),j.a.createElement("p",{className:"mechat-dialog-mess"},a.description))))})),e}},{key:"componentWillMount",value:function(){this.props.store.reloadGroupList()}},{key:"addGroup",value:function(){var e=this,t=this.input.value,a=this.props.store.API("addGroup");W.a.post(a,{data:{uid:this.props.store.uid,token:this.props.store.token,groupId:t}}).then((function(t){403===t.status?e.props.store.forceLogout():200===t.status?(alert("\u6dfb\u52a0\u7fa4\u6210\u529f\u3002"),e.props.store.addGroup(t.payload)):alert("\u6dfb\u52a0\u7fa4\u5931\u8d25\uff0c\u539f\u56e0\u662f\uff1a"+t.message)}))}},{key:"render",value:function(){var e=this;return j.a.createElement("div",{className:"mechat-messages mechat-grouplist"},j.a.createElement("h1",{className:"mechat-messages-title"},"\u7fa4\u7ec4"),j.a.createElement("div",{className:"mechat-friends-add"},j.a.createElement("input",{type:"text",name:"friends",placeholder:"\u641c\u7d22\u7fa4 ID \u52a0\u5165\u7fa4",ref:function(t){return e.input=t}}),j.a.createElement("button",{onClick:function(){return e.addGroup()}},"+")),j.a.createElement("div",{className:"mechat-messages-list"},e.renderGroupsList(),j.a.createElement(A.c,{to:"/app/createNewGroup",className:"mechat-group-create",title:"\u53d1\u8d77\u65b0\u7684\u7fa4\u804a"},j.a.createElement("i",{className:"fa fa-plus"}))))}}]),t}(_.Component))||p)||p,H=(a(216),Object(M.b)("store")(u=Object(M.c)(u=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"renderMemberLists",value:function(){var e=[],t=this.props.store.friends,a=0;return t.forEach((function(t){e.push(j.a.createElement("div",{className:"mechat-cng-member-item",key:a},j.a.createElement("input",{className:"mechat-cng-member-checkbox",type:"checkbox",uid:t.uid}),j.a.createElement("span",null,t.alias?"".concat(t.alias," (").concat(t.nickname,")"):t.nickname))),a++})),e}},{key:"createGroup",value:function(){var e=this,t=this.props.store,a=t.uid,r=t.token,n=this.groupName.value,s=this.groupDesc.value,i=[];this.wrapper.querySelectorAll('input[type="checkbox"]').forEach((function(e){e.checked&&i.push(e.getAttribute("uid"))})),W.a.post(this.props.store.API("createGroup"),{data:{uid:a,token:r,name:n,description:s,members:JSON.stringify(i)}}).then((function(t){403===t.status?e.props.store.forceLogout():200!==t.status?(alert("\u521b\u5efa\u7fa4\u5931\u8d25\uff0c\u539f\u56e0\u53ef\u80fd\u662f\uff1a".concat(t.message)),console.log(t)):(alert("\u521b\u5efa\u7fa4\u804a\u6210\u529f\uff01"),e.props.history.push("/app/groups"))}))}},{key:"render",value:function(){var e=this;return j.a.createElement("div",{className:"mechat-create-new-group"},j.a.createElement("p",{className:"mechat-cng-title"},"\u521b\u5efa\u65b0\u7fa4\u7ec4"),j.a.createElement("div",{className:"mechat-cng-container"},j.a.createElement("p",{className:"mechat-cng-input"},"\u7fa4\u7ec4\u540d\u79f0\uff1a",j.a.createElement("input",{type:"text",ref:function(t){return e.groupName=t}})),j.a.createElement("p",{className:"mechat-cng-input"},"\u7fa4\u7ec4\u7b80\u4ecb\uff1a",j.a.createElement("input",{type:"text",ref:function(t){return e.groupDesc=t}})),j.a.createElement("div",{className:"mechat-cng-members"},j.a.createElement("p",null,"\u9080\u8bf7\u597d\u53cb\uff1a"),j.a.createElement("div",{className:"mechat-cng-members-wrapper",ref:function(t){return e.wrapper=t}},this.renderMemberLists())),j.a.createElement("button",{type:"button",className:"mechat-cng-button",onClick:function(){return e.createGroup()}},"\u521b\u5efa\u7fa4\u804a")))}}]),t}(_.Component))||u)||u),J=Object(N.e)(H),Y=a(44),X=Object(M.b)("store")(m=Object(M.c)(m=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"chatWith",value:function(e,t){this.props.store.messageList[e]||this.props.store.addDialog(e,!0),this.props.store.setChattingWith(e,t,Y)}},{key:"exitGroup",value:function(){var e=this,t=this.props.store.API("exitGroup");W.a.post(t,{data:{uid:this.props.store.uid,token:this.props.store.token,groupId:this.props.match.params.id}}).then((function(t){403===t.status?e.props.store.forceLogout():200===t.status?(alert("\u9000\u7fa4\u6210\u529f."),e.props.store.exitGroup(e.props.match.params.id)):alert("\u9000\u7fa4\u5931\u8d25\uff0c\u539f\u56e0\u662f\uff1a"+t.message)}))}},{key:"render",value:function(){var e=this,t=this.props.match.params.id,a=this.props.store.groupKeyMap[t];return a?j.a.createElement("div",{className:"mechat-profile-page"},j.a.createElement("p",{className:"mechat-profile-title"},"\u7fa4\u8d44\u6599"),j.a.createElement("div",{className:"mechat-profile-container"},j.a.createElement("div",{className:"mechat-profile-avatar"},j.a.createElement("img",{src:Y,alt:"avatar"})),j.a.createElement("div",{className:"mechat-profile-meta"},j.a.createElement("h1",{className:"mechat-profile-nickname"},a.name),j.a.createElement("p",{className:"mechat-profile-account"},"\u7fa4 ID\uff1a",a.id),j.a.createElement("p",{className:"mechat-profile-signature"},"\u7b80\u4ecb\uff1a",a.description),j.a.createElement(A.b,{className:"mechat-profile-chat",to:"/app/groupMessage/"+a.id,onClick:function(){return e.chatWith(a.id,a.name)}},"\u804a\u5929"),j.a.createElement("button",{className:"mechat-profile-exit",onClick:function(){return e.exitGroup()}},"\u9000\u7fa4")))):null}}]),t}(_.Component))||m)||m,Z=Object(N.e)(X),V=(a(217),Object(M.b)("store")(h=Object(M.c)(h=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(k.a)(t).call(this,e))).state={inviting:!1},a}return Object(O.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.onkeydown=function(t){var a=t.which?t.which:t.keyCode;t.ctrlKey&&13===a&&e.sendMessage()},window.browserWindow.getCurrentWindow().setSize(1e3,600),this.chatContent.scrollTop=this.chatContent.scrollHeight}},{key:"componentWillUnmount",value:function(){document.onkeydown=null,window.browserWindow.getCurrentWindow().setSize(800,600)}},{key:"onClipboardPaste",value:function(e){var t=e.clipboardData.items;if(t.length){var a=t[0].getAsFile();a&&a.type&&-1!==!a.type.indexOf("image")&&this.sendImage(a)}}},{key:"renderChatContent",value:function(){var e=this,t=[],a=this.props.match.params.id,r=this.props.store.getRawChats(a),n=this.props.store.avatar,s=0,i=0;if(r.forEach)return r.forEach((function(a){if(a.timestamp-i>=1e6){var r=new Date(a.timestamp),o="";o+=r.getHours()<10?"0"+r.getHours():r.getHours(),o+=":",o+=r.getMinutes()<10?"0"+r.getMinutes():r.getMinutes(),t.push(j.a.createElement("div",{key:s++,className:"mechat-chat-item-time"},o)),i=a.timestamp}t.push(j.a.createElement(L,{chat:a,chatWith:e.props.store.chattingWith,myAvatar:n,avatar:e.props.store.API("avatar/")+a.avatar,key:s++}))})),t;this.props.store.reloadMessageList()}},{key:"changeScrollTop",value:function(){this.chatContent.scrollTop=this.chatContent.scrollHeight}},{key:"sendMessage",value:function(){var e=this.textarea.value,t=this.props.match.params.id;this.props.store.sendMessage(t,e,"string",!0),this.props.store.setRead(t),this.textarea.value="",this.changeScrollTop(),W.a.post(this.props.store.API("sendMessage"),{data:{uid:this.props.store.uid,to:t,type:"string",content:e,token:this.props.store.token,target:"group"}}).then((function(e){200===e.status||alert("\u53d1\u9001\u4fe1\u606f\u5931\u8d25\uff0c\u539f\u56e0\u53ef\u80fd\u662f\uff1a"+e.message)}))}},{key:"selectImage",value:function(){this.imageInput.click()}},{key:"sendImage",value:function(e){var t=this,a=e||this.imageInput.files[0];if(a.size/1024/1024>2)alert("\u53d1\u9001\u7684\u56fe\u7247\u5c3a\u5bf8\u4e0d\u80fd\u8d85\u8fc7 2MB");else{var r=new FileReader,n=this.props.match.params.id;r.readAsDataURL(a),r.onload=function(e){var a=r.result;t.props.store.sendMessage(n,a,"image",!0),W.a.post(t.props.store.API("sendMessage"),{data:{uid:t.props.store.uid,to:n,type:"image",content:a,token:t.props.store.token,target:"group"}}).then((function(e){200===e.status||alert("\u53d1\u9001\u4fe1\u606f\u5931\u8d25\uff0c\u539f\u56e0\u53ef\u80fd\u662f\uff1a"+e.message)}))}}}},{key:"doInvite",value:function(){var e=this,t=this.props.store.uid,a=this.props.store.token,r=this.inviteInput.value;W.a.post(this.props.store.API("inviteToGroup"),{data:{uid:t,token:a,groupId:this.props.match.params.id,target:r}}).then((function(t){200===t.status&&(alert("\u9080\u8bf7\u6210\u529f\uff01"),e.props.store.reloadGroupList(),e.setState({inviting:!1}))}))}},{key:"renderMembers",value:function(){var e=this;if(!this.props.store.groupKeyMap[this.props.match.params.id])return null;var t=this.props.store.groupKeyMap[this.props.match.params.id].members,a=[],r=0;return t.forEach((function(t){a.push(j.a.createElement("div",{className:"mechat-group-members-item",key:r++},j.a.createElement("img",{src:e.props.store.API("avatar/")+t.avatar,alt:"avatar"}),j.a.createElement("span",null,t.nickname)))})),a}},{key:"render",value:function(){var e=this,t=setInterval((function(){e.chatContent&&(e.changeScrollTop(),clearInterval(t))}),50);return j.a.createElement("div",{className:"mechat-chat-page mechat-group-chat",onPaste:function(t){return e.onClipboardPaste(t)}},j.a.createElement("div",{className:"mechat-group-container"},j.a.createElement("div",{className:"mechat-chat-title"},this.props.store.chattingWith.nickname),j.a.createElement("div",{className:"mechat-chat-content",ref:function(t){return e.chatContent=t}},e.renderChatContent()),j.a.createElement("div",{className:"mechat-chat-textarea"},j.a.createElement("textarea",{name:"chat-text",ref:function(t){return e.textarea=t}}),j.a.createElement("input",{accept:"image/*",ref:function(t){return e.imageInput=t},type:"file",onChange:function(){return e.sendImage()}}),j.a.createElement("button",{className:"mechat-chat-image",title:"\u53d1\u9001\u56fe\u7247",onClick:function(){return e.selectImage()}},j.a.createElement("i",{className:"fa fa-image"})),j.a.createElement("button",{className:"mechat-chat-send",onClick:function(){return e.sendMessage()}},"\u53d1\u9001"))),j.a.createElement("div",{className:"mechat-group-members"},j.a.createElement("div",{className:"mechat-chat-title"},"\u7fa4\u6210\u5458",j.a.createElement("span",{className:"fa fa-plus invite-button",title:"\u9080\u8bf7\u65b0\u6210\u5458",onClick:function(){return e.setState({inviting:!0})}})),j.a.createElement("div",{className:"mechat-group-members-list"},this.renderMembers(),j.a.createElement("div",{className:"mechat-group-members-invite",style:{display:this.state.inviting?"block":"none"}},j.a.createElement("input",{type:"text",placeholder:"\u8f93\u5165\u7528\u6237\u540d\u6765\u9080\u8bf7\u7528\u6237\u5165\u7fa4\uff01",ref:function(t){return e.inviteInput=t}}),j.a.createElement("button",{type:"button",onClick:function(){return e.doInvite()}},"\u9080\u8bf7")))))}}]),t}(_.Component))||h)||h),$=Object(N.e)(V),ee=(a(218),Object(M.b)("store")(d=Object(M.c)(d=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){this.props.store.reloadPostList()}},{key:"likePost",value:function(e){var t=this;console.log(e),W.a.post(this.props.store.API("likePost"),{data:{uid:this.props.store.uid,token:this.props.store.token,target:e,offset:this.props.store.likes[e]?-1:1}}).then((function(a){403===a.status?t.props.store.forceLogout():200!==a.status?console.log("FriendCircle.likePost",a.message):t.props.store.likePost(e)}))}},{key:"deletePost",value:function(e){var t=this;W.a.post(this.props.store.API("deletePost"),{data:{uid:this.props.store.uid,token:this.props.store.token,target:e}}).then((function(a){403===a.status?t.props.store.forceLogout():200!==a.status?console.log("FriendCircle.deletePost",a.message):t.props.store.deletePost(e)}))}},{key:"renderPosts",value:function(){var e=this,t=[],a=document.createElement("div"),r=0;return this.props.store.posts.forEach((function(n){a.innerText=n.content;var s=a.innerHTML.replace(/\n/g,"<br/>"),i=e.props.store.likes[n._id];t.push(j.a.createElement("div",{className:"mechat-fc-item",key:r++},j.a.createElement("div",{className:"mechat-fc-item-meta"},j.a.createElement("img",{className:"mechat-fc-item-meta-avatar",src:e.props.store.API("avatar",n.avatar),alt:"avatar"}),j.a.createElement("span",{className:"mechat-fc-item-meta-nickname"},n.nickname)),j.a.createElement("div",{className:"mechat-fc-item-content",dangerouslySetInnerHTML:{__html:s}}),j.a.createElement("div",{className:"mechat-fc-item-actions"},j.a.createElement("button",{className:"mechat-fc-like"+(i?" liked":""),onClick:function(){return e.likePost(n._id)}},j.a.createElement("i",{className:"fa fa-heart"}),j.a.createElement("span",{className:"mechat-fc-like-cnt"},n.likes)),j.a.createElement(A.b,{to:"/app/posts/".concat(n._id)},j.a.createElement("i",{className:"fa fa-commenting-o"})),n.createdBy===e.props.store.uid?j.a.createElement("button",{className:"mechat-fc-delete",onClick:function(){return e.deletePost(n._id)}},j.a.createElement("i",{className:"fa fa-trash"})):null)))})),t}},{key:"render",value:function(){var e=this.props.match.path.indexOf("circle")>=0?1:0;return j.a.createElement("div",{className:"mechat-friend-circle "+(e?"mechat-fc-full-width":"")},j.a.createElement("h1",{className:"mechat-messages-title"},"\u597d\u53cb\u52a8\u6001"),j.a.createElement("div",{className:"mechat-fc-lists"},this.renderPosts(),j.a.createElement("div",{className:"mechat-fc-boundary"},"I have boundaries.")),j.a.createElement(A.b,{to:"/app/createPost",className:"mechat-fc-create"},j.a.createElement("i",{className:"fa fa-plus"})))}}]),t}(_.Component))||d)||d),te=Object(N.e)(ee),ae=(a(219),Object(M.b)("store")(f=Object(M.c)(f=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(y.a)(t,[{key:"createPost",value:function(){var e=this,t=this.textarea.value;W.a.post(this.props.store.API("createPost"),{data:{uid:this.props.store.uid,token:this.props.store.token,content:t}}).then((function(a){if(403===a.status)e.props.store.forceLogout();else if(200!==a.status)alert("\u53d1\u9001\u5931\u8d25\uff0c\u539f\u56e0\u662f\uff1a"+a.message);else{var r=a.payload.id;e.props.store.pushNewPost(r,t,[])}}))}},{key:"render",value:function(){var e=this;return j.a.createElement("div",{className:"mechat-create-post"},j.a.createElement("h1",{className:"mechat-cp-title"},"\u65b0\u7684\u52a8\u6001"),j.a.createElement("div",{className:"mechat-cp-container"},j.a.createElement("textarea",{ref:function(t){return e.textarea=t},className:"mechat-cp-textarea",placeholder:"\u5206\u4eab\u65b0\u9c9c\u4e8b..."}),j.a.createElement("div",{className:"mechat-cp-images"}),j.a.createElement("button",{className:"mechat-cp-send",onClick:function(){return e.createPost()}},"\u53d1\u9001")))}}]),t}(_.Component))||f)||f),re=Object(N.e)(ae),ne=Object(M.b)("store")(g=Object(M.c)(g=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(k.a)(t).call(this,e))).state={returnId:null,nickname:null},a}return Object(O.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){var e=this.getPost(this.props.match.params.id);this.setState({returnId:this.props.match.params.id,nickname:e?e.nickname:null})}},{key:"getPost",value:function(e){for(var t in this.props.store.posts)if(this.props.store.posts[t]._id===e)return this.props.store.posts[t];return null}},{key:"reply",value:function(){var e=this;W.a.post(this.props.store.API("createPost"),{data:{uid:this.props.store.uid,token:this.props.store.token,content:this.commentContent.value,type:2,replyTo:this.state.returnId}}).then((function(t){console.log(t),403===t.status?e.props.store.forceLogout():200!==t.status?console.log("FriendCircle.likePost",t.message):(e.props.store.reloadPostList(),e.sendButton.innerHTML="\u5df2\u53d1\u9001~",setTimeout((function(){return e.sendButton.innerHTML="\u56de\u590d"}),4e3))}))}},{key:"likePost",value:function(e){var t=this;W.a.post(this.props.store.API("likePost"),{data:{uid:this.props.store.uid,token:this.props.store.token,target:e,offset:this.props.store.likes[e]?-1:1}}).then((function(a){403===a.status?t.props.store.forceLogout():200!==a.status?console.log("FriendCircle.likePost",a.message):t.props.store.likePost(e)}))}},{key:"deletePost",value:function(e){var t=this;W.a.post(this.props.store.API("deletePost"),{data:{uid:this.props.store.uid,token:this.props.store.token,target:e}}).then((function(a){403===a.status?t.props.store.forceLogout():200!==a.status?console.log("FriendCircle.deletePost",a.message):t.props.store.deletePost(e)}))}},{key:"renderComments",value:function(e){var t=this,a=[];if(e)return e.comments.forEach((function(r){a.push(j.a.createElement("div",{key:r._id,className:"mechat-fc-comment-item",onClick:function(e){e.preventDefault(),e.stopPropagation(),t.setState({returnId:r._id,nickname:r.nickname}),t.commentContent.focus()}},j.a.createElement("span",{className:"mechat-fc-comment-author"},r.nickname),j.a.createElement("span",null,"\u56de\u590d"),j.a.createElement("span",{className:"mechat-fc-comment-reply-target"},e.nickname,"\uff1a"),j.a.createElement("span",null,r.content),j.a.createElement("div",{className:"mechat-fc-subcomment-list"},t.renderComments(r))))})),a}},{key:"render",value:function(){var e=this,t=this.props.match.params.id,a=this.getPost(t),r=document.createElement("div");if(!a)return null;r.innerText=a.content;var n=r.innerHTML.replace(/\n/g,"<br/>"),s=this.props.store.likes[a._id];return j.a.createElement("div",{className:"mechat-post"},j.a.createElement("h1",{className:"mechat-messages-title"},"\u52a8\u6001\u8be6\u60c5"),j.a.createElement("div",{className:"mechat-post-container"},j.a.createElement("div",{className:"mechat-fc-item"},j.a.createElement("div",{className:"mechat-fc-item-meta"},j.a.createElement("img",{className:"mechat-fc-item-meta-avatar",src:this.props.store.API("avatar",a.avatar),alt:"avatar"}),j.a.createElement("span",{className:"mechat-fc-item-meta-nickname"},a.nickname)),j.a.createElement("div",{className:"mechat-fc-item-content",dangerouslySetInnerHTML:{__html:n}}),j.a.createElement("div",{className:"mechat-fc-item-actions"},j.a.createElement("button",{className:"mechat-fc-like"+(s?" liked":""),onClick:function(){return e.likePost(a._id)}},j.a.createElement("i",{className:"fa fa-heart"}),j.a.createElement("span",{className:"mechat-fc-like-cnt"},a.likes)),j.a.createElement(A.b,{to:"/app/posts/".concat(a._id)},j.a.createElement("i",{className:"fa fa-commenting-o"})),a.createdBy===this.props.store.uid?j.a.createElement("button",{className:"mechat-fc-delete",onClick:function(){return e.deletePost(a._id)}},j.a.createElement("i",{className:"fa fa-trash"})):null),j.a.createElement("div",{className:"mechat-fc-item-comments",style:{display:a.comments.length?"block":"none"}},this.renderComments(a)),j.a.createElement("div",{className:"mechat-fc-item-input"},j.a.createElement("textarea",{ref:function(t){return e.commentContent=t},className:"mechat-fc-textarea",placeholder:"\u56de\u590d ".concat(this.state.nickname,"\uff1a")}),j.a.createElement("button",{ref:function(t){return e.sendButton=t},className:"mechat-chat-send",onClick:function(){return e.reply()}},"\u56de\u590d")))))}}]),t}(_.Component))||g)||g,se=Object(N.e)(ne),ie=Object(M.b)("store")(v=Object(M.c)(v=function(e){function t(){var e,a;Object(b.a)(this,t);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(a=Object(E.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(n)))).retry=0,a}return Object(O.a)(t,e),Object(y.a)(t,[{key:"componentWillMount",value:function(){null==sessionStorage.getItem("userInfo")?this.props.history.push("/"):this.props.store.setUserInfo(JSON.parse(sessionStorage.getItem("userInfo"))),this.createSocketConnection(),this.props.store.reloadFriendsList(),this.props.store.reloadGroupList(),this.props.store.reloadMessageList()}},{key:"componentWillUnmount",value:function(){this.ws.close()}},{key:"componentDidMount",value:function(){window.browserWindow.getCurrentWindow().setSize(800,600),this.props.store.setRouter(this.props.history)}},{key:"createSocketConnection",value:function(){var e=this;this.ws=new WebSocket(this.props.store.configUrl.wsUrl);var t=this.ws;t.addEventListener("open",(function(){t.send(JSON.stringify({uid:e.props.store.uid,token:e.props.store.token})),e.retry=0,e.props.store.connectSocketLink(e.ws)})),t.addEventListener("message",(function(t){switch((t=JSON.parse(t.data)).type){case"message":e.props.store.pushNewMessage(t.from,t.payload);break;case"friends":e.props.store.reloadFriendsList();break;case"groups":e.props.store.reloadGroupList()}})),t.addEventListener("close",(function(){if(e.retry&&e.retry>=3)return alert("\u8fde\u63a5\u9519\u8bef\u3002\u8fd4\u56de\u767b\u5f55\u9875\u9762..."),void e.props.history.push("/");e.props.store.token&&(e.retry=e.retry?e.retry+1:1,setTimeout((function(){return e.createSocketConnection()}),5e3))})),t.addEventListener("error",(function(){alert("\u8fde\u63a5\u9519\u8bef\u3002\u8fd4\u56de\u767b\u5f55\u9875\u9762..."),e.props.history.push("/")}))}},{key:"render",value:function(){return j.a.createElement("div",{className:"mechat-mainpage"},j.a.createElement(A.a,{history:this.props.history},j.a.createElement(N.a,{path:"/app"},j.a.createElement(w,null)),j.a.createElement(N.a,{path:"/app/message"},j.a.createElement(I,null)),j.a.createElement(N.a,{path:"/app/message/:id"},j.a.createElement(x,null)),j.a.createElement(N.a,{path:"/app/groupMessage/:id"},j.a.createElement(I,null),j.a.createElement($,null)),j.a.createElement(N.a,{path:"/app/friends"},j.a.createElement(K,null)),j.a.createElement(N.a,{path:"/app/friends/:id"},j.a.createElement(S,null)),j.a.createElement(N.a,{path:"/app/groups"},j.a.createElement(q,null)),j.a.createElement(N.a,{path:"/app/groups/:id"},j.a.createElement(Z,null)),j.a.createElement(N.a,{path:"/app/createNewGroup"},j.a.createElement(q,null),j.a.createElement(J,null)),j.a.createElement(N.a,{path:"/app/editProfile"},j.a.createElement(K,null),j.a.createElement(F,null)),j.a.createElement(N.a,{path:"/app/circle"},j.a.createElement(te,null)),j.a.createElement(N.a,{path:"/app/posts/:id"},j.a.createElement(te,null),j.a.createElement(se,null)),j.a.createElement(N.a,{path:"/app/createPost"},j.a.createElement(te,null),j.a.createElement(re,null)),j.a.createElement(N.a,{path:"/app/about"},j.a.createElement(z,null))))}}]),t}(_.Component))||v)||v;t.a=Object(N.e)(ie)},112:function(e,t,a){"use strict";var r,n,s,i,o,c,l,p,u,m,h,d,f,g,v,b,y,E,k,O,_,j=a(14),N=a(5),A=a(6),M=a(4),P=(a(220),a(1)),w={apiUrl:"https://mechat.kirainmoe.com/",wsUrl:"ws://mechat.kirainmoe.com/entry"},C=a(11),I=a.n(C);a.d(t,"a",(function(){return W}));var L=a(104),D=a(44),W=(r=function(){function e(){Object(N.a)(this,e),Object(j.a)(this,"nickname",n,this),Object(j.a)(this,"username",s,this),Object(j.a)(this,"uid",i,this),Object(j.a)(this,"mail",o,this),Object(j.a)(this,"signature",c,this),Object(j.a)(this,"avatar",l,this),Object(j.a)(this,"token",p,this),Object(j.a)(this,"friends",u,this),Object(j.a)(this,"groups",m,this),Object(j.a)(this,"posts",h,this),Object(j.a)(this,"uidKeyMap",d,this),Object(j.a)(this,"groupKeyMap",f,this),Object(j.a)(this,"socketLink",g,this),Object(j.a)(this,"messageList",v,this),Object(j.a)(this,"currentDialog",b,this),Object(j.a)(this,"chattingWith",y,this),Object(j.a)(this,"fetching",E,this),Object(j.a)(this,"router",k,this),Object(j.a)(this,"likes",O,this),Object(j.a)(this,"configUrl",_,this)}return Object(A.a)(e,[{key:"API",value:function(e,t){return t?this.configUrl.httpUrl+e+"/"+t:this.configUrl.httpUrl+e}},{key:"wsAPI",value:function(e){return this.configUrl.wsUrl+e}},{key:"getRawChats",value:function(e){return this.messageList[e]?this.messageList[e].records:{}}},{key:"initModelState",value:function(){this.nickname=null,this.username=null,this.uid=null,this.mail=null,this.signature=null,this.avatar=L,this.token=null,this.friends=[],this.groups=[],this.posts=[],this.uidKeyMap={},this.groupKeyMap={},this.socketLink&&this.socketLink.close(),this.socketLink=null,this.messageList={},this.currentDialog=null,this.chattingWith={uid:null,nickname:null,avatar:null},this.fetching=!1}},{key:"setRouter",value:function(e){this.router=e}},{key:"forceLogout",value:function(e){e||alert("\u8eab\u4efd\u9a8c\u8bc1\u53d1\u751f\u95ee\u9898\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"),sessionStorage.removeItem("userInfo"),this.initModelState(),this.router.push("/")}},{key:"setUserInfo",value:function(e){this.nickname=e.nickname,this.username=e.username,this.signature=e.signature,this.uid=e.id,this.avatar=e.avatar,this.token=e.token,this.mail=e.mail}},{key:"setNewAvatar",value:function(e,t){this.avatar=t?e:this.API("avatar",e)}},{key:"addFriend",value:function(e){this.friends.push(e),this.uidKeyMap[e.uid]=e}},{key:"addGroup",value:function(e){this.groups.push(e),this.groupKeyMap[e.id]=e}},{key:"updateFriends",value:function(e){var t=this;this.friends=e,e.forEach((function(e){t.uidKeyMap[e.uid]=e,t.messageList[e.uid]&&(t.messageList[e.uid].nickname=e.nickname,t.messageList[e.uid].avatar=e.avatar)}))}},{key:"updateGroups",value:function(e){var t=this;this.groups=e,e.forEach((function(e){t.groupKeyMap[e.id]=e,t.messageList[e.id]&&(t.messageList[e.id].nickname=e.name)}))}},{key:"connectSocketLink",value:function(e){this.socketLink=e}},{key:"addDialog",value:function(e,t){this.messageList[e]={with:e,nickname:t?this.groupKeyMap[e].name:this.uidKeyMap[e].alias?this.uidKeyMap[e].alias:this.uidKeyMap[e].nickname,avatar:t?D:this.uidKeyMap[e].avatar,last:Date.parse(new Date),read:!0,records:[],target:t?"group":"friends"}}},{key:"replaceDialog",value:function(e){for(var t in e)this.uidKeyMap[e[t].with]&&this.uidKeyMap[e[t].with].alias&&(e[t].nickname=this.uidKeyMap[e[t].with].alias);this.messageList=e}},{key:"setChattingWith",value:function(e,t,a){this.chattingWith={uid:e,nickname:t,avatar:this.API("avatar",a)}}},{key:"sendMessage",value:function(e,t,a,r){this.messageList[e]||this.addDialog(e);var n=Date.parse(new Date),s={from:1,timestamp:n,type:a,content:t,target:r?"group":"friends"};r&&(s.avatar=this.avatar,s.nickname=this.nickname),this.messageList[e].records.push(s),this.messageList[e].last=n}},{key:"setRead",value:function(e){this.messageList[e].read=!0}},{key:"pushNewMessage",value:function(e,t){this.messageList[e]||(this.addDialog(e,"group"===t.target),console.log(e,t,233)),this.messageList[e].read=!1,this.messageList[e].records.push(t),this.messageList[e].last=t.timestamp}},{key:"pushNewPost",value:function(e,t,a){this.posts.unshift({_id:e,createdBy:this.uid,createTime:new Date,content:t,nickname:this.nickname,avatar:this.avatar.replace(this.API("avatar"),""),type:1,images:a,comments:[]})}},{key:"updateAlias",value:function(e,t){for(var a in this.uidKeyMap[e].alias=t,this.friends)this.friends[a].uid===e&&(this.friends[a].alias=t)}},{key:"exitGroup",value:function(e){for(var t in delete this.groupKeyMap[e],this.groups)this.groups[t].id===e&&(this.groups[t]=void 0,delete this.groups[t]);delete this.messageList[e]}},{key:"deleteFriend",value:function(e){for(var t in delete this.uidKeyMap[e],this.friends)this.friends[t].uid===e&&(this.friends[t]=void 0,delete this.friends[t]);delete this.messageList[e]}},{key:"reloadMessageList",value:function(){var e=this;this.fetching=!0;var t=w.apiUrl+"getMessageList";I.a.post(t,{data:{uid:this.uid,token:this.token}}).then((function(t){403===t.status&&e.forceLogout(),200===t.status?(e.replaceDialog(t.payload),e.fetching=!1):alert("\u62c9\u53d6\u6d88\u606f\u5217\u8868\u5931\u8d25 :(")}))}},{key:"reloadFriendsList",value:function(){var e=this;I.a.post(this.API("friends"),{data:{uid:this.uid,token:this.token}}).then((function(t){403===t.status?e.forceLogout():200===t.status?e.updateFriends(t.payload):console.log("model.reloadFriendsList",t)}))}},{key:"reloadGroupList",value:function(){var e=this,t=this.API("getUserGroups");I.a.post(t,{data:{uid:this.uid,token:this.token}}).then((function(t){403===t.status?e.forceLogout():200===t.status?e.updateGroups(t.payload):console.log("model.reloadGroupList",t)}))}},{key:"reloadPostList",value:function(){var e=this,t=this.API("getFriendsPost");I.a.post(t,{data:{uid:this.uid,token:this.token}}).then((function(t){403===t.status?e.forceLogout():200===t.status?e.posts=t.payload:console.log("model.reloadPostList",t)}))}},{key:"likePost",value:function(e){for(var t in this.likes[e]=!this.likes[e],this.posts)if(this.posts[t]._id===e){this.posts[t].likes+=this.likes[e]?1:-1;break}}},{key:"deletePost",value:function(e){for(var t in this.posts)if(this.posts[t]._id===e){this.posts.splice(t,1);break}}}]),e}(),n=Object(M.a)(r.prototype,"nickname",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),s=Object(M.a)(r.prototype,"username",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),i=Object(M.a)(r.prototype,"uid",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o=Object(M.a)(r.prototype,"mail",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=Object(M.a)(r.prototype,"signature",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=Object(M.a)(r.prototype,"avatar",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return L}}),p=Object(M.a)(r.prototype,"token",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u=Object(M.a)(r.prototype,"friends",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),m=Object(M.a)(r.prototype,"groups",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),h=Object(M.a)(r.prototype,"posts",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=Object(M.a)(r.prototype,"uidKeyMap",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),f=Object(M.a)(r.prototype,"groupKeyMap",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),g=Object(M.a)(r.prototype,"socketLink",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=Object(M.a)(r.prototype,"messageList",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),b=Object(M.a)(r.prototype,"currentDialog",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=Object(M.a)(r.prototype,"chattingWith",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{uid:null,nickname:null,avatar:null}}}),E=Object(M.a)(r.prototype,"fetching",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),k=Object(M.a)(r.prototype,"router",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=Object(M.a)(r.prototype,"likes",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),_=Object(M.a)(r.prototype,"configUrl",[P.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{httpUrl:w.apiUrl,wsUrl:w.wsUrl}}}),Object(M.a)(r.prototype,"API",[P.h],Object.getOwnPropertyDescriptor(r.prototype,"API"),r.prototype),Object(M.a)(r.prototype,"wsAPI",[P.h],Object.getOwnPropertyDescriptor(r.prototype,"wsAPI"),r.prototype),Object(M.a)(r.prototype,"getRawChats",[P.h],Object.getOwnPropertyDescriptor(r.prototype,"getRawChats"),r.prototype),Object(M.a)(r.prototype,"initModelState",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"initModelState"),r.prototype),Object(M.a)(r.prototype,"setRouter",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"setRouter"),r.prototype),Object(M.a)(r.prototype,"forceLogout",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"forceLogout"),r.prototype),Object(M.a)(r.prototype,"setUserInfo",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"setUserInfo"),r.prototype),Object(M.a)(r.prototype,"setNewAvatar",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"setNewAvatar"),r.prototype),Object(M.a)(r.prototype,"addFriend",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"addFriend"),r.prototype),Object(M.a)(r.prototype,"addGroup",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"addGroup"),r.prototype),Object(M.a)(r.prototype,"updateFriends",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"updateFriends"),r.prototype),Object(M.a)(r.prototype,"updateGroups",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"updateGroups"),r.prototype),Object(M.a)(r.prototype,"connectSocketLink",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"connectSocketLink"),r.prototype),Object(M.a)(r.prototype,"addDialog",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"addDialog"),r.prototype),Object(M.a)(r.prototype,"replaceDialog",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"replaceDialog"),r.prototype),Object(M.a)(r.prototype,"setChattingWith",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"setChattingWith"),r.prototype),Object(M.a)(r.prototype,"sendMessage",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"sendMessage"),r.prototype),Object(M.a)(r.prototype,"setRead",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"setRead"),r.prototype),Object(M.a)(r.prototype,"pushNewMessage",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"pushNewMessage"),r.prototype),Object(M.a)(r.prototype,"pushNewPost",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"pushNewPost"),r.prototype),Object(M.a)(r.prototype,"updateAlias",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"updateAlias"),r.prototype),Object(M.a)(r.prototype,"exitGroup",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"exitGroup"),r.prototype),Object(M.a)(r.prototype,"deleteFriend",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"deleteFriend"),r.prototype),Object(M.a)(r.prototype,"reloadMessageList",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"reloadMessageList"),r.prototype),Object(M.a)(r.prototype,"reloadFriendsList",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"reloadFriendsList"),r.prototype),Object(M.a)(r.prototype,"reloadGroupList",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"reloadGroupList"),r.prototype),Object(M.a)(r.prototype,"reloadPostList",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"reloadPostList"),r.prototype),Object(M.a)(r.prototype,"likePost",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"likePost"),r.prototype),Object(M.a)(r.prototype,"deletePost",[P.d],Object.getOwnPropertyDescriptor(r.prototype,"deletePost"),r.prototype),r)},114:function(e,t,a){e.exports=a(115)},115:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),react_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(38),react_dom__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_1__),mobx_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2),react_router__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3),react_router_dom__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(13),_styles_index_styl__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(120),_styles_index_styl__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_styles_index_styl__WEBPACK_IMPORTED_MODULE_5__),_components_TopButton__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(106),_components_LoginPage__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(107),_components_RegisterPage__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(110),_components_MainPage__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(111),_models__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(112);eval('window.browserWindow = require("electron").remote'),-1!==navigator.userAgent.indexOf("Macintosh")&&document.body.setAttribute("style","-webkit-app-region: drag");var store=new _models__WEBPACK_IMPORTED_MODULE_10__.a;react_dom__WEBPACK_IMPORTED_MODULE_1___default.a.render(react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"mechat",id:"mechat"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(mobx_react__WEBPACK_IMPORTED_MODULE_2__.a,{store:store},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_TopButton__WEBPACK_IMPORTED_MODULE_6__.a,null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_4__.a,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router__WEBPACK_IMPORTED_MODULE_3__.a,{path:"/",exact:!0},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_LoginPage__WEBPACK_IMPORTED_MODULE_7__.a,null)),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router__WEBPACK_IMPORTED_MODULE_3__.a,{path:"/register",exact:!0},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_RegisterPage__WEBPACK_IMPORTED_MODULE_8__.a,null)),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router__WEBPACK_IMPORTED_MODULE_3__.a,{path:"/app"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_MainPage__WEBPACK_IMPORTED_MODULE_9__.a,null))))),document.getElementById("root"))},120:function(e,t,a){},121:function(e,t,a){},124:function(e,t){},126:function(e,t){},159:function(e,t){},160:function(e,t){},202:function(e,t,a){},207:function(e,t,a){},208:function(e,t,a){},209:function(e,t,a){},210:function(e,t,a){},211:function(e,t,a){},212:function(e,t,a){},213:function(e,t,a){},214:function(e,t,a){e.exports=a.p+"static/media/mechat.a8687cd1.png"},215:function(e,t,a){},216:function(e,t,a){},217:function(e,t,a){},218:function(e,t,a){},219:function(e,t,a){},44:function(e,t){e.exports="data:image/png;base64,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"}},[[114,1,2]]]);
//# sourceMappingURL=main.8d2093f6.chunk.js.map