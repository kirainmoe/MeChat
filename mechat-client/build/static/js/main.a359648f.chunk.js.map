{"version":3,"sources":["images/defaultAvatar.jpg","components/TopButton.js","components/LoginPage.js","components/RegisterPage.js","models/index.js","components/Navbar.js","components/MessageList.js","components/ChatPage.js","components/FriendsList.js","components/ProfilePage.js","components/ProfileEdit.js","components/MainPage.js","index.js","config.js"],"names":["module","exports","TopButton","maximized","window","close","browserWindow","getCurrentWindow","minimize","this","unmaximize","maximize","className","onClick","closeWindow","minimizeWindow","maximizeWindow","Component","LoginPage","inject","observer","props","state","nickname","avatar","require","username","usernameInput","value","password","crypto","createHash","update","passwordInput","digest","loginUri","config","apiUrl","honoka","post","data","then","res","JSON","parse","status","console","log","alert","message","sessionStorage","setItem","stringify","history","push","setSize","focus","src","alt","type","name","ref","placeholder","login","to","withRouter","RegisterPage","mail","mailInput","nicknameInput","regUri","register","Model","uid","messageList","records","uri","configUrl","httpUrl","wsUrl","user","signature","id","token","url","flag","API","friend","friends","uidKeyMap","forEach","socket","socketLink","with","last","Date","read","dialog","chattingWith","content","addDialog","timestamp","from","fetching","MessageListUri","replaceDialog","payload","msg","observable","nickanme","get","action","Navbar","removeItem","store","title","logOut","MessageList","item","setRead","setChattingWith","cnt","key","date","today","dateStr","getMonth","getDate","getHours","getMinutes","chatWith","getAvatar","length","style","display","renderMessageList","ChatPage","document","onkeydown","e","keycode","which","keyCode","ctrlKey","sendMessage","chatContent","scrollTop","scrollHeight","chats","match","params","rawChats","getRawChats","myAvatar","chat","reloadMessageList","text","textarea","renderChatContent","FriendsList","friendUri","updateFriends","input","addFriendUrl","addFriend","renderFriendsList","ProfilePage","ProfileEdit","avatarUpload","files","size","form","FormData","append","fetch","method","headers","body","json","fileObj","URL","createObjectURL","setNewAvatar","setUserInfo","click","setAttribute","selectAvatar","uploadForm","encType","accept","onChange","onFileLoadChange","defaultValue","editProfile","MainPage","ws","WebSocket","addEventListener","send","pushNewMessage","getItem","createSocketConnection","path","eval","createBrowserHistory","ReactDOM","render","exact","getElementById"],"mappings":"mGAAAA,EAAOC,QAAU,2rG,6HCIIC,G,kNACjBC,WAAY,E,6EAGRC,OAAOC,U,uCAIPD,OAAOE,cAAcC,mBAAmBC,a,uCAIpCC,KAAKN,UACLC,OAAOE,cAAcC,mBAAmBG,aAExCN,OAAOE,cAAcC,mBAAmBI,WAC5CF,KAAKN,WAAaM,KAAKN,Y,+BAGjB,IAAD,OACL,OACI,yBAAKS,UAAU,+BACX,4BAAQA,UAAU,yBAAyBC,QAAS,kBAAM,EAAKC,iBAC/D,4BAAQF,UAAU,6BAA6BC,QAAS,kBAAM,EAAKE,oBACnE,4BAAQH,UAAU,4BAA4BC,QAAS,kBAAM,EAAKG,yB,GAxB3CC,e,qKCQjCC,EAFLC,YAAO,Q,GACPC,Y,cAEC,WAAYC,GAAQ,IAAD,8BACjB,4CAAMA,KACDC,MAAQ,CACXC,SAAU,SACVC,OAAQC,EAAQ,MAJD,E,qEAQV,IAAD,OACAC,EAAWjB,KAAKkB,cAAcC,MAClCC,EAAWC,IACRC,WAAW,OACXC,OAAOvB,KAAKwB,cAAcL,OAC1BM,OAAO,OACNC,EAAWC,IAAOC,OAAS,QACjCC,IACGC,KAAKJ,EAAU,CACdK,KAAM,CACJd,WACAG,cAGHY,MAAK,SAAAC,GACe,kBAARA,IAAkBA,EAAMC,KAAKC,MAAMF,IAE3B,MAAfA,EAAIG,QACNC,QAAQC,IAAIL,SAAYA,GACxBM,MAAM,+DAAeN,EAAIO,WAEzBP,EAAIlB,OAASY,IAAOC,OAAS,UAAYK,EAAIlB,OAC7C0B,eAAeC,QAAQ,WAAYR,KAAKS,UAAUV,IAClD,EAAKrB,MAAMgC,QAAQC,KAAK,sB,0CAM5BlD,OAAOE,cAAcC,mBAAmBgD,QAAQ,IAAK,KACrD9C,KAAKkB,cAAc6B,U,+BAGb,IAAD,OACP,OACE,yBAAK5C,UAAU,oBACb,yBAAKA,UAAU,2BACb,uBAAGA,UAAU,iCACX,yBACEA,UAAU,sBACV6C,IAAKhD,KAAKa,MAAME,OAChBkC,IAAI,YAGR,uBAAG9C,UAAU,yBAAyBH,KAAKa,MAAMC,WAEnD,2BACEoC,KAAK,OACLC,KAAK,WACLhD,UAAU,8BACViD,IAAK,SAAAA,GAAG,OAAK,EAAKlC,cAAgBkC,GAClCC,YAAY,uBAEd,2BACEH,KAAK,WACLC,KAAK,WACLhD,UAAU,8BACViD,IAAK,SAAAA,GAAG,OAAK,EAAK5B,cAAgB4B,GAClCC,YAAY,iBAEd,yBAAKlD,UAAU,wBACb,4BACE+C,KAAK,SACL9C,QAAS,kBAAM,EAAKkD,SACpBnD,UAAU,uBAHZ,gBAOA,kBAAC,IAAD,CAAMoD,GAAG,YAAYpD,UAAU,yBAA/B,2DAIF,yBAAKA,UAAU,0BAAf,uE,GAjFgBK,e,MAyFTgD,gBAAW/C,I,4JC5FpBgD,E,mLACQ,IAAD,OACHxC,EAAWjB,KAAKkB,cAAcC,MAClCC,EAAWC,IAAOC,WAAW,OAAOC,OAAOvB,KAAKwB,cAAcL,OAAOM,OAAO,OAC5EiC,EAAO1D,KAAK2D,UAAUxC,MACtBL,EAAWd,KAAK4D,cAAczC,MAE1B0C,EAASlC,IAAOC,OAAS,WAC/BC,IAAOC,KAAK+B,EAAQ,CAClB9B,KAAM,CACJd,WACAG,WACAsC,OACA5C,cAEDkB,MAAK,SAAAC,GACY,iBAAPA,IACTA,EAAMC,KAAKC,MAAMF,IACE,MAAfA,EAAIG,QACNC,QAAQC,IAAIL,SAAYA,GACxBM,MAAM,+DAAeN,EAAIO,WAEzBD,MAAM,6EACN,EAAK3B,MAAMgC,QAAQC,KAAK,W,+BAKtB,IAAD,OACP,OACE,yBAAK1C,UAAU,wBACb,wBAAIA,UAAU,yBAAd,uBAGA,2BACE+C,KAAK,OACLC,KAAK,WACLhD,UAAU,iCACViD,IAAK,SAAAA,GAAG,OAAK,EAAKlC,cAAgBkC,GAClCC,YAAY,mCAEd,2BACEH,KAAK,WACLC,KAAK,WACLhD,UAAU,iCACViD,IAAK,SAAAA,GAAG,OAAK,EAAK5B,cAAgB4B,GAClCC,YAAY,iBAEd,2BACEH,KAAK,OACLC,KAAK,OACLhD,UAAU,6BACViD,IAAK,SAAAA,GAAG,OAAK,EAAKO,UAAYP,GAC9BC,YAAY,iBAEd,2BACEH,KAAK,OACLC,KAAK,WACLhD,UAAU,iCACViD,IAAK,SAAAA,GAAG,OAAK,EAAKQ,cAAgBR,GAClCC,YAAY,iBAGd,yBAAKlD,UAAU,2BACb,4BACE+C,KAAK,SACL9C,QAAS,kBAAM,EAAK0D,YACpB3D,UAAU,0BAHZ,gBAOA,kBAAC,IAAD,CAAMoD,GAAG,IAAIpD,UAAU,yBAAvB,oD,GAvEiBK,aAgFZgD,gBAAWC,I,8KCpFLM,G,sqBA4BLC,GACR,OAAKhE,KAAKiE,YAAYD,GAGfhE,KAAKiE,YAAYD,GAAKE,QAFlB,K,0BAMXC,GACA,OAAOnE,KAAKoE,UAAUC,QAAUF,I,4BAI9BA,GACF,OAAOnE,KAAKoE,UAAUE,MAAQH,I,kCAItBI,GACRvE,KAAKc,SAAWyD,EAAKzD,SACrBd,KAAKiB,SAAWsD,EAAKtD,SACrBjB,KAAKwE,UAAYD,EAAKC,UACtBxE,KAAKgE,IAAMO,EAAKE,GAChBzE,KAAKe,OAASwD,EAAKxD,OACnBf,KAAK0E,MAAQH,EAAKG,MAClB1E,KAAK0D,KAAOa,EAAKb,O,mCAIRiB,EAAKC,GAIV5E,KAAKe,OAHJ6D,EAGaD,EAFA3E,KAAK6E,IAAI,WAAaF,I,gCAMlCG,GACN9E,KAAK+E,QAAQlC,KAAKiC,GAClB9E,KAAKgF,UAAUF,EAAOd,KAAOc,I,oCAInBC,GAAU,IAAD,OACnB/E,KAAK+E,QAAUA,EACfA,EAAQE,SAAQ,SAAAH,GACZ,EAAKE,UAAUF,EAAOd,KAAOc,EACzB,EAAKb,YAAYa,EAAOd,OACxB,EAAKC,YAAYa,EAAOd,KAAKlD,SAAWgE,EAAOhE,SAC/C,EAAKmD,YAAYa,EAAOd,KAAKjD,OAAS+D,EAAO/D,a,wCAMvCmE,GACdlF,KAAKmF,WAAaD,I,gCAIZlB,GACNhE,KAAKiE,YAAYD,GAAO,CACpBoB,KAAMpB,EACNlD,SAAUd,KAAKgF,UAAUhB,GAAKlD,SAC9BC,OAAQf,KAAKgF,UAAUhB,GAAKjD,OAC5BsE,KAAMC,KAAKnD,MAAM,IAAImD,MACrBC,MAAM,EACNrB,QAAS,M,oCAKHsB,GACVxF,KAAKiE,YAAcuB,I,sCAIPxB,EAAKlD,EAAUC,GAC3Bf,KAAKyF,aAAe,CAChBzB,MACAlD,WACAC,Y,kCAKIiD,EAAK0B,EAASxC,GACjBlD,KAAKiE,YAAYD,IAClBhE,KAAK2F,UAAU3B,GAEnB,IAAM4B,EAAYN,KAAKnD,MAAM,IAAImD,MACjCtF,KAAKiE,YAAYD,GAAKE,QAAQrB,KAAK,CAC/BgD,KAAM,EACND,UAAWA,EACX1C,OACAwC,YAEJ1F,KAAKiE,YAAYD,GAAKqB,KAAOO,I,8BAKzB5B,GACJhE,KAAKiE,YAAYD,GAAKuB,MAAO,I,0CAIZ,IAAD,OAChBvF,KAAK8F,UAAW,EAChB,IAAMC,EAAiBpE,IAAOC,OAAS,iBACvCC,IAAOC,KAAKiE,EAAgB,CAC1BhE,KAAM,CACJiC,IAAKhE,KAAKgE,IACVU,MAAO1E,KAAK0E,SAEb1C,MAAK,SAAAC,GACa,MAAfA,EAAIG,QAIR,EAAK4D,cAAc/D,EAAIgE,SACvB,EAAKH,UAAW,GAJdvD,MAAM,4D,qCASCsD,EAAMK,GACjB7D,QAAQC,IAAIuD,EAAM7F,KAAKiE,YAAajE,KAAKgF,WACpChF,KAAKiE,YAAY4B,IAClB7F,KAAK2F,UAAUE,GAEnB7F,KAAKiE,YAAY4B,GAAMN,MAAO,EAC9BvF,KAAKiE,YAAY4B,GAAM3B,QAAQrB,KAAKqD,O,2CA/JvCC,K,yEAAsB,Q,sCACtBA,K,yEAAsB,Q,iCACtBA,K,yEAAiB,Q,kCACjBA,K,yEAAkB,Q,uCAClBA,K,yEAAuB,Q,oCACvBA,K,yEAAoBnF,EAAQ,Q,mCAC5BmF,K,yEAAmB,Q,qCACnBA,K,wEAAqB,M,oCACrBA,K,wEAAoB,M,wCAEpBA,K,yEAAwB,Q,yCACxBA,K,wEAAyB,M,2CACzBA,K,yEAA2B,Q,0CAC3BA,K,wEAA0B,CACvBnC,IAAK,KACLoC,SAAU,KACVrF,OAAQ,S,uCAEXoF,K,wEAAuB,M,sCACvBA,K,yEAAsB,K,uCAEtBA,K,wEAAuB,CACpB9B,QAAS1C,IAAOC,OAChB0C,MAAO3C,IAAO2C,U,uCAGjB+B,K,uGAQAA,K,iGAKAA,K,yGAKAC,K,gHAWAA,K,8GAQAA,K,+GAMAA,K,uHAYAA,K,mHAKAA,K,+GAYAA,K,qHAKAA,K,mHASAA,K,2GAgBAA,K,iHAKAA,K,wHAmBAA,K,+OCvJCC,EAFL7F,YAAO,Q,GACPC,Y,mLAGO8B,eAAe+D,WAAW,c,+BAGpB,IAAD,OACL,OACI,yBAAKrG,UAAU,uBACf,yBAAKA,UAAU,+BACb,kBAAC,IAAD,CAAMoD,GAAI,oBACR,yBACEpD,UAAU,oBACV8C,IAAI,SACJD,IAAKhD,KAAKY,MAAM6F,MAAM1F,OACtB2F,MAAO1G,KAAKY,MAAM6F,MAAM3F,aAI9B,kBAAC,IAAD,CAASyC,GAAG,eAAemD,MAAM,gBAC/B,uBAAGvG,UAAU,sBAEf,kBAAC,IAAD,CAASoD,GAAG,eAAemD,MAAM,sBAC/B,uBAAGvG,UAAU,0BAEf,kBAAC,IAAD,CAAMoD,GAAG,IAAImD,MAAM,eAAKtG,QAAS,kBAAM,EAAKuG,WAC1C,uBAAGxG,UAAU,2B,GAzBNK,e,MAgCNgD,cAAW+C,GC8BXK,EAhEdlG,YAAO,Q,GACPC,Y,oLAEWI,GACR,OAAOY,IAAOC,OAAS,UAAYb,I,+BAG5B8F,GACP7G,KAAKY,MAAM6F,MAAMK,QAAQD,EAAKzB,MAC9BpF,KAAKY,MAAM6F,MAAMM,gBAAgBF,EAAKzB,KAAMyB,EAAK/F,SAAU+F,EAAK9F,U,0CAG7C,IAAD,OACZkB,EAAM,GACR+E,EAAM,EAFQ,WAIPC,GACT,IAAMJ,EAAO,EAAKjG,MAAM6F,MAAMxC,YAAYgD,GACxCC,EAAO,IAAI5B,KAAKuB,EAAKxB,MACrB8B,EAAQ,IAAI7B,KAEV8B,EAAU,GACVF,EAAKG,aAAeF,EAAME,YAAcH,EAAKI,YAAcH,EAAMG,YACnEF,GAAYF,EAAKK,WAAa,GAAK,IAAML,EAAKK,WAAaL,EAAKK,WAChEH,GAAW,IACXA,GAAWF,EAAKM,aAAe,GAAK,IAAMN,EAAKM,aAAeN,EAAKM,cAGrEvF,EAAIY,KACF,kBAAC,IAAD,CAAS1C,UAAU,gBAAgBoD,GAAI,gBAAkBsD,EAAKzB,KAAM6B,IAAKD,IAAO5G,QAAS,kBAAM,EAAKqH,SAASZ,KAC3G,yBAAK1G,UAAU,wBACb,yBAAK6C,IAAK,EAAK0E,UAAUb,EAAK9F,QAASkC,IAAI,WACzC4D,EAAKtB,KAAO,KAAO,0BAAMpF,UAAW,uBAExC,yBAAKA,UAAU,sBACb,uBAAGA,UAAU,uBAAuB0G,EAAK/F,UACzC,uBAAGX,UAAU,sBAAsB0G,EAAK3C,QAAQyD,OAASd,EAAK3C,QAAQ2C,EAAK3C,QAAQyD,OAAO,GAAGjC,QAAU,IACvG,0BAAMvF,UAAU,sBAAsBiH,OArB9C,IAAK,IAAMH,KAAOjH,KAAKY,MAAM6F,MAAMxC,YAAc,EAAtCgD,GA2BX,OAAOhF,I,+BAEC,IAAD,OACP,OACE,yBAAK9B,UAAU,mBACb,wBAAIA,UAAU,yBAAd,4BAGA,yBAAKA,UAAU,2BAA2ByH,MAAO,CAC/CC,QAAS7H,KAAKY,MAAM6F,MAAMX,SAAW,QAAU,SADjD,uDAKA,yBAAK3F,UAAU,wBACL,EAAK2H,0B,GAvDGtH,e,MCGpBuH,G,OAFLrH,YAAO,Q,GACPC,Y,oLAEWI,GACR,OAAOY,IAAOC,OAAS,UAAYb,I,0CAGhB,IAAD,OAClBiH,SAASC,UAAY,SAACC,GACpB,IAAMC,EAAUD,EAAEE,MAAQF,EAAEE,MAAQF,EAAEG,QAClCH,EAAEI,SAAuB,KAAZH,GACf,EAAKI,eAITvI,KAAKwI,YAAYC,UAAYzI,KAAKwI,YAAYE,e,6CAI9CV,SAASC,UAAY,O,0CAGF,IAAD,OACZU,EAAQ,GACZ3E,EAAMhE,KAAKY,MAAMgI,MAAMC,OAAOpE,GAC9BqE,EAAW9I,KAAKY,MAAM6F,MAAMsC,YAAY/E,GACxCgF,EAAWhJ,KAAKY,MAAM6F,MAAM1F,OAE1BiG,EAAM,EACV,GAAK8B,EAAS7D,QAyBd,OApBA6D,EAAS7D,SAAQ,SAAAgE,GACfN,EAAM9F,KACJ,yBACE1C,UAAW,oBAAoC,IAAd8I,EAAKpD,KAAa,WAAa,IAChEoB,IAAKD,KAEL,yBAAK7G,UAAU,2BACb,yBACE6C,IACgB,IAAdiG,EAAKpD,KACD,EAAK6B,UAAU,EAAK9G,MAAM6F,MAAMhB,aAAa1E,QAC7CiI,EAEN/F,IAAI,YAGR,yBAAK9C,UAAU,yBAAyB8I,EAAKvD,cAI5CiD,EAxBL3I,KAAKY,MAAM6F,MAAMyC,sB,oCA4BnB,IAAMC,EAAOnJ,KAAKoJ,SAASjI,MACzB6C,EAAMhE,KAAKY,MAAMgI,MAAMC,OAAOpE,GAChCzE,KAAKY,MAAM6F,MAAM8B,YAAYvE,EAAKmF,EAAM,UACxCnJ,KAAKY,MAAM6F,MAAMK,QAAQ9C,GACzBhE,KAAKoJ,SAASjI,MAAQ,GAEtBnB,KAAKwI,YAAYC,UAAYzI,KAAKwI,YAAYE,aAE9C7G,IAAOC,KAAKH,IAAOC,OAAS,cAAe,CACzCG,KAAM,CACJiC,IAAKhE,KAAKY,MAAM6F,MAAMzC,IACtBT,GAAIS,EACJd,KAAM,SACNwC,QAASyD,EACTzE,MAAO1E,KAAKY,MAAM6F,MAAM/B,SAEzB1C,MAAK,SAAAC,GACN,GAAmB,MAAfA,EAAIG,OAGN,OAFAG,MAAM,iFAAkBN,EAAIO,cAC5BH,QAAQC,IAAIL,Q,+BAMR,IAAD,OACP,OACE,yBAAK9B,UAAU,oBACb,yBAAKA,UAAU,qBAAqBH,KAAKY,MAAM6F,MAAMhB,aAAa3E,UAElE,yBAAKX,UAAU,sBAAsBiD,IAAK,SAAAA,GAAG,OAAI,EAAKoF,YAAcpF,IAC1D,EAAKiG,qBAGf,yBAAKlJ,UAAU,wBACb,8BAAUgD,KAAK,YAAYC,IAAK,SAAAA,GAAG,OAAI,EAAKgG,SAAWhG,KACvD,4BAAQjD,UAAU,mBAAmBC,QAAS,kBAAM,EAAKmI,gBAAzD,sB,GA5Fa/H,e,OAmGRgD,cAAWuE,GCfXuB,G,OAtFd5I,YAAO,Q,GACPC,Y,8LAGG,IAAMsB,EAAM,GACR+E,EAAM,EAcV,OAbAhH,KAAKY,MAAM6F,MAAM1B,QAAQE,SAAQ,SAAAH,GAC/B7C,EAAIY,KACF,kBAAC,IAAD,CAAS1C,UAAU,gBAAgBoD,GAAI,gBAAkBuB,EAAOd,IAAKiD,IAAKD,KACxE,yBAAK7G,UAAU,wBACb,yBAAK6C,IAAKrB,IAAOC,OAAS,UAAYkD,EAAO/D,OAAQkC,IAAI,YAE3D,yBAAK9C,UAAU,sBACb,uBAAGA,UAAU,uBAAuB2E,EAAOhE,UAC3C,uBAAGX,UAAU,sBAAsB2E,EAAON,iBAK3CvC,I,2CAGa,IAAD,OAEbsH,EAAY5H,IAAOC,OAAS,UAClCC,IAAOC,KAAKyH,EAAW,CACrBxH,KAAM,CACJiC,IAAKhE,KAAKY,MAAM6F,MAAMzC,IACtBU,MAAO1E,KAAKY,MAAM6F,MAAM/B,SAEzB1C,MAAK,SAAAC,GACa,MAAfA,EAAIG,QACNG,MAAM,8FAENE,eAAe+D,WAAW,YAC1B,EAAK5F,MAAMgC,QAAQC,KAAK,MAExB,EAAKjC,MAAM6F,MAAM+C,cAAcvH,EAAIgE,c,kCAK5B,IAAD,OACJnB,EAAS9E,KAAKyJ,MAAMtI,MACxBuI,EAAe/H,IAAOC,OAAS,YAC/BC,IAAOC,KAAK4H,EAAc,CACxB3H,KAAM,CACJiC,IAAKhE,KAAKY,MAAM6F,MAAMzC,IACtBU,MAAO1E,KAAKY,MAAM6F,MAAM/B,MACxBI,YAED9C,MAAK,SAAAC,GACa,MAAfA,EAAIG,QACNG,MAAM,8FAENE,eAAe+D,WAAW,YAC1B,EAAK5F,MAAMgC,QAAQC,KAAK,MAEL,MAAfZ,EAAIG,QACNG,MAAM,yCACN,EAAK3B,MAAM6F,MAAMkD,UAAU1H,EAAIgE,UAE/B1D,MAAM,qEAAgBN,EAAIO,c,+BAM1B,IAAD,OACP,OACE,yBAAKrC,UAAU,mBACb,wBAAIA,UAAU,yBAAd,gBAGA,yBAAKA,UAAU,sBACb,2BAAO+C,KAAK,OAAOC,KAAK,UAAUE,YAAY,2DAAmBD,IAAK,SAAAA,GAAG,OAAI,EAAKqG,MAAQrG,KAC1F,4BAAQhD,QAAS,kBAAM,EAAKuJ,cAA5B,MAEF,yBAAKxJ,UAAU,wBACL,EAAKyJ,0B,GA7EGpJ,e,OCApBqJ,G,OAFLnJ,YAAO,Q,GACPC,Y,mLAEUqD,EAAKlD,EAAUC,GACff,KAAKY,MAAM6F,MAAMxC,YAAYD,IAChChE,KAAKY,MAAM6F,MAAMd,UAAU3B,GAC7BhE,KAAKY,MAAM6F,MAAMM,gBAAgB/C,EAAKlD,EAAUC,K,gCAG1CA,GACR,OAAOY,IAAOC,OAAS,UAAYb,I,+BAG3B,IAEJwD,EAFG,OACDP,EAAMhE,KAAKY,MAAMgI,MAAMC,OAAOpE,GAQpC,OANKzE,KAAKY,MAAM6F,MAAMzB,UAAUhB,KAG5BO,EAAOvE,KAAKY,MAAM6F,MAAMzB,UAAUhB,IAEtC3B,QAAQC,IAAIiC,GAEV,yBAAKpE,UAAU,uBACb,uBAAGA,UAAU,wBAAb,4BACA,yBAAKA,UAAU,4BACb,yBAAKA,UAAU,yBACb,yBAAK6C,IAAKhD,KAAK0H,UAAUnD,EAAKxD,QAASkC,IAAI,YAE7C,yBAAK9C,UAAU,uBACb,wBAAIA,UAAU,2BAA2BoE,EAAKzD,UAC9C,uBAAGX,UAAU,0BAAb,4BAAiDoE,EAAKtD,UAEtD,uBAAGd,UAAU,4BAAb,qBAA4CoE,EAAKC,UAAYD,EAAKC,UAAY,UAE9E,kBAAC,IAAD,CACErE,UAAU,sBACVoD,GAAI,gBAAkBgB,EAAKP,IAC3B5D,QAAS,kBAAM,EAAKqH,SAASlD,EAAKP,IAAKO,EAAKzD,SAAUyD,EAAKxD,UAH7D,uB,GAjCcP,e,OA+CXgD,cAAWqG,GChDpBC,G,OAFLpJ,YAAO,Q,GACPC,Y,wLAEgB,IAAD,OACNG,EAAWd,KAAKc,SAASK,MAC7BuC,EAAO1D,KAAK0D,KAAKvC,MACjBqD,EAAYxE,KAAKwE,UAAUrD,MAHjB,EAKmBnB,KAAKY,MAAM6F,MAAlC1F,EALI,EAKJA,OAAQ2D,EALJ,EAKIA,MAAOV,EALX,EAKWA,IAEvB,GAAiB,KAAblD,GAA4B,KAAT4C,EAAvB,CAKA,GAAI1D,KAAK+J,aAAaC,MAAMrC,OAAQ,CAElC,GAAI3H,KAAK+J,aAAaC,MAAM,GAAGC,KAAO,KAAO,KAAO,EAElD,YADA1H,MAAM,gIAIR,IAAM2H,EAAO,IAAIC,SACjBD,EAAKE,OAAO,SAAUpK,KAAK+J,aAAaC,MAAM,IAC9CE,EAAKE,OAAO,MAAOpK,KAAKY,MAAM6F,MAAMzC,KACpCkG,EAAKE,OAAO,QAASpK,KAAKY,MAAM6F,MAAM/B,OACtC2F,MAAMrK,KAAKY,MAAM6F,MAAM5B,IAAI,gBAAiB,CAC1CyF,OAAQ,OACRC,QAAS,GACTC,KAAMN,IACLlI,MAAK,SAAAC,GAAG,OAAIA,EAAIwI,UAAQzI,MAAK,SAAAC,GAC9B,GAAmB,MAAfA,EAAIG,OACNG,MAAM,kFAENE,eAAe+D,WAAW,YAC1B,EAAK5F,MAAMgC,QAAQC,KAAK,UAExB,GAAmB,MAAfZ,EAAIG,OAAgB,CACtB,IAAMsI,EAAU,EAAKX,aAAaC,MAAM,GAClC7F,EAAMxE,OAAOgL,IAAIC,gBAAgBF,GAEvC,EAAK9J,MAAM6F,MAAMoE,aAAa1G,GAAK,OAM3CnE,KAAKY,MAAM6F,MAAMqE,YAAY,CAC3BhK,WACA4C,OACAc,YACAzD,SACA2D,QACAD,GAAIT,IAGNnC,IACGC,KAAK9B,KAAKY,MAAM6F,MAAM5B,IAAI,iBAAkB,CAC3C9C,KAAM,CACJjB,WACA4C,OACAc,YACAR,MACAU,WAGH1C,MAAK,SAAAC,GACe,MAAfA,EAAIG,QACNG,MAAM,kFAENE,eAAe+D,WAAW,YAC1B,EAAK5F,MAAMgC,QAAQC,KAAK,MAEL,MAAfZ,EAAIG,QAAgBG,MAAM,0CA9DlCA,MAAM,kE,qCAoERvC,KAAK+J,aAAagB,U,uCAGH7C,GACf,IAAMwC,EAAU1K,KAAK+J,aAAaC,MAAM,GAClC7F,EAAMxE,OAAOgL,IAAIC,gBAAgBF,GACvC1K,KAAKe,OAAOiK,aAAa,MAAO7G,K,+BAGxB,IAAD,OACP,OACE,yBAAKhE,UAAU,uBACb,uBAAGA,UAAU,6BAAb,wCACA,yBAAKA,UAAU,iCACb,yBAAKA,UAAU,8BACb,yBACE6C,IAAKhD,KAAKY,MAAM6F,MAAM1F,OACtBkC,IAAI,YACJ7C,QAAS,WACP,EAAK6K,gBAEP7H,IAAK,SAAAA,GAAG,OAAK,EAAKrC,OAASqC,GAC3BsD,MAAM,0CAGV,0BACEtD,IAAK,SAAAA,GAAG,OAAK,EAAK8H,WAAa9H,GAC/BkD,OAAQtG,KAAKY,MAAM6F,MAAM5B,IAAI,gBAC7ByF,OAAO,OACPa,QAAQ,uBAER,2BACEjI,KAAK,OACLC,KAAK,gBACLC,IAAK,SAAAA,GAAG,OAAK,EAAK2G,aAAe3G,GACjCwE,MAAO,CACLC,QAAS,QAEXuD,OAAO,UACPC,SAAU,SAAAnD,GAAC,OAAI,EAAKoD,iBAAiBpD,OAIzC,yBAAK/H,UAAU,4BACb,8CACA,2BACE+C,KAAK,OACLqI,aAAcvL,KAAKY,MAAM6F,MAAM3F,SAC/BsC,IAAK,SAAAA,GAAG,OAAK,EAAKtC,SAAWsC,MAIjC,yBAAKjD,UAAU,4BACb,8CACA,2BACE+C,KAAK,OACLqI,aAAcvL,KAAKY,MAAM6F,MAAM/C,KAC/BN,IAAK,SAAAA,GAAG,OAAK,EAAKM,KAAON,MAI7B,yBAAKjD,UAAU,4BACb,8CACA,2BACE+C,KAAK,OACLqI,aAAcvL,KAAKY,MAAM6F,MAAMjC,UAC/BpB,IAAK,SAAAA,GAAG,OAAK,EAAKoB,UAAYpB,MAIlC,yBAAKjD,UAAU,8BACb,4BACEA,UAAU,6BACVC,QAAS,kBAAM,EAAKoL,gBAFtB,uB,GApJchL,e,OAiKXgD,cAAWsG,GCpJpB2B,EAFL/K,YAAO,Q,GACPC,Y,mMAE2B,IAAD,OACvBX,KAAK0L,GAAK,IAAIC,UAAUhK,IAAO2C,OAC/B,IAAMoH,EAAK1L,KAAK0L,GAEhBA,EAAGE,iBAAiB,QAAQ,WAC1BvJ,QAAQC,IAAI,qBACZoJ,EAAGG,KAAK3J,KAAKS,UAAU,CACrBqB,IAAK,EAAKpD,MAAM6F,MAAMzC,IACtBU,MAAO,EAAK9D,MAAM6F,MAAM/B,YAI5BgH,EAAGE,iBAAiB,WAAW,SAAC1F,GAE9B,QADAA,EAAMhE,KAAKC,MAAM+D,EAAInE,OACTmB,MACV,IAAK,UACH,EAAKtC,MAAM6F,MAAMqF,eAAe5F,EAAIL,KAAMK,EAAID,aAQpDyF,EAAGE,iBAAiB,SAAS,WAC3BrJ,MAAM,yEACN,EAAK3B,MAAMgC,QAAQC,KAAK,U,2CAIN,IAAD,OACuB,MAAtCJ,eAAesJ,QAAQ,YACzB/L,KAAKY,MAAMgC,QAAQC,KAAK,KAExB7C,KAAKY,MAAM6F,MAAMqE,YACf5I,KAAKC,MAAMM,eAAesJ,QAAQ,cAItC/L,KAAKgM,yBAGL,IAAMzC,EAAY5H,IAAOC,OAAS,UAClCC,IAAOC,KAAKyH,EAAW,CACrBxH,KAAM,CACJiC,IAAKhE,KAAKY,MAAM6F,MAAMzC,IACtBU,MAAO1E,KAAKY,MAAM6F,MAAM/B,SAEzB1C,MAAK,SAAAC,GACa,MAAfA,EAAIG,QACNG,MAAM,8FAENE,eAAe+D,WAAW,YAC1B,EAAK5F,MAAMgC,QAAQC,KAAK,MAExB,EAAKjC,MAAM6F,MAAM+C,cAAcvH,EAAIgE,YAIvCjG,KAAKY,MAAM6F,MAAMyC,sB,6CAGjBlJ,KAAK0L,GAAG9L,U,0CAIRD,OAAOE,cAAcC,mBAAmBgD,QAAQ,IAAK,O,+BAIrD,OACE,yBAAK3C,UAAU,mBACb,kBAAC,IAAD,CAAYyC,QAAS5C,KAAKY,MAAMgC,SAC9B,kBAAC,IAAD,CAAOqJ,KAAK,QACV,kBAAC,EAAD,OAGF,kBAAC,IAAD,CAAOA,KAAK,gBACV,kBAAC,EAAD,OAGF,kBAAC,IAAD,CAAOA,KAAK,oBACV,kBAAC,EAAD,OAGF,kBAAC,IAAD,CAAOA,KAAK,gBACV,kBAAC,EAAD,OAGF,kBAAC,IAAD,CAAOA,KAAK,oBACV,kBAAC,EAAD,OAGF,kBAAC,IAAD,CAAOA,KAAK,oBACV,kBAAC,EAAD,MACA,kBAAC,EAAD,a,GAhGWzL,e,MAwGRgD,gBAAWiI,I,gHC9H1B,urCAkBAS,KAAK,qDAEL,IAAMtJ,QAAUuJ,iDACZ1F,MAAQ,IAAI1C,wCAEhBqI,iDAASC,OACL,kEAAKlM,UAAU,SAASsE,GAAG,UACvB,2DAAC,0CAAD,CAAUgC,MAAOA,OACb,2DAAC,qDAAD,MACA,2DAAC,gDAAD,CAAY7D,QAASA,SACjB,2DAAC,4CAAD,CAAOqJ,KAAK,IAAIK,OAAK,GACjB,2DAAC,qDAAD,OAEJ,2DAAC,4CAAD,CAAOL,KAAK,YAAYK,OAAK,GACzB,2DAAC,wDAAD,OAEJ,2DAAC,4CAAD,CAAOL,KAAK,QACR,2DAAC,qDAAD,UAKjBjE,SAASuE,eAAe,U,qTCxCZ,KACX3K,OAAQ,8BACR0C,MAAO,oC","file":"static/js/main.a359648f.chunk.js","sourcesContent":["module.exports = \"data:image/jpeg;base64,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\"","import React, { Component } from 'react';\r\n\r\nimport '../styles/TopButton.styl';\r\n\r\nexport default class TopButton extends Component {\r\n    maximized = false;\r\n\r\n    closeWindow() {\r\n        window.close();\r\n    }\r\n\r\n    minimizeWindow() {\r\n        window.browserWindow.getCurrentWindow().minimize();\r\n    }\r\n\r\n    maximizeWindow() {\r\n        if (this.maximized)\r\n            window.browserWindow.getCurrentWindow().unmaximize();\r\n        else\r\n            window.browserWindow.getCurrentWindow().maximize();\r\n        this.maximized = !this.maximized;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='mechat-top-button-container'>\r\n                <button className='mechat-top-button-exit' onClick={() => this.closeWindow()} />\r\n                <button className='mechat-top-button-minimize' onClick={() => this.minimizeWindow()} />\r\n                <button className='mechat-top-button-maxmize' onClick={() => this.maximizeWindow()} />\r\n            </div>\r\n        );\r\n    }\r\n}","import React, { Component } from \"react\";\r\nimport { Link, withRouter } from \"react-router-dom\";\r\n\r\nimport crypto from \"crypto\";\r\nimport honoka from \"honoka\";\r\n\r\nimport \"../styles/LoginPage.styl\";\r\nimport config from \"../config\";\r\nimport { inject, observer } from \"mobx-react\";\r\n\r\n@inject('store')\r\n@observer\r\nclass LoginPage extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      nickname: \"MeChat\",\r\n      avatar: require(\"../images/defaultAvatar.jpg\")\r\n    };\r\n  }\r\n\r\n  login() {\r\n    const username = this.usernameInput.value,\r\n      password = crypto\r\n        .createHash(\"md5\")\r\n        .update(this.passwordInput.value)\r\n        .digest(\"hex\");\r\n    const loginUri = config.apiUrl + \"login\";\r\n    honoka\r\n      .post(loginUri, {\r\n        data: {\r\n          username,\r\n          password\r\n        }\r\n      })\r\n      .then(res => {\r\n        if (typeof res === \"string\") res = JSON.parse(res);\r\n\r\n        if (res.status !== 200) {\r\n          console.log(res, typeof res);\r\n          alert(\"登录失败，错误信息：\" + res.message);\r\n        } else {\r\n          res.avatar = config.apiUrl + 'avatar/' + res.avatar;\r\n          sessionStorage.setItem(\"userInfo\", JSON.stringify(res));\r\n          this.props.history.push('/app/message');\r\n        }\r\n      });\r\n  }\r\n\r\n  componentDidMount() {\r\n      window.browserWindow.getCurrentWindow().setSize(300, 500);\r\n      this.usernameInput.focus();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"mechat-loginpage\">\r\n        <div className=\"mechat-login-personinfo\">\r\n          <p className=\"mechat-login-avatar-container\">\r\n            <img\r\n              className=\"mechat-login-avatar\"\r\n              src={this.state.avatar}\r\n              alt=\"avatar\"\r\n            />\r\n          </p>\r\n          <p className=\"mechat-login-nickname\">{this.state.nickname}</p>\r\n        </div>\r\n        <input\r\n          type=\"text\"\r\n          name=\"username\"\r\n          className=\"mechat-login-input-username\"\r\n          ref={ref => (this.usernameInput = ref)}\r\n          placeholder=\"用户名\"\r\n        />\r\n        <input\r\n          type=\"password\"\r\n          name=\"password\"\r\n          className=\"mechat-login-input-password\"\r\n          ref={ref => (this.passwordInput = ref)}\r\n          placeholder=\"密码\"\r\n        />\r\n        <div className=\"mechat-login-actions\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => this.login()}\r\n            className=\"mechat-login-button\"\r\n          >\r\n            登录\r\n          </button>\r\n          <Link to=\"/register\" className=\"mechat-login-register\">\r\n            没有账号？注册一个\r\n          </Link>\r\n        </div>\r\n        <div className=\"mechat-login-copyright\">\r\n          &copy;2019 XMU CS - Data Structure Experiment / by Yume Maruyama\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(LoginPage);","import React, { Component } from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\n\nimport crypto from \"crypto\";\nimport honoka from \"honoka\";\n\nimport \"../styles/RegisterPage.styl\";\nimport config from '../config';\n\nclass RegisterPage extends Component {\n  register() {\n    const username = this.usernameInput.value,\n      password = crypto.createHash('md5').update(this.passwordInput.value).digest('hex'),\n      mail = this.mailInput.value,\n      nickname = this.nicknameInput.value;\n    \n    const regUri = config.apiUrl + 'register';\n    honoka.post(regUri, {\n      data: {\n        username,\n        password,\n        mail,\n        nickname\n      }\n    }).then(res => {\n      if (typeof res == 'string')\n        res = JSON.parse(res);\n        if (res.status !== 200) {\n          console.log(res, typeof res);\n          alert(\"注册失败，错误信息：\" + res.message);\n        } else {\n          alert(\"注册成功~将回到登录页面。\");\n          this.props.history.push('/');\n        }\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"mechat-register-page\">\n        <h1 className=\"mechat-register-title\">\n          注册 MeChat\n        </h1>\n        <input\n          type=\"text\"\n          name=\"username\"\n          className=\"mechat-register-input-username\"\n          ref={ref => (this.usernameInput = ref)}\n          placeholder=\"登录用户名\"\n        />\n        <input\n          type=\"password\"\n          name=\"password\"\n          className=\"mechat-register-input-password\"\n          ref={ref => (this.passwordInput = ref)}\n          placeholder=\"密码\"\n        />\n        <input\n          type=\"mail\"\n          name=\"mail\"\n          className=\"mechat-register-input-mail\"\n          ref={ref => (this.mailInput = ref)}\n          placeholder=\"邮箱\"\n        />\n        <input\n          type=\"text\"\n          name=\"nickname\"\n          className=\"mechat-register-input-nickname\"\n          ref={ref => (this.nicknameInput = ref)}\n          placeholder=\"昵称\"\n        />\n\n        <div className=\"mechat-register-actions\">\n          <button\n            type=\"button\"\n            onClick={() => this.register()}\n            className=\"mechat-register-button\"\n          >\n            注册\n          </button>\n          <Link to=\"/\" className=\"mechat-register-login\">\n            已有账号？登录\n          </Link>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(RegisterPage);\n","import { observable, action, get } from 'mobx';\r\n\r\nimport config from '../config';\r\nimport honoka from 'honoka';\r\n\r\nexport default class Model {\r\n    @observable nickname = null;\r\n    @observable username = null;\r\n    @observable uid = null;\r\n    @observable mail = null;\r\n    @observable signature = null;\r\n    @observable avatar = require('../images/defaultAvatar.jpg');\r\n    @observable token = null;\r\n    @observable friends = [];\r\n    @observable groups = [];\r\n\r\n    @observable socketLink = null;\r\n    @observable messageList = {};\r\n    @observable currentDialog = null;\r\n    @observable chattingWith = {\r\n        uid: null,\r\n        nickanme: null,\r\n        avatar: null\r\n    };\r\n    @observable uidKeyMap = {};\r\n    @observable fetching = false;\r\n\r\n    @observable configUrl = {\r\n        httpUrl: config.apiUrl,\r\n        wsUrl: config.wsUrl\r\n    };\r\n \r\n    @get\r\n    getRawChats(uid) {\r\n        if (!this.messageList[uid]) {\r\n            return {};\r\n        }\r\n        return this.messageList[uid].records;\r\n    }\r\n\r\n    @get\r\n    API(uri) {\r\n        return this.configUrl.httpUrl + uri;\r\n    }\r\n\r\n    @get\r\n    wsAPI(uri) {\r\n        return this.configUrl.wsUrl + uri;\r\n    }\r\n\r\n    @action\r\n    setUserInfo(user) {\r\n        this.nickname = user.nickname;\r\n        this.username = user.username;\r\n        this.signature = user.signature;\r\n        this.uid = user.id;\r\n        this.avatar = user.avatar;\r\n        this.token = user.token;\r\n        this.mail = user.mail;\r\n    } \r\n\r\n    @action\r\n    setNewAvatar(url, flag) {\r\n        if (!flag)\r\n            this.avatar = this.API('avatar/') + url;\r\n        else\r\n            this.avatar = url;\r\n    }\r\n\r\n    @action\r\n    addFriend(friend) {\r\n        this.friends.push(friend);\r\n        this.uidKeyMap[friend.uid] = friend;\r\n    }\r\n\r\n    @action\r\n    updateFriends(friends) {\r\n        this.friends = friends;\r\n        friends.forEach(friend => {\r\n            this.uidKeyMap[friend.uid] = friend;\r\n            if (this.messageList[friend.uid]) {\r\n                this.messageList[friend.uid].nickname = friend.nickname;\r\n                this.messageList[friend.uid].avatar = friend.avatar;\r\n            }\r\n        });\r\n    }\r\n\r\n    @action\r\n    connectSocketLink(socket) {\r\n        this.socketLink = socket;\r\n    }\r\n\r\n    @action\r\n    addDialog(uid) {\r\n        this.messageList[uid] = {\r\n            with: uid,\r\n            nickname: this.uidKeyMap[uid].nickname,\r\n            avatar: this.uidKeyMap[uid].avatar,\r\n            last: Date.parse(new Date()),\r\n            read: false,\r\n            records: []\r\n        };\r\n    }\r\n\r\n    @action\r\n    replaceDialog(dialog) {\r\n        this.messageList = dialog;\r\n    }\r\n\r\n    @action\r\n    setChattingWith(uid, nickname, avatar) {\r\n        this.chattingWith = {\r\n            uid,\r\n            nickname,\r\n            avatar\r\n        };\r\n    }\r\n\r\n    @action\r\n    sendMessage(uid, content, type) {\r\n        if (!this.messageList[uid]) {\r\n            this.addDialog(uid);\r\n        }\r\n        const timestamp = Date.parse(new Date());\r\n        this.messageList[uid].records.push({\r\n            from: 1,\r\n            timestamp: timestamp,\r\n            type,\r\n            content\r\n        });\r\n        this.messageList[uid].last = timestamp;\r\n        // todo: sort message list\r\n    }\r\n\r\n    @action\r\n    setRead(uid) {\r\n        this.messageList[uid].read = true;\r\n    }\r\n\r\n    @action\r\n    reloadMessageList() {\r\n        this.fetching = true;\r\n        const MessageListUri = config.apiUrl + 'getMessageList';\r\n        honoka.post(MessageListUri, {\r\n          data: {\r\n            uid: this.uid,\r\n            token: this.token\r\n          }\r\n        }).then(res => {\r\n          if (res.status !== 200) {\r\n            alert(\"拉取消息列表失败 :(\");\r\n            return;\r\n          }\r\n          this.replaceDialog(res.payload);\r\n          this.fetching = false;\r\n        });\r\n    }\r\n\r\n    @action\r\n    pushNewMessage(from, msg) {\r\n        console.log(from, this.messageList, this.uidKeyMap);\r\n        if (!this.messageList[from]) {\r\n            this.addDialog(from);\r\n        }\r\n        this.messageList[from].read = false;\r\n        this.messageList[from].records.push(msg);\r\n    }\r\n}","import React, { Component } from 'react';\r\nimport { withRouter } from 'react-router';\r\nimport { NavLink, Link } from 'react-router-dom';\r\nimport { inject, observer } from 'mobx-react';\r\n\r\n@inject('store')\r\n@observer\r\nclass Navbar extends Component {\r\n    logOut() {\r\n        sessionStorage.removeItem('userInfo');\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"mechat-mainpage-nav\">\r\n            <div className=\"mechat-nav-avatar-container\">\r\n              <Link to={'/app/editProfile'}>\r\n                <img\r\n                  className=\"mechat-nav-avatar\"\r\n                  alt=\"avatar\"\r\n                  src={this.props.store.avatar}\r\n                  title={this.props.store.nickname}\r\n                />\r\n              </Link>\r\n            </div>\r\n            <NavLink to=\"/app/message\" title=\"消息\">\r\n              <i className=\"fa fa-comments-o\"></i>\r\n            </NavLink>\r\n            <NavLink to=\"/app/friends\" title=\"通讯录\">\r\n              <i className=\"fa fa-address-book-o\"></i>\r\n            </NavLink>\r\n            <Link to=\"/\" title=\"注销\" onClick={() => this.logOut()}>\r\n              <i className=\"fa fa-mail-reply\"></i>\r\n            </Link>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(Navbar);","import React, { Component } from 'react';\r\nimport { inject, observer } from 'mobx-react';\r\nimport { NavLink } from 'react-router-dom';\r\nimport config from '../config';\r\n\r\n@inject('store')\r\n@observer\r\nclass MessageList extends Component {\r\n  getAvatar(avatar) {\r\n    return config.apiUrl + 'avatar/' + avatar;\r\n  }\r\n  \r\n  chatWith(item) {\r\n    this.props.store.setRead(item.with);\r\n    this.props.store.setChattingWith(item.with, item.nickname, item.avatar);\r\n  }\r\n\r\n  renderMessageList() {\r\n    const res = [];\r\n    let cnt = 0;\r\n\r\n    for (const key in this.props.store.messageList) {\r\n      const item = this.props.store.messageList[key],\r\n        date = new Date(item.last),\r\n        today = new Date();\r\n      \r\n      let dateStr = '';\r\n      if (date.getMonth() === today.getMonth() && date.getDate() === today.getDate()) {\r\n        dateStr += (date.getHours() < 10 ? '0' + date.getHours() : date.getHours());\r\n        dateStr += ':';\r\n        dateStr +=(date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes());\r\n      }\r\n\r\n      res.push(\r\n        <NavLink className=\"mechat-dialog\" to={\"/app/message/\" + item.with} key={cnt++} onClick={() => this.chatWith(item)}>\r\n          <div className=\"mechat-dialog-avatar\">\r\n            <img src={this.getAvatar(item.avatar)} alt=\"avatar\" />\r\n            {(item.read ? null : <span className={'mechat-dialog-new'}></span>)}\r\n          </div>\r\n          <div className=\"mechat-dialog-meta\">\r\n            <p className=\"mechat-dialog-title\">{item.nickname}</p>\r\n            <p className=\"mechat-dialog-mess\">{item.records.length ? item.records[item.records.length-1].content : ''}</p>\r\n            <span className=\"mechat-dialog-time\">{dateStr}</span>\r\n          </div>\r\n      </NavLink>\r\n      )\r\n    }\r\n\r\n    return res;\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"mechat-messages\">\r\n        <h1 className=\"mechat-messages-title\">\r\n          消息列表\r\n        </h1>\r\n        <div className=\"mechat-messages-fetching\" style={{\r\n          display: this.props.store.fetching ? 'block' : 'none'\r\n        }}>\r\n          正在更新消息列表...\r\n        </div>\r\n        <div className=\"mechat-messages-list\">\r\n          {(() => this.renderMessageList())()}\r\n        </div>         \r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MessageList;","import React, { Component } from \"react\";\r\nimport { inject, observer } from \"mobx-react\";\r\n\r\nimport \"../styles/ChatPage.styl\";\r\nimport { withRouter } from \"react-router\";\r\nimport config from \"../config\";\r\nimport honoka from \"honoka\";\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass ChatPage extends Component {\r\n  getAvatar(avatar) {\r\n    return config.apiUrl + \"avatar/\" + avatar;\r\n  }\r\n\r\n  componentDidMount() {\r\n    document.onkeydown = (e) => {\r\n      const keycode = e.which ? e.which : e.keyCode;\r\n      if (e.ctrlKey && keycode === 13) {\r\n        this.sendMessage();\r\n      }\r\n    };\r\n\r\n    this.chatContent.scrollTop = this.chatContent.scrollHeight;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.onkeydown = null;\r\n  }\r\n\r\n  renderChatContent() {\r\n    const chats = [],\r\n      uid = this.props.match.params.id,\r\n      rawChats = this.props.store.getRawChats(uid),\r\n      myAvatar = this.props.store.avatar;\r\n\r\n    let cnt = 0;\r\n    if (!rawChats.forEach) {\r\n      this.props.store.reloadMessageList();\r\n      return;\r\n    }\r\n\r\n    rawChats.forEach(chat => {\r\n      chats.push(\r\n        <div\r\n          className={\"mechat-chat-item\" + (chat.from === 1 ? \" from-me\" : \"\")}\r\n          key={cnt++}\r\n        >\r\n          <div className=\"mechat-chat-item-avatar\">\r\n            <img\r\n              src={\r\n                chat.from === 0\r\n                  ? this.getAvatar(this.props.store.chattingWith.avatar)\r\n                  : myAvatar\r\n              }\r\n              alt=\"avatar\"\r\n            />\r\n          </div>\r\n          <div className=\"mechat-chat-item-blob\">{chat.content}</div>\r\n        </div>\r\n      );\r\n    });\r\n    return chats;\r\n  }\r\n\r\n  sendMessage() {\r\n    const text = this.textarea.value,\r\n      uid = this.props.match.params.id;\r\n    this.props.store.sendMessage(uid, text, 'string');\r\n    this.props.store.setRead(uid);\r\n    this.textarea.value = '';\r\n\r\n    this.chatContent.scrollTop = this.chatContent.scrollHeight;\r\n\r\n    honoka.post(config.apiUrl + 'sendMessage', {\r\n      data: {\r\n        uid: this.props.store.uid,\r\n        to: uid,\r\n        type: 'string',\r\n        content: text,\r\n        token: this.props.store.token\r\n      }\r\n    }).then(res => {\r\n      if (res.status !== 200) {\r\n        alert('发送信息失败，原因可能是：' + res.message);\r\n        console.log(res);\r\n        return;\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"mechat-chat-page\">\r\n        <div className=\"mechat-chat-title\">{this.props.store.chattingWith.nickname}</div>\r\n\r\n        <div className=\"mechat-chat-content\" ref={ref => this.chatContent = ref}>\r\n          {(() => this.renderChatContent())()}\r\n        </div>\r\n\r\n        <div className=\"mechat-chat-textarea\">\r\n          <textarea name=\"chat-text\" ref={ref => this.textarea = ref}></textarea>\r\n          <button className=\"mechat-chat-send\" onClick={() => this.sendMessage()}>发送</button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(ChatPage);\r\n","import React, { Component } from 'react';\r\nimport { inject, observer } from 'mobx-react';\r\nimport { NavLink } from 'react-router-dom';\r\nimport honoka from 'honoka';\r\n\r\nimport '../styles/FriendsList.styl';\r\nimport config from '../config';\r\n\r\n@inject('store')\r\n@observer\r\nclass FriendsList extends Component {\r\n  renderFriendsList() {\r\n    const res = [];\r\n    let cnt = 0;\r\n    this.props.store.friends.forEach(friend => {\r\n      res.push(\r\n        <NavLink className=\"mechat-dialog\" to={\"/app/friends/\" + friend.uid} key={cnt++}>\r\n          <div className=\"mechat-dialog-avatar\">\r\n            <img src={config.apiUrl + 'avatar/' + friend.avatar} alt=\"avatar\" />\r\n          </div>\r\n          <div className=\"mechat-dialog-meta\">\r\n            <p className=\"mechat-dialog-title\">{friend.nickname}</p>\r\n            <p className=\"mechat-dialog-mess\">{friend.signature}</p>\r\n          </div>\r\n        </NavLink>\r\n      );\r\n    });\r\n    return res;\r\n  }\r\n\r\n  componentWillMount() {\r\n    // get friends list\r\n    const friendUri = config.apiUrl + 'friends';\r\n    honoka.post(friendUri, {\r\n      data: {\r\n        uid: this.props.store.uid,\r\n        token: this.props.store.token\r\n      }\r\n    }).then(res => {\r\n      if (res.status !== 200) {\r\n        alert(\"身份认证出现问题，请重新登录。\");\r\n\r\n        sessionStorage.removeItem('userInfo');\r\n        this.props.history.push('/');\r\n      } else {\r\n        this.props.store.updateFriends(res.payload);\r\n      }\r\n    });    \r\n  }\r\n  \r\n  addFriend() {\r\n    const friend = this.input.value,\r\n      addFriendUrl = config.apiUrl + 'addFriend';\r\n      honoka.post(addFriendUrl, {\r\n        data: {\r\n          uid: this.props.store.uid,\r\n          token: this.props.store.token,\r\n          friend\r\n        }\r\n      }).then(res => {\r\n        if (res.status === 403) {\r\n          alert(\"身份认证出现问题，请重新登录。\");\r\n  \r\n          sessionStorage.removeItem('userInfo');\r\n          this.props.history.push('/');\r\n        } else {\r\n          if (res.status === 200) {\r\n            alert(\"添加好友成功.\");\r\n            this.props.store.addFriend(res.payload);\r\n          } else {\r\n            alert(\"添加好友失败，原因是：\" + res.message);\r\n          }\r\n        }\r\n      }); \r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"mechat-messages\">\r\n        <h1 className=\"mechat-messages-title\">\r\n          朋友\r\n        </h1>\r\n        <div className=\"mechat-friends-add\">\r\n          <input type=\"text\" name=\"friends\" placeholder=\"搜索 MeChat 账号添加好友\" ref={ref => this.input = ref}/>\r\n          <button onClick={() => this.addFriend()}>+</button>\r\n        </div>\r\n        <div className=\"mechat-messages-list\">\r\n          {(() => this.renderFriendsList())()}  \r\n        </div>         \r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default FriendsList;","import React, { Component } from \"react\";\r\nimport { inject, observer } from \"mobx-react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport \"../styles/ProfilePage.styl\";\r\nimport config from \"../config\";\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass ProfilePage extends Component {  \r\n  chatWith(uid, nickname, avatar) {\r\n      if (!this.props.store.messageList[uid])\r\n        this.props.store.addDialog(uid);\r\n      this.props.store.setChattingWith(uid, nickname, avatar);\r\n  }\r\n  \r\n  getAvatar(avatar) {\r\n    return config.apiUrl + \"avatar/\" + avatar;\r\n  }\r\n\r\n  render() {\r\n    const uid = this.props.match.params.id;\r\n    let user;\r\n    if (!this.props.store.uidKeyMap[uid]) {\r\n\r\n    } else {\r\n        user = this.props.store.uidKeyMap[uid];\r\n    }\r\n    console.log(user);\r\n    return (\r\n      <div className=\"mechat-profile-page\">\r\n        <p className=\"mechat-profile-title\">个人资料</p>\r\n        <div className=\"mechat-profile-container\">\r\n          <div className=\"mechat-profile-avatar\">\r\n            <img src={this.getAvatar(user.avatar)} alt=\"avatar\" />\r\n          </div>\r\n          <div className=\"mechat-profile-meta\">\r\n            <h1 className=\"mechat-profile-nickname\">{user.nickname}</h1>\r\n            <p className=\"mechat-profile-account\">MeChat 账号：{user.username}</p>\r\n\r\n            <p className=\"mechat-profile-signature\">签名：{user.signature ? user.signature : '无'}</p>\r\n\r\n            <Link\r\n              className=\"mechat-profile-chat\"\r\n              to={\"/app/message/\" + user.uid}\r\n              onClick={() => this.chatWith(user.uid, user.nickname, user.avatar)}\r\n            >\r\n              聊天\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(ProfilePage);\r\n","import React, { Component } from \"react\";\r\nimport { inject, observer } from \"mobx-react\";\r\nimport { withRouter } from \"react-router\";\r\n\r\nimport \"../styles/ProfileEdit.styl\";\r\nimport honoka from \"honoka\";\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass ProfileEdit extends Component {\r\n  editProfile() {\r\n    const nickname = this.nickname.value,\r\n      mail = this.mail.value,\r\n      signature = this.signature.value;\r\n\r\n    const { avatar, token, uid } = this.props.store;\r\n\r\n    if (nickname === \"\" || mail === \"\") {\r\n      alert(\"昵称和邮箱不许留空！\");\r\n      return;\r\n    }\r\n\r\n    if (this.avatarUpload.files.length) {\r\n\r\n      if (this.avatarUpload.files[0].size / 1024 / 1024 > 1) {\r\n        alert(\"上传的头像大小不能超过 1MB，请重新选择图片。\");\r\n        return;\r\n      }\r\n      \r\n      const form = new FormData();\r\n      form.append('avatar', this.avatarUpload.files[0]);\r\n      form.append('uid', this.props.store.uid);\r\n      form.append('token', this.props.store.token);\r\n      fetch(this.props.store.API('uploadAvatar'), {\r\n        method: 'POST',\r\n        headers: {},\r\n        body: form\r\n      }).then(res => res.json()).then(res => {\r\n        if (res.status === 403) {\r\n          alert(\"身份验证失败，请重新登录。\");\r\n\r\n          sessionStorage.removeItem(\"userInfo\");\r\n          this.props.history.push(\"/\");\r\n        } else {\r\n          if (res.status === 200) {\r\n            const fileObj = this.avatarUpload.files[0];\r\n            const uri = window.URL.createObjectURL(fileObj);\r\n\r\n            this.props.store.setNewAvatar(uri, true);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    this.props.store.setUserInfo({\r\n      nickname,\r\n      mail,\r\n      signature,\r\n      avatar,\r\n      token,\r\n      id: uid\r\n    });\r\n\r\n    honoka\r\n      .post(this.props.store.API(\"updateProfile\"), {\r\n        data: {\r\n          nickname,\r\n          mail,\r\n          signature,\r\n          uid,\r\n          token\r\n        }\r\n      })\r\n      .then(res => {\r\n        if (res.status === 403) {\r\n          alert(\"身份验证失败，请重新登录。\");\r\n\r\n          sessionStorage.removeItem(\"userInfo\");\r\n          this.props.history.push(\"/\");\r\n        } else {\r\n          if (res.status === 200) alert(\"修改成功。\");\r\n        }\r\n      });\r\n  }\r\n\r\n  selectAvatar() {\r\n    this.avatarUpload.click();\r\n  }\r\n\r\n  onFileLoadChange(e) {\r\n    const fileObj = this.avatarUpload.files[0];\r\n    const uri = window.URL.createObjectURL(fileObj);\r\n    this.avatar.setAttribute(\"src\", uri);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"mechat-profile-edit\">\r\n        <p className=\"mechat-profile-edit-title\">修改个人资料</p>\r\n        <div className=\"mechat-profile-edit-container\">\r\n          <div className=\"mechat-profile-edit-avatar\">\r\n            <img\r\n              src={this.props.store.avatar}\r\n              alt=\"my-avatar\"\r\n              onClick={() => {\r\n                this.selectAvatar();\r\n              }}\r\n              ref={ref => (this.avatar = ref)}\r\n              title=\"点击修改头像\"\r\n            ></img>\r\n          </div>\r\n          <form\r\n            ref={ref => (this.uploadForm = ref)}\r\n            action={this.props.store.API(\"uploadAvatar\")}\r\n            method=\"post\"\r\n            encType=\"multipart/form-data\"\r\n          >\r\n            <input\r\n              type=\"file\"\r\n              name=\"avatar-upload\"\r\n              ref={ref => (this.avatarUpload = ref)}\r\n              style={{\r\n                display: \"none\"\r\n              }}\r\n              accept=\"image/*\"\r\n              onChange={e => this.onFileLoadChange(e)}\r\n            />\r\n          </form>\r\n\r\n          <div className=\"mechat-profile-edit-form\">\r\n            <span>昵称</span>\r\n            <input\r\n              type=\"text\"\r\n              defaultValue={this.props.store.nickname}\r\n              ref={ref => (this.nickname = ref)}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"mechat-profile-edit-form\">\r\n            <span>邮箱</span>\r\n            <input\r\n              type=\"text\"\r\n              defaultValue={this.props.store.mail}\r\n              ref={ref => (this.mail = ref)}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"mechat-profile-edit-form\">\r\n            <span>签名</span>\r\n            <input\r\n              type=\"text\"\r\n              defaultValue={this.props.store.signature}\r\n              ref={ref => (this.signature = ref)}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"mechat-profile-edit-action\">\r\n            <button\r\n              className=\"mechat-profile-edit-submit\"\r\n              onClick={() => this.editProfile()}\r\n            >\r\n              修改\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(ProfileEdit);\r\n","import React, { Component } from \"react\";\r\n\r\nimport { Route } from \"react-router\";\r\nimport { HashRouter, withRouter } from \"react-router-dom\";\r\n\r\nimport { inject, observer } from \"mobx-react\";\r\n\r\nimport honoka from 'honoka';\r\n\r\nimport \"../styles/MainPage.styl\";\r\n\r\nimport config from \"../config\";\r\n\r\nimport Navbar from \"./Navbar\";\r\nimport MessageList from './MessageList';\r\nimport ChatPage from './ChatPage';\r\nimport FriendsList from \"./FriendsList\";\r\nimport ProfilePage from \"./ProfilePage\";\r\nimport ProfileEdit from './ProfileEdit';\r\n\r\n@inject(\"store\")\r\n@observer\r\nclass MainPage extends Component {\r\n  createSocketConnection() {\r\n    this.ws = new WebSocket(config.wsUrl);\r\n    const ws = this.ws;\r\n\r\n    ws.addEventListener('open', () => {\r\n      console.log('WebSocket opened.');\r\n      ws.send(JSON.stringify({\r\n        uid: this.props.store.uid,\r\n        token: this.props.store.token\r\n      }));\r\n    });\r\n\r\n    ws.addEventListener('message', (msg) => {\r\n      msg = JSON.parse(msg.data);\r\n      switch (msg.type) {\r\n        case 'message':\r\n          this.props.store.pushNewMessage(msg.from, msg.payload);\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    });\r\n\r\n\r\n    ws.addEventListener('error', () => {\r\n      alert(\"连接错误。返回登录页面...\");\r\n      this.props.history.push('/');\r\n    });\r\n  }\r\n\r\n  componentWillMount() {\r\n    if (sessionStorage.getItem(\"userInfo\") == null)\r\n      this.props.history.push(\"/\");\r\n    else\r\n      this.props.store.setUserInfo(\r\n        JSON.parse(sessionStorage.getItem(\"userInfo\"))\r\n      );\r\n    \r\n    // establish socket connection\r\n    this.createSocketConnection();\r\n\r\n    // get friends list\r\n    const friendUri = config.apiUrl + 'friends';\r\n    honoka.post(friendUri, {\r\n      data: {\r\n        uid: this.props.store.uid,\r\n        token: this.props.store.token\r\n      }\r\n    }).then(res => {\r\n      if (res.status !== 200) {\r\n        alert(\"身份认证出现问题，请重新登录。\");\r\n\r\n        sessionStorage.removeItem('userInfo');\r\n        this.props.history.push('/');\r\n      } else {\r\n        this.props.store.updateFriends(res.payload);\r\n      }\r\n    });\r\n\r\n    this.props.store.reloadMessageList();\r\n  }\r\n  componentWillUnmount() {\r\n    this.ws.close();\r\n  }\r\n\r\n  componentDidMount() {\r\n    window.browserWindow.getCurrentWindow().setSize(800, 600);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"mechat-mainpage\">\r\n        <HashRouter history={this.props.history}>\r\n          <Route path='/app'>\r\n            <Navbar />\r\n          </Route>\r\n          \r\n          <Route path='/app/message'>\r\n            <MessageList />\r\n          </Route>\r\n\r\n          <Route path='/app/message/:id'>\r\n            <ChatPage />\r\n          </Route>\r\n\r\n          <Route path='/app/friends'>\r\n            <FriendsList/>\r\n          </Route>\r\n\r\n          <Route path='/app/friends/:id'>\r\n            <ProfilePage/>\r\n          </Route>\r\n\r\n          <Route path='/app/editProfile'>\r\n            <FriendsList />\r\n            <ProfileEdit />\r\n          </Route>\r\n        </HashRouter>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(MainPage);\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { Provider } from 'mobx-react';\nimport { Route } from \"react-router\";\nimport { HashRouter } from 'react-router-dom';\nimport { createBrowserHistory } from \"history\";\n\nimport './styles/index.styl';\n\nimport TopButton from './components/TopButton';\nimport LoginPage from './components/LoginPage';\nimport RegisterPage from './components/RegisterPage';\nimport MainPage from './components/MainPage';\n\nimport Model from './models';\n\n// eslint-disable-next-line\neval('window.browserWindow = require(\"electron\").remote');\n\nconst history = createBrowserHistory(),\n    store = new Model();\n\nReactDOM.render((\n    <div className=\"mechat\" id=\"mechat\">\n        <Provider store={store}>\n            <TopButton />\n            <HashRouter history={history}>\n                <Route path=\"/\" exact>\n                    <LoginPage />\n                </Route>\n                <Route path=\"/register\" exact>\n                    <RegisterPage />\n                </Route>\n                <Route path=\"/app\">\n                    <MainPage />\n                </Route>\n            </HashRouter>\n        </Provider>\n    </div>\n), document.getElementById('root'));\n","export default {\r\n    apiUrl: 'http://103.81.187.96:61616/',\r\n    wsUrl: 'ws://103.81.187.96:61616/entry',\r\n};"],"sourceRoot":""}